(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Generated by LiveScript 1.4.0
var apply, curry, flip, fix, over, memoize, slice$ = [].slice, toString$ = {}.toString;
apply = curry$(function(f, list){
  return f.apply(null, list);
});
curry = function(f){
  return curry$(f);
};
flip = curry$(function(f, x, y){
  return f(y, x);
});
fix = function(f){
  return function(g){
    return function(){
      return f(g(g)).apply(null, arguments);
    };
  }(function(g){
    return function(){
      return f(g(g)).apply(null, arguments);
    };
  });
};
over = curry$(function(f, g, x, y){
  return f(g(x), g(y));
});
memoize = function(f){
  var memo;
  memo = {};
  return function(){
    var args, key, arg;
    args = slice$.call(arguments);
    key = (function(){
      var i$, ref$, len$, results$ = [];
      for (i$ = 0, len$ = (ref$ = args).length; i$ < len$; ++i$) {
        arg = ref$[i$];
        results$.push(arg + toString$.call(arg).slice(8, -1));
      }
      return results$;
    }()).join('');
    return memo[key] = key in memo
      ? memo[key]
      : f.apply(null, args);
  };
};
module.exports = {
  curry: curry,
  flip: flip,
  fix: fix,
  apply: apply,
  over: over,
  memoize: memoize
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],2:[function(require,module,exports){
// Generated by LiveScript 1.4.0
var each, map, compact, filter, reject, partition, find, head, first, tail, last, initial, empty, reverse, unique, uniqueBy, fold, foldl, fold1, foldl1, foldr, foldr1, unfoldr, concat, concatMap, flatten, difference, intersection, union, countBy, groupBy, andList, orList, any, all, sort, sortWith, sortBy, sum, product, mean, average, maximum, minimum, maximumBy, minimumBy, scan, scanl, scan1, scanl1, scanr, scanr1, slice, take, drop, splitAt, takeWhile, dropWhile, span, breakList, zip, zipWith, zipAll, zipAllWith, at, elemIndex, elemIndices, findIndex, findIndices, toString$ = {}.toString, slice$ = [].slice;
each = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    f(x);
  }
  return xs;
});
map = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    results$.push(f(x));
  }
  return results$;
});
compact = function(xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (x) {
      results$.push(x);
    }
  }
  return results$;
};
filter = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      results$.push(x);
    }
  }
  return results$;
});
reject = curry$(function(f, xs){
  var i$, len$, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!f(x)) {
      results$.push(x);
    }
  }
  return results$;
});
partition = curry$(function(f, xs){
  var passed, failed, i$, len$, x;
  passed = [];
  failed = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    (f(x) ? passed : failed).push(x);
  }
  return [passed, failed];
});
find = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      return x;
    }
  }
});
head = first = function(xs){
  return xs[0];
};
tail = function(xs){
  if (!xs.length) {
    return;
  }
  return xs.slice(1);
};
last = function(xs){
  return xs[xs.length - 1];
};
initial = function(xs){
  if (!xs.length) {
    return;
  }
  return xs.slice(0, -1);
};
empty = function(xs){
  return !xs.length;
};
reverse = function(xs){
  return xs.concat().reverse();
};
unique = function(xs){
  var result, i$, len$, x;
  result = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!in$(x, result)) {
      result.push(x);
    }
  }
  return result;
};
uniqueBy = curry$(function(f, xs){
  var seen, i$, len$, x, val, results$ = [];
  seen = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    val = f(x);
    if (in$(val, seen)) {
      continue;
    }
    seen.push(val);
    results$.push(x);
  }
  return results$;
});
fold = foldl = curry$(function(f, memo, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    memo = f(memo, x);
  }
  return memo;
});
fold1 = foldl1 = curry$(function(f, xs){
  return fold(f, xs[0], xs.slice(1));
});
foldr = curry$(function(f, memo, xs){
  var i$, x;
  for (i$ = xs.length - 1; i$ >= 0; --i$) {
    x = xs[i$];
    memo = f(x, memo);
  }
  return memo;
});
foldr1 = curry$(function(f, xs){
  return foldr(f, xs[xs.length - 1], xs.slice(0, -1));
});
unfoldr = curry$(function(f, b){
  var result, x, that;
  result = [];
  x = b;
  while ((that = f(x)) != null) {
    result.push(that[0]);
    x = that[1];
  }
  return result;
});
concat = function(xss){
  return [].concat.apply([], xss);
};
concatMap = curry$(function(f, xs){
  var x;
  return [].concat.apply([], (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      results$.push(f(x));
    }
    return results$;
  }()));
});
flatten = function(xs){
  var x;
  return [].concat.apply([], (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      if (toString$.call(x).slice(8, -1) === 'Array') {
        results$.push(flatten(x));
      } else {
        results$.push(x);
      }
    }
    return results$;
  }()));
};
difference = function(xs){
  var yss, results, i$, len$, x, j$, len1$, ys;
  yss = slice$.call(arguments, 1);
  results = [];
  outer: for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    for (j$ = 0, len1$ = yss.length; j$ < len1$; ++j$) {
      ys = yss[j$];
      if (in$(x, ys)) {
        continue outer;
      }
    }
    results.push(x);
  }
  return results;
};
intersection = function(xs){
  var yss, results, i$, len$, x, j$, len1$, ys;
  yss = slice$.call(arguments, 1);
  results = [];
  outer: for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    for (j$ = 0, len1$ = yss.length; j$ < len1$; ++j$) {
      ys = yss[j$];
      if (!in$(x, ys)) {
        continue outer;
      }
    }
    results.push(x);
  }
  return results;
};
union = function(){
  var xss, results, i$, len$, xs, j$, len1$, x;
  xss = slice$.call(arguments);
  results = [];
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    for (j$ = 0, len1$ = xs.length; j$ < len1$; ++j$) {
      x = xs[j$];
      if (!in$(x, results)) {
        results.push(x);
      }
    }
  }
  return results;
};
countBy = curry$(function(f, xs){
  var results, i$, len$, x, key;
  results = {};
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    key = f(x);
    if (key in results) {
      results[key] += 1;
    } else {
      results[key] = 1;
    }
  }
  return results;
});
groupBy = curry$(function(f, xs){
  var results, i$, len$, x, key;
  results = {};
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    key = f(x);
    if (key in results) {
      results[key].push(x);
    } else {
      results[key] = [x];
    }
  }
  return results;
});
andList = function(xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!x) {
      return false;
    }
  }
  return true;
};
orList = function(xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (x) {
      return true;
    }
  }
  return false;
};
any = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (f(x)) {
      return true;
    }
  }
  return false;
});
all = curry$(function(f, xs){
  var i$, len$, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    if (!f(x)) {
      return false;
    }
  }
  return true;
});
sort = function(xs){
  return xs.concat().sort(function(x, y){
    if (x > y) {
      return 1;
    } else if (x < y) {
      return -1;
    } else {
      return 0;
    }
  });
};
sortWith = curry$(function(f, xs){
  return xs.concat().sort(f);
});
sortBy = curry$(function(f, xs){
  return xs.concat().sort(function(x, y){
    if (f(x) > f(y)) {
      return 1;
    } else if (f(x) < f(y)) {
      return -1;
    } else {
      return 0;
    }
  });
});
sum = function(xs){
  var result, i$, len$, x;
  result = 0;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    result += x;
  }
  return result;
};
product = function(xs){
  var result, i$, len$, x;
  result = 1;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    result *= x;
  }
  return result;
};
mean = average = function(xs){
  var sum, i$, len$, x;
  sum = 0;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    x = xs[i$];
    sum += x;
  }
  return sum / xs.length;
};
maximum = function(xs){
  var max, i$, ref$, len$, x;
  max = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (x > max) {
      max = x;
    }
  }
  return max;
};
minimum = function(xs){
  var min, i$, ref$, len$, x;
  min = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (x < min) {
      min = x;
    }
  }
  return min;
};
maximumBy = curry$(function(f, xs){
  var max, i$, ref$, len$, x;
  max = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (f(x) > f(max)) {
      max = x;
    }
  }
  return max;
});
minimumBy = curry$(function(f, xs){
  var min, i$, ref$, len$, x;
  min = xs[0];
  for (i$ = 0, len$ = (ref$ = xs.slice(1)).length; i$ < len$; ++i$) {
    x = ref$[i$];
    if (f(x) < f(min)) {
      min = x;
    }
  }
  return min;
});
scan = scanl = curry$(function(f, memo, xs){
  var last, x;
  last = memo;
  return [memo].concat((function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xs).length; i$ < len$; ++i$) {
      x = ref$[i$];
      results$.push(last = f(last, x));
    }
    return results$;
  }()));
});
scan1 = scanl1 = curry$(function(f, xs){
  if (!xs.length) {
    return;
  }
  return scan(f, xs[0], xs.slice(1));
});
scanr = curry$(function(f, memo, xs){
  xs = xs.concat().reverse();
  return scan(f, memo, xs).reverse();
});
scanr1 = curry$(function(f, xs){
  if (!xs.length) {
    return;
  }
  xs = xs.concat().reverse();
  return scan(f, xs[0], xs.slice(1)).reverse();
});
slice = curry$(function(x, y, xs){
  return xs.slice(x, y);
});
take = curry$(function(n, xs){
  if (n <= 0) {
    return xs.slice(0, 0);
  } else {
    return xs.slice(0, n);
  }
});
drop = curry$(function(n, xs){
  if (n <= 0) {
    return xs;
  } else {
    return xs.slice(n);
  }
});
splitAt = curry$(function(n, xs){
  return [take(n, xs), drop(n, xs)];
});
takeWhile = curry$(function(p, xs){
  var len, i;
  len = xs.length;
  if (!len) {
    return xs;
  }
  i = 0;
  while (i < len && p(xs[i])) {
    i += 1;
  }
  return xs.slice(0, i);
});
dropWhile = curry$(function(p, xs){
  var len, i;
  len = xs.length;
  if (!len) {
    return xs;
  }
  i = 0;
  while (i < len && p(xs[i])) {
    i += 1;
  }
  return xs.slice(i);
});
span = curry$(function(p, xs){
  return [takeWhile(p, xs), dropWhile(p, xs)];
});
breakList = curry$(function(p, xs){
  return span(compose$(p, not$), xs);
});
zip = curry$(function(xs, ys){
  var result, len, i$, len$, i, x;
  result = [];
  len = ys.length;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (i === len) {
      break;
    }
    result.push([x, ys[i]]);
  }
  return result;
});
zipWith = curry$(function(f, xs, ys){
  var result, len, i$, len$, i, x;
  result = [];
  len = ys.length;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (i === len) {
      break;
    }
    result.push(f(x, ys[i]));
  }
  return result;
});
zipAll = function(){
  var xss, minLength, i$, len$, xs, ref$, i, lresult$, j$, results$ = [];
  xss = slice$.call(arguments);
  minLength = undefined;
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    minLength <= (ref$ = xs.length) || (minLength = ref$);
  }
  for (i$ = 0; i$ < minLength; ++i$) {
    i = i$;
    lresult$ = [];
    for (j$ = 0, len$ = xss.length; j$ < len$; ++j$) {
      xs = xss[j$];
      lresult$.push(xs[i]);
    }
    results$.push(lresult$);
  }
  return results$;
};
zipAllWith = function(f){
  var xss, minLength, i$, len$, xs, ref$, i, results$ = [];
  xss = slice$.call(arguments, 1);
  minLength = undefined;
  for (i$ = 0, len$ = xss.length; i$ < len$; ++i$) {
    xs = xss[i$];
    minLength <= (ref$ = xs.length) || (minLength = ref$);
  }
  for (i$ = 0; i$ < minLength; ++i$) {
    i = i$;
    results$.push(f.apply(null, (fn$())));
  }
  return results$;
  function fn$(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = xss).length; i$ < len$; ++i$) {
      xs = ref$[i$];
      results$.push(xs[i]);
    }
    return results$;
  }
};
at = curry$(function(n, xs){
  if (n < 0) {
    return xs[xs.length + n];
  } else {
    return xs[n];
  }
});
elemIndex = curry$(function(el, xs){
  var i$, len$, i, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (x === el) {
      return i;
    }
  }
});
elemIndices = curry$(function(el, xs){
  var i$, len$, i, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (x === el) {
      results$.push(i);
    }
  }
  return results$;
});
findIndex = curry$(function(f, xs){
  var i$, len$, i, x;
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (f(x)) {
      return i;
    }
  }
});
findIndices = curry$(function(f, xs){
  var i$, len$, i, x, results$ = [];
  for (i$ = 0, len$ = xs.length; i$ < len$; ++i$) {
    i = i$;
    x = xs[i$];
    if (f(x)) {
      results$.push(i);
    }
  }
  return results$;
});
module.exports = {
  each: each,
  map: map,
  filter: filter,
  compact: compact,
  reject: reject,
  partition: partition,
  find: find,
  head: head,
  first: first,
  tail: tail,
  last: last,
  initial: initial,
  empty: empty,
  reverse: reverse,
  difference: difference,
  intersection: intersection,
  union: union,
  countBy: countBy,
  groupBy: groupBy,
  fold: fold,
  fold1: fold1,
  foldl: foldl,
  foldl1: foldl1,
  foldr: foldr,
  foldr1: foldr1,
  unfoldr: unfoldr,
  andList: andList,
  orList: orList,
  any: any,
  all: all,
  unique: unique,
  uniqueBy: uniqueBy,
  sort: sort,
  sortWith: sortWith,
  sortBy: sortBy,
  sum: sum,
  product: product,
  mean: mean,
  average: average,
  concat: concat,
  concatMap: concatMap,
  flatten: flatten,
  maximum: maximum,
  minimum: minimum,
  maximumBy: maximumBy,
  minimumBy: minimumBy,
  scan: scan,
  scan1: scan1,
  scanl: scanl,
  scanl1: scanl1,
  scanr: scanr,
  scanr1: scanr1,
  slice: slice,
  take: take,
  drop: drop,
  splitAt: splitAt,
  takeWhile: takeWhile,
  dropWhile: dropWhile,
  span: span,
  breakList: breakList,
  zip: zip,
  zipWith: zipWith,
  zipAll: zipAll,
  zipAllWith: zipAllWith,
  at: at,
  elemIndex: elemIndex,
  elemIndices: elemIndices,
  findIndex: findIndex,
  findIndices: findIndices
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
function in$(x, xs){
  var i = -1, l = xs.length >>> 0;
  while (++i < l) if (x === xs[i]) return true;
  return false;
}
function compose$() {
  var functions = arguments;
  return function() {
    var i, result;
    result = functions[0].apply(this, arguments);
    for (i = 1; i < functions.length; ++i) {
      result = functions[i](result);
    }
    return result;
  };
}
function not$(x){ return !x; }
},{}],3:[function(require,module,exports){
// Generated by LiveScript 1.4.0
var max, min, negate, abs, signum, quot, rem, div, mod, recip, pi, tau, exp, sqrt, ln, pow, sin, tan, cos, asin, acos, atan, atan2, truncate, round, ceiling, floor, isItNaN, even, odd, gcd, lcm;
max = curry$(function(x$, y$){
  return x$ > y$ ? x$ : y$;
});
min = curry$(function(x$, y$){
  return x$ < y$ ? x$ : y$;
});
negate = function(x){
  return -x;
};
abs = Math.abs;
signum = function(x){
  if (x < 0) {
    return -1;
  } else if (x > 0) {
    return 1;
  } else {
    return 0;
  }
};
quot = curry$(function(x, y){
  return ~~(x / y);
});
rem = curry$(function(x$, y$){
  return x$ % y$;
});
div = curry$(function(x, y){
  return Math.floor(x / y);
});
mod = curry$(function(x$, y$){
  var ref$;
  return (((x$) % (ref$ = y$) + ref$) % ref$);
});
recip = (function(it){
  return 1 / it;
});
pi = Math.PI;
tau = pi * 2;
exp = Math.exp;
sqrt = Math.sqrt;
ln = Math.log;
pow = curry$(function(x$, y$){
  return Math.pow(x$, y$);
});
sin = Math.sin;
tan = Math.tan;
cos = Math.cos;
asin = Math.asin;
acos = Math.acos;
atan = Math.atan;
atan2 = curry$(function(x, y){
  return Math.atan2(x, y);
});
truncate = function(x){
  return ~~x;
};
round = Math.round;
ceiling = Math.ceil;
floor = Math.floor;
isItNaN = function(x){
  return x !== x;
};
even = function(x){
  return x % 2 === 0;
};
odd = function(x){
  return x % 2 !== 0;
};
gcd = curry$(function(x, y){
  var z;
  x = Math.abs(x);
  y = Math.abs(y);
  while (y !== 0) {
    z = x % y;
    x = y;
    y = z;
  }
  return x;
});
lcm = curry$(function(x, y){
  return Math.abs(Math.floor(x / gcd(x, y) * y));
});
module.exports = {
  max: max,
  min: min,
  negate: negate,
  abs: abs,
  signum: signum,
  quot: quot,
  rem: rem,
  div: div,
  mod: mod,
  recip: recip,
  pi: pi,
  tau: tau,
  exp: exp,
  sqrt: sqrt,
  ln: ln,
  pow: pow,
  sin: sin,
  tan: tan,
  cos: cos,
  acos: acos,
  asin: asin,
  atan: atan,
  atan2: atan2,
  truncate: truncate,
  round: round,
  ceiling: ceiling,
  floor: floor,
  isItNaN: isItNaN,
  even: even,
  odd: odd,
  gcd: gcd,
  lcm: lcm
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],4:[function(require,module,exports){
// Generated by LiveScript 1.4.0
var values, keys, pairsToObj, objToPairs, listsToObj, objToLists, empty, each, map, compact, filter, reject, partition, find;
values = function(object){
  var i$, x, results$ = [];
  for (i$ in object) {
    x = object[i$];
    results$.push(x);
  }
  return results$;
};
keys = function(object){
  var x, results$ = [];
  for (x in object) {
    results$.push(x);
  }
  return results$;
};
pairsToObj = function(object){
  var i$, len$, x, resultObj$ = {};
  for (i$ = 0, len$ = object.length; i$ < len$; ++i$) {
    x = object[i$];
    resultObj$[x[0]] = x[1];
  }
  return resultObj$;
};
objToPairs = function(object){
  var key, value, results$ = [];
  for (key in object) {
    value = object[key];
    results$.push([key, value]);
  }
  return results$;
};
listsToObj = curry$(function(keys, values){
  var i$, len$, i, key, resultObj$ = {};
  for (i$ = 0, len$ = keys.length; i$ < len$; ++i$) {
    i = i$;
    key = keys[i$];
    resultObj$[key] = values[i];
  }
  return resultObj$;
});
objToLists = function(object){
  var keys, values, key, value;
  keys = [];
  values = [];
  for (key in object) {
    value = object[key];
    keys.push(key);
    values.push(value);
  }
  return [keys, values];
};
empty = function(object){
  var x;
  for (x in object) {
    return false;
  }
  return true;
};
each = curry$(function(f, object){
  var i$, x;
  for (i$ in object) {
    x = object[i$];
    f(x);
  }
  return object;
});
map = curry$(function(f, object){
  var k, x, resultObj$ = {};
  for (k in object) {
    x = object[k];
    resultObj$[k] = f(x);
  }
  return resultObj$;
});
compact = function(object){
  var k, x, resultObj$ = {};
  for (k in object) {
    x = object[k];
    if (x) {
      resultObj$[k] = x;
    }
  }
  return resultObj$;
};
filter = curry$(function(f, object){
  var k, x, resultObj$ = {};
  for (k in object) {
    x = object[k];
    if (f(x)) {
      resultObj$[k] = x;
    }
  }
  return resultObj$;
});
reject = curry$(function(f, object){
  var k, x, resultObj$ = {};
  for (k in object) {
    x = object[k];
    if (!f(x)) {
      resultObj$[k] = x;
    }
  }
  return resultObj$;
});
partition = curry$(function(f, object){
  var passed, failed, k, x;
  passed = {};
  failed = {};
  for (k in object) {
    x = object[k];
    (f(x) ? passed : failed)[k] = x;
  }
  return [passed, failed];
});
find = curry$(function(f, object){
  var i$, x;
  for (i$ in object) {
    x = object[i$];
    if (f(x)) {
      return x;
    }
  }
});
module.exports = {
  values: values,
  keys: keys,
  pairsToObj: pairsToObj,
  objToPairs: objToPairs,
  listsToObj: listsToObj,
  objToLists: objToLists,
  empty: empty,
  each: each,
  map: map,
  filter: filter,
  compact: compact,
  reject: reject,
  partition: partition,
  find: find
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],5:[function(require,module,exports){
// Generated by LiveScript 1.4.0
var split, join, lines, unlines, words, unwords, chars, unchars, reverse, repeat, capitalize, camelize, dasherize;
split = curry$(function(sep, str){
  return str.split(sep);
});
join = curry$(function(sep, xs){
  return xs.join(sep);
});
lines = function(str){
  if (!str.length) {
    return [];
  }
  return str.split('\n');
};
unlines = function(it){
  return it.join('\n');
};
words = function(str){
  if (!str.length) {
    return [];
  }
  return str.split(/[ ]+/);
};
unwords = function(it){
  return it.join(' ');
};
chars = function(it){
  return it.split('');
};
unchars = function(it){
  return it.join('');
};
reverse = function(str){
  return str.split('').reverse().join('');
};
repeat = curry$(function(n, str){
  var result, i$;
  result = '';
  for (i$ = 0; i$ < n; ++i$) {
    result += str;
  }
  return result;
});
capitalize = function(str){
  return str.charAt(0).toUpperCase() + str.slice(1);
};
camelize = function(it){
  return it.replace(/[-_]+(.)?/g, function(arg$, c){
    return (c != null ? c : '').toUpperCase();
  });
};
dasherize = function(str){
  return str.replace(/([^-A-Z])([A-Z]+)/g, function(arg$, lower, upper){
    return lower + "-" + (upper.length > 1
      ? upper
      : upper.toLowerCase());
  }).replace(/^([A-Z]+)/, function(arg$, upper){
    if (upper.length > 1) {
      return upper + "-";
    } else {
      return upper.toLowerCase();
    }
  });
};
module.exports = {
  split: split,
  join: join,
  lines: lines,
  unlines: unlines,
  words: words,
  unwords: unwords,
  chars: chars,
  unchars: unchars,
  reverse: reverse,
  repeat: repeat,
  capitalize: capitalize,
  camelize: camelize,
  dasherize: dasherize
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{}],6:[function(require,module,exports){
// Generated by LiveScript 1.4.0
var Func, List, Obj, Str, Num, id, isType, replicate, prelude, toString$ = {}.toString;
Func = require('./Func.js');
List = require('./List.js');
Obj = require('./Obj.js');
Str = require('./Str.js');
Num = require('./Num.js');
id = function(x){
  return x;
};
isType = curry$(function(type, x){
  return toString$.call(x).slice(8, -1) === type;
});
replicate = curry$(function(n, x){
  var i$, results$ = [];
  for (i$ = 0; i$ < n; ++i$) {
    results$.push(x);
  }
  return results$;
});
Str.empty = List.empty;
Str.slice = List.slice;
Str.take = List.take;
Str.drop = List.drop;
Str.splitAt = List.splitAt;
Str.takeWhile = List.takeWhile;
Str.dropWhile = List.dropWhile;
Str.span = List.span;
Str.breakStr = List.breakList;
prelude = {
  Func: Func,
  List: List,
  Obj: Obj,
  Str: Str,
  Num: Num,
  id: id,
  isType: isType,
  replicate: replicate
};
prelude.each = List.each;
prelude.map = List.map;
prelude.filter = List.filter;
prelude.compact = List.compact;
prelude.reject = List.reject;
prelude.partition = List.partition;
prelude.find = List.find;
prelude.head = List.head;
prelude.first = List.first;
prelude.tail = List.tail;
prelude.last = List.last;
prelude.initial = List.initial;
prelude.empty = List.empty;
prelude.reverse = List.reverse;
prelude.difference = List.difference;
prelude.intersection = List.intersection;
prelude.union = List.union;
prelude.countBy = List.countBy;
prelude.groupBy = List.groupBy;
prelude.fold = List.fold;
prelude.foldl = List.foldl;
prelude.fold1 = List.fold1;
prelude.foldl1 = List.foldl1;
prelude.foldr = List.foldr;
prelude.foldr1 = List.foldr1;
prelude.unfoldr = List.unfoldr;
prelude.andList = List.andList;
prelude.orList = List.orList;
prelude.any = List.any;
prelude.all = List.all;
prelude.unique = List.unique;
prelude.uniqueBy = List.uniqueBy;
prelude.sort = List.sort;
prelude.sortWith = List.sortWith;
prelude.sortBy = List.sortBy;
prelude.sum = List.sum;
prelude.product = List.product;
prelude.mean = List.mean;
prelude.average = List.average;
prelude.concat = List.concat;
prelude.concatMap = List.concatMap;
prelude.flatten = List.flatten;
prelude.maximum = List.maximum;
prelude.minimum = List.minimum;
prelude.maximumBy = List.maximumBy;
prelude.minimumBy = List.minimumBy;
prelude.scan = List.scan;
prelude.scanl = List.scanl;
prelude.scan1 = List.scan1;
prelude.scanl1 = List.scanl1;
prelude.scanr = List.scanr;
prelude.scanr1 = List.scanr1;
prelude.slice = List.slice;
prelude.take = List.take;
prelude.drop = List.drop;
prelude.splitAt = List.splitAt;
prelude.takeWhile = List.takeWhile;
prelude.dropWhile = List.dropWhile;
prelude.span = List.span;
prelude.breakList = List.breakList;
prelude.zip = List.zip;
prelude.zipWith = List.zipWith;
prelude.zipAll = List.zipAll;
prelude.zipAllWith = List.zipAllWith;
prelude.at = List.at;
prelude.elemIndex = List.elemIndex;
prelude.elemIndices = List.elemIndices;
prelude.findIndex = List.findIndex;
prelude.findIndices = List.findIndices;
prelude.apply = Func.apply;
prelude.curry = Func.curry;
prelude.flip = Func.flip;
prelude.fix = Func.fix;
prelude.over = Func.over;
prelude.split = Str.split;
prelude.join = Str.join;
prelude.lines = Str.lines;
prelude.unlines = Str.unlines;
prelude.words = Str.words;
prelude.unwords = Str.unwords;
prelude.chars = Str.chars;
prelude.unchars = Str.unchars;
prelude.repeat = Str.repeat;
prelude.capitalize = Str.capitalize;
prelude.camelize = Str.camelize;
prelude.dasherize = Str.dasherize;
prelude.values = Obj.values;
prelude.keys = Obj.keys;
prelude.pairsToObj = Obj.pairsToObj;
prelude.objToPairs = Obj.objToPairs;
prelude.listsToObj = Obj.listsToObj;
prelude.objToLists = Obj.objToLists;
prelude.max = Num.max;
prelude.min = Num.min;
prelude.negate = Num.negate;
prelude.abs = Num.abs;
prelude.signum = Num.signum;
prelude.quot = Num.quot;
prelude.rem = Num.rem;
prelude.div = Num.div;
prelude.mod = Num.mod;
prelude.recip = Num.recip;
prelude.pi = Num.pi;
prelude.tau = Num.tau;
prelude.exp = Num.exp;
prelude.sqrt = Num.sqrt;
prelude.ln = Num.ln;
prelude.pow = Num.pow;
prelude.sin = Num.sin;
prelude.tan = Num.tan;
prelude.cos = Num.cos;
prelude.acos = Num.acos;
prelude.asin = Num.asin;
prelude.atan = Num.atan;
prelude.atan2 = Num.atan2;
prelude.truncate = Num.truncate;
prelude.round = Num.round;
prelude.ceiling = Num.ceiling;
prelude.floor = Num.floor;
prelude.isItNaN = Num.isItNaN;
prelude.even = Num.even;
prelude.odd = Num.odd;
prelude.gcd = Num.gcd;
prelude.lcm = Num.lcm;
prelude.VERSION = '1.1.2';
module.exports = prelude;
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{"./Func.js":1,"./List.js":2,"./Num.js":3,"./Obj.js":4,"./Str.js":5}],7:[function(require,module,exports){
(function (global){
(function(){
  var i$, ref$, len$, module;
  if (typeof global != 'undefined' && global) {
    import$(global, require('prelude-ls'));
  }
  angular.module("dsc", ["ngRoute", "ngResource", "LocalStorageModule", "angucomplete-alt", "ui.grid", "ui.grid.autoResize"]).filter('percentage', function($filter){
    return function(input, decimals){
      decimals == null && (decimals = 0);
      return $filter('number')(input * 100, decimals) + '%';
    };
  });
  require('./app/routes');
  require('./app/services/storage-service');
  require('./app/services/external-data-service');
  require('./app/services/data-export-service');
  (function(){
    require('./modules/armor-calc/main.js');require('./modules/guide/main.js');require('./modules/inventory/main.js');require('./modules/items/main.js');require('./modules/pc/main.js');require('./modules/w-calc/main.js');
  });
  for (i$ = 0, len$ = (ref$ = ['guide', 'items', 'inventory', 'pc', 'w-calc', 'a-calc']).length; i$ < len$; ++i$) {
    module = ref$[i$];
    require("./modules/" + module + "/main.js");
  }
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./app/routes":8,"./app/services/data-export-service":9,"./app/services/external-data-service":10,"./app/services/storage-service":11,"./modules/armor-calc/main.js":14,"./modules/guide/main.js":17,"./modules/inventory/main.js":21,"./modules/items/main.js":28,"./modules/pc/main.js":32,"./modules/w-calc/main.js":38,"prelude-ls":6}],8:[function(require,module,exports){
(function(){
  angular.module("dsc").config(function($routeProvider){
    $routeProvider.when('/guide/:section', {
      templateUrl: 'modules/guide/view.html',
      controller: 'GuideController'
    }).when('/items', {
      templateUrl: 'modules/items/view.html',
      controller: 'ItemsController'
    }).when('/inventory', {
      templateUrl: 'modules/inventory/inventory-view.html',
      controller: 'InventoryController'
    }).when('/stats', {
      templateUrl: 'modules/pc/view.html',
      controller: 'PcController'
    }).when('/w-calc', {
      templateUrl: 'modules/w-calc/view.html',
      controller: 'WeaponCalcController'
    }).when('/a-calc', {
      templateUrl: 'modules/armor-calc/view.html',
      controller: 'ArmorCalcController'
    }).otherwise({
      redirectTo: '/guide/intro'
    });
  });
}).call(this);

},{}],9:[function(require,module,exports){
(function(){
  angular.module("dsc").service('dataExportSvc', function(){
    return {
      exportJson: function(data){
        window.open(encodeURI("data:application/json," + JSON.stringify(data)));
      },
      exportCsv: function(data){
        var firstLine, rows, i$, len$, item, row, key, value, output;
        firstLine = join(',')(
        keys(
        first(
        data)));
        rows = [];
        for (i$ = 0, len$ = data.length; i$ < len$; ++i$) {
          item = data[i$];
          row = [];
          for (key in item) {
            value = item[key];
            if (typeof value === "string") {
              value = value.replace('"', '""').replace(/(\r\n|\n|\r)/g, '\\n');
              value = "\"" + value + "\"";
            }
            row.push(value);
          }
          row = join(',')(
          row);
          rows.push(row);
        }
        output = firstLine + "\n" + join("\n")(
        rows);
        window.open(encodeURI("data:text/plain," + output));
      }
    };
  });
}).call(this);

},{}],10:[function(require,module,exports){
(function(){
  var ExternalDataService;
  if (typeof angular != 'undefined' && angular !== null) {
    angular.module("dsc").service("externalDataSvc", function($resource, $q){
      return new ExternalDataService($resource, $q);
    });
  }
  ExternalDataService = (function(){
    ExternalDataService.displayName = 'ExternalDataService';
    var prototype = ExternalDataService.prototype, constructor = ExternalDataService;
    function ExternalDataService($resource, $q){
      this.$resource = $resource;
      this.$q = $q;
      this.loadJson = bind$(this, 'loadJson', prototype);
      this._cache = {};
    }
    /**
     * Load an external JSON resource and parse it into an array
     */
    prototype.loadJson = function(url, returnPromise){
      var task, ref$, this$ = this;
      returnPromise == null && (returnPromise = true);
      if (url == null || typeof url !== "string" || url.length < 1) {
        throw new Error("Invalid URL: [" + url + "]");
      }
      task = this.$q.defer();
      if (empty(
      (ref$ = this._cache)[url] || (ref$[url] = []))) {
        this._cache[url] = this.$resource(url).query(function(){
          task.resolve(this$._cache[url]);
        });
      } else {
        task.resolve(this._cache[url]);
      }
      return returnPromise
        ? task.promise
        : this._cache[url];
    };
    return ExternalDataService;
  }());
  if (typeof module != 'undefined' && module !== null) {
    module.exports = ExternalDataService;
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{}],11:[function(require,module,exports){
(function(){
  angular.module("dsc").config(function(localStorageServiceProvider){
    localStorageServiceProvider.setPrefix("DSC");
  }).service('storageSvc', [
    'localStorageService', function(localStorage){
      return {
        save: function(key, data){
          localStorage.set(key, data);
        },
        load: function(key){
          return localStorage.get(key);
        }
      };
    }
  ]);
}).call(this);

},{}],12:[function(require,module,exports){
(function(){
  angular.module("dsc").controller("ArmorCalcController", function($q, $scope, itemSvc, itemUpgradeSvc, inventorySvc, pcService, uiGridConstants){
    var x$, _calcScoresFor, _addAvailableUpgradesTo;
    $scope.results = [];
    $scope.maxLoad = 0;
    $scope.reservedWeight = 40;
    $scope.availableLoad = 0;
    $scope.maxLoad = 40 + pcService.statValueOf('endurance');
    $scope.typeNames = {
      0: 'head',
      1: 'chest',
      2: 'hands',
      3: 'legs'
    };
    $scope.partNames = ['head', 'chest', 'hands', 'legs'];
    x$ = $scope.gridOptions = require('./controller/gridOptions')(uiGridConstants);
    x$.data = $scope.results;
    _calcScoresFor = function(set){
      var result, i$, len$, key, item, def, score;
      result = {
        score: 0,
        weight: 0,
        def: 0
      };
      for (i$ = 0, len$ = set.length; i$ < len$; ++i$) {
        key = i$;
        item = set[i$];
        def = (item.defPhy + item.defStrike + item.defSlash + item.defThrust) / 4;
        score = def;
        result[$scope.typeNames[key]] = {
          score: score,
          item: item,
          name: item.name
        };
        result.def += def;
        result.score += score;
        result.weight += item.weight;
      }
      return result;
    };
    _addAvailableUpgradesTo = function(armors, inventory){
      var def, promise, fullArmorList, i$, len$, armor, materials, j$, level;
      def = $q.defer();
      promise = $q(function(resolve, reject){
        resolve();
      });
      fullArmorList = [];
      for (i$ = 0, len$ = armors.length; i$ < len$; ++i$) {
        armor = armors[i$];
        fullArmorList.push(armor);
        if (armor.id < 0 || armor.upgradeId < 0) {
          continue;
        }
        materials = map(fn$)(
        inventory);
        for (j$ = 1; j$ <= 10; ++j$) {
          level = j$;
          fn1$(armor, materials, level);
        }
      }
      promise.then(function(){
        return def.resolve(fullArmorList);
      });
      return def.promise;
      function fn$(it){
        return import$({}, it);
      }
      function fn1$(armor, materials, level){
        promise = promise.then(function(){
          return itemUpgradeSvc.are(materials).enoughToUpgrade(armor, level);
        }).then(function(canUpgrade){
          if (canUpgrade) {
            return $q.all([itemSvc.getUpgraded(armor, level), itemUpgradeSvc.deductFrom(materials).costOfUpgrade(armor, level)]);
          } else {
            materials.length = 0;
            return null;
          }
        }).then(function(result){
          var upArmor;
          upArmor = result != null ? result[0] : void 8;
          if (upArmor != null) {
            fullArmorList.push(upArmor);
          }
        });
      }
    };
    $scope.calculate = function(type){
      var results;
      type == null && (type = 'offence');
      $scope.freeWeight = $scope.maxLoad - $scope.reservedWeight;
      results = [];
      inventorySvc.load().then(function(inventory){
        return $q.all(map(function(inv){
          return itemSvc.findAnyItem(function(it){
            return it.uid === inv.uid;
          });
        })(
        filter(function(it){
          return it.itemType === 'armor';
        })(
        inventory)));
      }).then(function(armors){
        var availableArmors, staticArmors, dynamicArmors, i$, ref$, len$, key, part, head, j$, ref1$, len1$, chest, k$, ref2$, len2$, hands, l$, ref3$, len3$, legs, set, wSum, bestResults, bestArmors, result, item, fitArmors;
        availableArmors = reject(function(it){
          return it.weight > $scope.freeWeight;
        })(
        armors);
        staticArmors = filter(function(it){
          return it.upgradeId < 0;
        })(
        availableArmors);
        dynamicArmors = reject(function(it){
          return it.upgradeId < 0;
        })(
        availableArmors);
        for (i$ = 0, len$ = (ref$ = $scope.partNames).length; i$ < len$; ++i$) {
          key = i$;
          part = ref$[i$];
          dynamicArmors.push(itemSvc.createItemModel({
            name: "(nothing)",
            id: -(key + 1),
            armorType: part,
            itemType: 'armor'
          }));
        }
        for (i$ = 0, len$ = (ref$ = filter(fn$)(
        dynamicArmors)).length; i$ < len$; ++i$) {
          head = ref$[i$];
          for (j$ = 0, len1$ = (ref1$ = filter(fn1$)(
          dynamicArmors)).length; j$ < len1$; ++j$) {
            chest = ref1$[j$];
            for (k$ = 0, len2$ = (ref2$ = filter(fn2$)(
            dynamicArmors)).length; k$ < len2$; ++k$) {
              hands = ref2$[k$];
              for (l$ = 0, len3$ = (ref3$ = filter(fn3$)(
              dynamicArmors)).length; l$ < len3$; ++l$) {
                legs = ref3$[l$];
                set = [head, chest, hands, legs];
                wSum = sum(
                map(fn4$)(
                set));
                if (wSum <= $scope.freeWeight) {
                  results.push(_calcScoresFor(set));
                }
              }
            }
          }
        }
        bestResults = take(5)(
        reverse(
        sortBy(function(it){
          return it.score;
        })(
        results)));
        bestArmors = {};
        for (i$ = 0, len$ = bestResults.length; i$ < len$; ++i$) {
          result = bestResults[i$];
          for (j$ = 0, len1$ = (ref$ = $scope.partNames).length; j$ < len1$; ++j$) {
            part = ref$[j$];
            item = result[part].item;
            bestArmors[item.id] = item;
          }
        }
        fitArmors = staticArmors.concat(values(
        bestArmors));
        return inventorySvc.load().then(function(inventory){
          return [
            fitArmors, reject(function(it){
              return it.itemType !== 'item';
            })(
            inventory)
          ];
        });
        function fn$(it){
          return it.armorType === 'head';
        }
        function fn1$(it){
          return it.armorType === 'chest';
        }
        function fn2$(it){
          return it.armorType === 'hands';
        }
        function fn3$(it){
          return it.armorType === 'legs';
        }
        function fn4$(it){
          return it.weight;
        }
      }).then(function(data){
        var fitArmors, inventory;
        fitArmors = data[0];
        inventory = data[1];
        return _addAvailableUpgradesTo(Obj.values(
        fitArmors), inventory);
      }).then(function(availableArmors){
        var results, i$, ref$, len$, head, j$, ref1$, len1$, chest, k$, ref2$, len2$, hands, l$, ref3$, len3$, legs, set, wSum;
        results = [];
        for (i$ = 0, len$ = (ref$ = filter(fn$)(
        availableArmors)).length; i$ < len$; ++i$) {
          head = ref$[i$];
          for (j$ = 0, len1$ = (ref1$ = filter(fn1$)(
          availableArmors)).length; j$ < len1$; ++j$) {
            chest = ref1$[j$];
            for (k$ = 0, len2$ = (ref2$ = filter(fn2$)(
            availableArmors)).length; k$ < len2$; ++k$) {
              hands = ref2$[k$];
              for (l$ = 0, len3$ = (ref3$ = filter(fn3$)(
              availableArmors)).length; l$ < len3$; ++l$) {
                legs = ref3$[l$];
                set = [head, chest, hands, legs];
                wSum = sum(
                Obj.values(
                Obj.map(fn4$)(
                set)));
                if (wSum <= $scope.freeWeight) {
                  results.push(_calcScoresFor(set));
                }
              }
            }
          }
        }
        $scope.results = results;
        $scope.gridOptions.data = $scope.results;
        function fn$(it){
          return it.armorType === 'head';
        }
        function fn1$(it){
          return it.armorType === 'chest';
        }
        function fn2$(it){
          return it.armorType === 'hands';
        }
        function fn3$(it){
          return it.armorType === 'legs';
        }
        function fn4$(it){
          return it.weight;
        }
      });
    };
  });
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

},{"./controller/gridOptions":13}],13:[function(require,module,exports){
(function(){
  if (typeof module != 'undefined' && module !== null) {
    module.exports = function(uiGridConstants){
      var percentFieldMinWidth;
      percentFieldMinWidth = 45;
      return {
        columnDefs: [
          {
            field: 'score',
            width: 75,
            cellFilter: 'number:2',
            sort: {
              direction: uiGridConstants.DESC,
              priority: 0
            },
            type: 'number'
          }, {
            field: 'weight',
            width: 50,
            cellFilter: 'number:2',
            type: 'number',
            sort: {
              direction: uiGridConstants.ASC,
              priority: 1
            }
          }, {
            field: 'head.name'
          }, {
            field: 'head.score',
            type: 'number',
            width: 50,
            cellFilter: 'number:2'
          }, {
            field: 'chest.name'
          }, {
            field: 'chest.score',
            type: 'number',
            width: 50,
            cellFilter: 'number:2'
          }, {
            field: 'hands.name'
          }, {
            field: 'hands.score',
            type: 'number',
            width: 50,
            cellFilter: 'number:2'
          }, {
            field: 'legs.name'
          }, {
            field: 'legs.score',
            type: 'number',
            width: 50,
            cellFilter: 'number:2'
          }
        ]
      };
    };
  }
}).call(this);

},{}],14:[function(require,module,exports){
(function(){
  angular.module("dsc");
  require('./controller');
}).call(this);

},{"./controller":12}],15:[function(require,module,exports){
(function(){
  angular.module("dsc").controller("GuideController", function($sce, $scope, $routeParams, $resource, guideService, storageSvc){
    var _getArrowFor, _prepareGuideContent, _saveUserData, _loadUserData, data;
    $scope.sections = [
      {
        id: 'intro',
        name: "Intro"
      }, {
        id: 'asylum',
        name: "Northern Undead Asylum"
      }, {
        id: 'firelink',
        name: "Firelink Shrine"
      }, {
        id: 'burg',
        name: "Undead Burg"
      }, {
        id: 'parish',
        name: "Undead Parish"
      }, {
        id: 'low',
        name: "Lower Undead Burg"
      }, {
        id: 'depths',
        name: "The Depths"
      }, {
        id: 'blight',
        name: "Blighttown"
      }
    ];
    $scope.section = $routeParams['section'];
    $scope.userData = null;
    $scope.entryIndex = {};
    _getArrowFor = function(entry){
      if (!(entry.meta || (entry.meta = {})).isExpandable) {
        return '';
      }
      return (entry.meta || (entry.meta = {})).isCollapsed ? '[..]' : '';
    };
    _prepareGuideContent = function(entry){
      var userMeta, ref$, ref1$, x$, i$, len$, check, child;
      if (entry.id != null) {
        $scope.entryIndex[entry.id] = entry;
      }
      if (entry.content != null) {
        entry.content = $sce.trustAsHtml(entry.content);
      }
      userMeta = (ref$ = ((ref1$ = $scope.userData || ($scope.userData = {})).entryMeta || (ref1$.entryMeta = {}))[entry.id]) != null
        ? ref$
        : {};
      x$ = entry.meta || (entry.meta = {});
      x$.isCollapsed = (ref$ = userMeta.isCollapsed) != null
        ? ref$
        : entry.content != null;
      x$.isDone = (ref$ = userMeta.isDone) != null ? ref$ : false;
      x$.isExpandable = entry.children != null || entry.content != null;
      x$.arrow = _getArrowFor(entry);
      for (i$ = 0, len$ = (ref$ = ['content', 'children']).length; i$ < len$; ++i$) {
        check = ref$[i$];
        ((ref1$ = entry.meta || (entry.meta = {})).additionalClasses || (ref1$.additionalClasses = [])).push(entry[check] != null
          ? "with-" + check
          : "without-" + check);
      }
      if (entry.children != null) {
        for (i$ = 0, len$ = (ref$ = entry.children).length; i$ < len$; ++i$) {
          child = ref$[i$];
          _prepareGuideContent(child);
        }
      }
    };
    _saveUserData = function(){
      var id, ref$, entry, i$, ref1$, len$, field, ref2$, ref3$;
      for (id in ref$ = $scope.entryIndex) {
        entry = ref$[id];
        for (i$ = 0, len$ = (ref1$ = ['isCollapsed', 'isDone']).length; i$ < len$; ++i$) {
          field = ref1$[i$];
          ((ref2$ = (ref3$ = $scope.userData || ($scope.userData = {})).entryMeta || (ref3$.entryMeta = {}))[id] || (ref2$[id] = {}))[field] = entry.meta[field];
        }
      }
      storageSvc.save('guide:userData', $scope.userData);
    };
    _loadUserData = function(){
      var ref$;
      $scope.userData = (ref$ = storageSvc.load('guide:userData')) != null
        ? ref$
        : {};
    };
    _loadUserData();
    data = guideService.getContentFor($scope.section);
    $scope.entry = {
      children: data
    };
    data.$promise.then(function(){
      _prepareGuideContent($scope.entry);
    });
    $scope.canAddToInventory = function(entry){
      var can;
      can = any((function(it){
        return it === 'item';
      }))(
      entry.labels || (entry.labels = []));
      can = can && !any((function(it){
        return it === 'abstract';
      }))(
      entry.flags || (entry.flags = []));
      return can;
    };
    $scope.entryClicked = function($event, entry){
      var x$;
      $event.stopPropagation();
      if (!(entry.meta || (entry.meta = {})).isExpandable) {
        return;
      }
      x$ = entry.meta || (entry.meta = {});
      x$.isCollapsed = !(entry.meta || (entry.meta = {})).isCollapsed;
      x$.arrow = _getArrowFor(entry);
      _saveUserData();
    };
    $scope.entryDone = function(entry){
      entry.meta.isDone = true;
      _saveUserData();
    };
  });
}).call(this);

},{}],16:[function(require,module,exports){
(function(){
  angular.module("dsc").service("guideService", function($resource){
    var svc;
    svc = {};
    svc.getContentFor = function(section){
      return $resource("/modules/guide/content/" + section + ".json").query();
    };
    return svc;
  });
}).call(this);

},{}],17:[function(require,module,exports){
(function(){
  require('./guide-controller');
  require('./guide-service');
}).call(this);

},{"./guide-controller":15,"./guide-service":16}],18:[function(require,module,exports){
(function(){
  if (typeof module != 'undefined' && module !== null) {
    module.exports = function(uiGridConstants){
      return {
        enableFiltering: true,
        columnDefs: [
          {
            field: 'name',
            sort: {
              direction: uiGridConstants.ASC
            }
          }, {
            field: 'itemType',
            displayName: 'Type',
            filter: {
              type: uiGridConstants.filter.SELECT,
              selectOptions: [
                {
                  value: 'weapon',
                  label: "Weapons"
                }, {
                  value: 'armor',
                  label: "Armor"
                }, {
                  value: 'item',
                  label: "Items"
                }
              ]
            }
          }, {
            field: 'amount',
            width: 50
          }
        ],
        onRegisterApi: function(gridApi){
          gridApi.core.addRowHeaderColumn({
            name: 'rowHeaderCol',
            displayName: '',
            width: 100,
            cellTemplate: 'GridRowHeader.html'
          });
        }
      };
    };
  }
}).call(this);

},{}],19:[function(require,module,exports){
(function(){
  angular.module("dsc").controller("InventoryController", function($scope, uiGridConstants, itemSvc, itemIndexSvc, itemUpgradeSvc, storageSvc, inventorySvc, dataExportSvc){
    $scope.selectedItem = null;
    $scope.armorSets = [];
    $scope.allItems = [];
    $scope.itemTypes = ['weapon', 'armor', 'item'];
    $scope.gridOptions = require('./config/inventory-grid-opts')(uiGridConstants);
    $scope.allItems = itemIndexSvc.loadAllEntries(false);
    $scope.armorSets = itemIndexSvc.loadAllArmorSetEntries(false);
    $scope.gridOptions.data = inventorySvc.load(false);
    $scope['export'] = function(){};
    $scope.canUpgrade = function(item){
      return itemUpgradeSvc.canBeUpgraded(
      item);
    };
    $scope.upgrade = function(invEntry){
      return itemSvc.findAnyItem(function(it){
        return it.uid === invEntry.uid;
      }).then(function(item){
        return itemSvc.getUpgraded(item);
      }).then(function(upItem){
        if (upItem == null) {
          return;
        }
        $scope.remove(invEntry);
        $scope.add(upItem);
      });
    };
    $scope.addNewItem = function(selection){
      $scope.add(selection.originalObject);
    };
    $scope.add = inventorySvc.add;
    $scope.remove = inventorySvc.remove;
    $scope.addArmorSet = function(selection){
      var armorSet;
      armorSet = selection.originalObject;
      itemIndexSvc.findByArmorSet(armorSet).then(function(armors){
        each($scope.add)(
        armors);
      });
    };
  });
}).call(this);

},{"./config/inventory-grid-opts":18}],20:[function(require,module,exports){
(function(){
  var InventorySvc;
  if (typeof angular != 'undefined' && angular !== null) {
    angular.module("dsc").service("inventorySvc", function(storageSvc, itemIndexSvc, $q){
      return new InventorySvc(storageSvc, itemIndexSvc, $q);
    });
  }
  InventorySvc = (function(){
    InventorySvc.displayName = 'InventorySvc';
    var prototype = InventorySvc.prototype, constructor = InventorySvc;
    function InventorySvc(storageSvc, itemIndexSvc, $q){
      this.storageSvc = storageSvc;
      this.itemIndexSvc = itemIndexSvc;
      this.$q = $q;
      this.clear = bind$(this, 'clear', prototype);
      this.remove = bind$(this, 'remove', prototype);
      this.add = bind$(this, 'add', prototype);
      this.createInventoryItemFrom = bind$(this, 'createInventoryItemFrom', prototype);
      this.find = bind$(this, 'find', prototype);
      this.findItemByUid = bind$(this, 'findItemByUid', prototype);
      this.load = bind$(this, 'load', prototype);
      this.save = bind$(this, 'save', prototype);
      this._inventory = [];
      this._models = require('./models/inventory-models');
    }
    prototype.save = function(){
      var data, i$, ref$, len$, item;
      data = [];
      for (i$ = 0, len$ = (ref$ = this._inventory).length; i$ < len$; ++i$) {
        item = ref$[i$];
        data.push({
          'uid': item.uid,
          'amount': item.amount
        });
      }
      this.storageSvc.save('inventory', data);
    };
    prototype.load = function(returnPromise){
      var promises, i$, ref$, len$, data, promise, this$ = this;
      returnPromise == null && (returnPromise = true);
      if (this._inventory.$promise == null) {
        this.clear();
        promises = [];
        for (i$ = 0, len$ = (ref$ = this.storageSvc.load('inventory')).length; i$ < len$; ++i$) {
          data = ref$[i$];
          promise = fn$(data);
          promises.push(promise);
        }
        this._inventory.$promise = this.$q.all(promises).then(function(){
          return this$._inventory;
        });
      }
      return returnPromise
        ? this._inventory.$promise
        : this._inventory;
      function fn$(data){
        var item;
        item = new this$._models.InventoryItem(data);
        return this$.itemIndexSvc.findEntry(function(it){
          return it.uid === data.uid;
        }).then(function(indexEntry){
          item.useDataFrom(indexEntry);
          this$._inventory.push(item);
          return item;
        });
      }
    };
    prototype.findItemByUid = function(uid){
      var this$ = this;
      return this.load().then(function(inventory){
        return find(function(it){
          return it.uid === uid;
        })(
        inventory);
      });
    };
    prototype.find = function(item){
      if (item.uid == null) {
        throw new Error("Can't find an item without UID.");
      }
      return this.findItemByUid(item.uid);
    };
    prototype.createInventoryItemFrom = function(item, amount){
      var x$;
      amount == null && (amount = 1);
      x$ = new this._models.InventoryItem;
      x$.useDataFrom(item);
      x$.amount = amount;
      return x$;
    };
    prototype.add = function(item, amount){
      var this$ = this;
      amount == null && (amount = 1);
      return this.find(item).then(function(invItem){
        var x$;
        if (invItem != null) {
          invItem.amount += amount;
        } else {
          x$ = invItem = this$.createInventoryItemFrom(item, amount);
          this$._inventory.push(
          x$);
        }
        this$.save();
        return invItem;
      });
    };
    prototype.remove = function(item, amount){
      var this$ = this;
      amount == null && (amount = 1);
      return this.find(item).then(function(entry){
        if (entry == null) {
          throw new Error("Failed to remove the above item because couldn't find it in the inventory.");
        }
        entry.amount = amount === true
          ? 0
          : entry.amount -= amount;
        if (entry.amount < 1) {
          this$._inventory.splice(this$._inventory.indexOf(entry), 1);
        }
        this$.save();
        return entry;
      });
    };
    prototype.clear = function(){
      this._inventory.length = 0;
      delete this._inventory.$promise;
      return this;
    };
    return InventorySvc;
  }());
  if (typeof module != 'undefined' && module !== null) {
    module.exports = InventorySvc;
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{"./models/inventory-models":22}],21:[function(require,module,exports){
(function(){
  angular.module("dsc");
  require("./inventory-controller");
  require("./inventory-service");
}).call(this);

},{"./inventory-controller":19,"./inventory-service":20}],22:[function(require,module,exports){
(function(){
  var InventoryItemModel;
  InventoryItemModel = (function(){
    InventoryItemModel.displayName = 'InventoryItemModel';
    var prototype = InventoryItemModel.prototype, constructor = InventoryItemModel;
    function InventoryItemModel(item){
      this.useDataFrom = bind$(this, 'useDataFrom', prototype);
      this.amount = 1;
      this.name = '';
      this.itemType = '';
      this.id = '';
      this.uid = '';
      this.useDataFrom(item);
    }
    prototype.useDataFrom = function(item){
      var i$, ref$, len$, field;
      if (item == null) {
        return;
      }
      for (i$ = 0, len$ = (ref$ = ['amount', 'uid', 'name', 'itemType', 'id']).length; i$ < len$; ++i$) {
        field = ref$[i$];
        if (item[field] != null) {
          this[field] = item[field];
        }
      }
      return this;
    };
    return InventoryItemModel;
  }());
  if (typeof module != 'undefined' && module !== null) {
    module.exports = {
      'InventoryItem': InventoryItemModel
    };
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{}],23:[function(require,module,exports){
(function(){
  if (typeof module != 'undefined' && module !== null) {
    module.exports = function($scope, uiGridConstants){
      var percentFieldMinWidth, i$, ref$, len$, itemType;
      $scope.gridOptions = {};
      percentFieldMinWidth = 45;
      $scope.columnConfigs = {
        'weapons': [
          {
            field: 'weaponCategory',
            displayName: 'Type',
            minWidth: 70,
            sort: {
              direction: uiGridConstants.ASC,
              priority: 0
            }
          }, {
            field: 'name',
            minWidth: 210,
            sort: {
              direction: uiGridConstants.ASC,
              priority: 1
            }
          }, {
            field: 'reqS',
            displayName: 'RS',
            type: 'number'
          }, {
            field: 'reqD',
            displayName: 'RD'
          }, {
            field: 'reqI',
            displayName: 'RI'
          }, {
            field: 'reqF',
            displayName: 'RF'
          }, {
            field: 'dmgN',
            displayName: 'AP'
          }, {
            field: 'dmgM',
            displayName: 'AM'
          }, {
            field: 'dmgF',
            displayName: 'AF'
          }, {
            field: 'dmgL',
            displayName: 'AL'
          }, {
            field: 'dmgS',
            displayName: 'AS'
          }, {
            field: 'scS',
            displayName: 'SS',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage'
          }, {
            field: 'scD',
            displayName: 'SD',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage'
          }, {
            field: 'scI',
            displayName: 'SI',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage'
          }, {
            field: 'scF',
            displayName: 'SF',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage'
          }, {
            field: 'defN',
            displayName: 'DP'
          }, {
            field: 'defM',
            displayName: 'DM'
          }, {
            field: 'defF',
            displayName: 'DF'
          }, {
            field: 'defL',
            displayName: 'DL'
          }, {
            field: 'defT',
            displayName: 'DT'
          }, {
            field: 'defB',
            displayName: 'DB'
          }, {
            field: 'defC',
            displayName: 'DC'
          }, {
            field: 'defS',
            displayName: 'St'
          }, {
            field: 'divMod',
            minWidth: percentFieldMinWidth,
            displayName: 'Div',
            cellFilter: 'percentage'
          }, {
            field: 'occMod',
            minWidth: percentFieldMinWidth,
            displayName: 'Occ',
            cellFilter: 'percentage'
          }
        ],
        'armors': [
          {
            name: 'armorSet',
            displayName: 'Set',
            minWidth: 150,
            sort: {
              direction: uiGridConstants.ASC,
              priority: 0
            }
          }, {
            name: 'armorType',
            displayName: 'Type',
            sort: {
              direction: uiGridConstants.ASC,
              priority: 1
            },
            sortingAlgorithm: function(a, b){
              var values;
              values = {
                'head': 1,
                'chest': 2,
                'hands': 3,
                'legs': 4
              };
              return values[a] > values[b]
                ? 1
                : values[a] < values[b] ? -1 : 0;
            }
          }, {
            field: 'name',
            minWidth: 250
          }, {
            name: 'defN',
            type: 'number',
            displayName: 'DN'
          }, {
            name: 'defSl',
            type: 'number',
            displayName: 'DSl'
          }, {
            name: 'defSt',
            type: 'number',
            displayName: 'DSt'
          }, {
            name: 'defTh',
            type: 'number',
            displayName: 'DTh'
          }, {
            name: 'defM',
            type: 'number',
            displayName: 'DM'
          }, {
            name: 'defF',
            type: 'number',
            displayName: 'DF'
          }, {
            name: 'defL',
            type: 'number',
            displayName: 'DL'
          }, {
            name: 'defP',
            type: 'number',
            displayName: 'DP'
          }, {
            name: 'defT',
            type: 'number',
            displayName: 'RP'
          }, {
            name: 'defB',
            type: 'number',
            displayName: 'RB'
          }, {
            name: 'defC',
            type: 'number',
            displayName: 'RC'
          }, {
            name: 'stRec',
            type: 'number',
            displayName: 'Sr'
          }, {
            name: 'weight',
            type: 'number',
            displayName: 'Wt'
          }
        ]
      };
      for (i$ = 0, len$ = (ref$ = ['items', 'keys', 'materials', 'rings']).length; i$ < len$; ++i$) {
        itemType = ref$[i$];
        $scope.columnConfigs[itemType] = [{
          field: 'name',
          sort: {
            direction: uiGridConstants.ASC,
            priority: 0
          }
        }];
      }
    };
  }
}).call(this);

},{}],24:[function(require,module,exports){
(function(){
  var ItemIndexService;
  if (typeof angular != 'undefined' && angular !== null) {
    angular.module("dsc").service("itemIndexSvc", function(externalDataSvc){
      return new ItemIndexService(externalDataSvc);
    });
  }
  ItemIndexService = (function(){
    ItemIndexService.displayName = 'ItemIndexService';
    var prototype = ItemIndexService.prototype, constructor = ItemIndexService;
    function ItemIndexService(externalDataSvc){
      this.externalDataSvc = externalDataSvc;
      this.loadAllEntries = bind$(this, 'loadAllEntries', prototype);
      this.loadAllArmorSetEntries = bind$(this, 'loadAllArmorSetEntries', prototype);
      this.findByArmorSet = bind$(this, 'findByArmorSet', prototype);
      this.findArmorSetFor = bind$(this, 'findArmorSetFor', prototype);
      this.findEntries = bind$(this, 'findEntries', prototype);
      this.findEntry = bind$(this, 'findEntry', prototype);
      this.clear = bind$(this, 'clear', prototype);
      this._index = [];
      this._armorSetIndex = [];
    }
    prototype.clear = function(){
      this._index.length = 0;
      delete this._index.$promise;
      this._armorSetIndex.length = 0;
      delete this._armorSetIndex.$promise;
      return this;
    };
    /**
     * Finds the first item matching a given filter.
     * @param byFilter Function filter function that takes item as
     * a parameter and returns true/false if it matches/doesn't.
     * @returns Promise that resolves with the found value.
     */
    prototype.findEntry = function(byFilter){
      var this$ = this;
      if (typeof byFilter !== 'function') {
        throw new Error("[byFilter] is not a function.");
      }
      return this.loadAllEntries().then(function(it){
        return find(byFilter)(
        it);
      });
    };
    prototype.findEntries = function(byFilter){
      var this$ = this;
      if (typeof byFilter !== 'function') {
        throw new Error("[byFilter] is not a function.");
      }
      return this.loadAllEntries().then(function(it){
        return filter(byFilter)(
        it);
      });
    };
    prototype.findArmorSetFor = function(item){
      var this$ = this;
      return this.loadAllArmorSetEntries().then(function(it){
        return find(function(it){
          return it.uid === item.uid;
        })(
        it);
      });
    };
    prototype.findByArmorSet = function(setName){
      var this$ = this;
      if (typeof setName === 'object') {
        setName = setName.name;
      }
      if (typeof setName !== 'string') {
        throw new Error("Armor set name must be a string, or an object with string property [name].");
      }
      return this.loadAllArmorSetEntries().then(function(sets){
        var armorIds, ref$;
        armorIds = (ref$ = find(function(it){
          return it.name === setName;
        })(
        sets)) != null ? ref$.armors : void 8;
        return this$.findEntries(function(entry){
          return any((function(it){
            return it === entry.id;
          }))(
          armorIds);
        });
      });
    };
    prototype.loadAllArmorSetEntries = function(returnPromise){
      returnPromise == null && (returnPromise = true);
      if (this._armorSetIndex.$promise == null) {
        this._armorSetIndex = this.externalDataSvc.loadJson('/modules/items/content/armor-set-index.json', false);
      }
      return returnPromise
        ? this._armorSetIndex.$promise
        : this._armorSetIndex;
    };
    prototype.loadAllEntries = function(returnPromise){
      returnPromise == null && (returnPromise = true);
      if (this._index.$promise == null) {
        this._index = this.externalDataSvc.loadJson('/modules/items/content/index.json', false);
      }
      return returnPromise
        ? this._index.$promise
        : this._index;
    };
    return ItemIndexService;
  }());
  if (typeof module != 'undefined' && module !== null) {
    module.exports = ItemIndexService;
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{}],25:[function(require,module,exports){
(function(){
  var ItemService;
  if (typeof angular != 'undefined' && angular !== null) {
    angular.module("dsc").service("itemSvc", function(externalDataSvc, itemIndexSvc, itemUpgradeSvc){
      return new ItemService(externalDataSvc, itemIndexSvc, itemUpgradeSvc);
    });
  }
  ItemService = (function(){
    ItemService.displayName = 'ItemService';
    var prototype = ItemService.prototype, constructor = ItemService;
    function ItemService(_externalDataSvc, _itemIndexSvc, _itemUpgradeSvc){
      this._externalDataSvc = _externalDataSvc;
      this._itemIndexSvc = _itemIndexSvc;
      this._itemUpgradeSvc = _itemUpgradeSvc;
      this.getUpgraded = bind$(this, 'getUpgraded', prototype);
      this.loadAllItems = bind$(this, 'loadAllItems', prototype);
      this.createItemModel = bind$(this, 'createItemModel', prototype);
      this.findAnyItem = bind$(this, 'findAnyItem', prototype);
      this.findBaseItem = bind$(this, 'findBaseItem', prototype);
      this.findItem = bind$(this, 'findItem', prototype);
      this.clear = bind$(this, 'clear', prototype);
      this._storage = {};
      this._models = require('./models/item-models');
    }
    prototype.clear = function(){
      this._storage = {};
    };
    /**
     * Return the first item matching a given filter
     * @param itemType String type of item to find.
     * @param filterFn Function Filter function
     * @return Promise that resolves with the found item, or null if nothing found.
     */
    prototype.findItem = function(itemType, filterFn){
      var this$ = this;
      if (typeof itemType !== 'string') {
        throw new Error("Item type is invalid or not provided");
      }
      return this.loadAllItems(itemType).then(function(items){
        var item;
        item = find(filterFn)(
        items);
        return item;
      });
    };
    prototype.findBaseItem = function(item){
      var this$ = this;
      return this.findItem(item.itemType, function(it){
        return it.id === this$._itemUpgradeSvc.getBaseIdFrom(item.id);
      });
    };
    /**
     * Finds any item, regardless of type, but can only
     * check fields that are in the index.
     */
    prototype.findAnyItem = function(filterFn){
      var this$ = this;
      return this._itemIndexSvc.findEntry(filterFn).then(function(item){
        var baseId, upLevel;
        if (this$._itemUpgradeSvc.isUpgraded(item)) {
          baseId = this$._itemUpgradeSvc.getBaseIdFrom(item.id);
          upLevel = this$._itemUpgradeSvc.getUpgradeLevelFrom(item.id);
          return function(item, baseId, upLevel){
            return this$.findItem(item.itemType, function(it){
              return it.id === baseId;
            }).then(function(baseItem){
              return this$.getUpgraded(baseItem, upLevel);
            });
          }(item, baseId, upLevel);
        } else {
          return this$.findItem(item.itemType, function(it){
            return it.id === item.id;
          });
        }
      });
    };
    /**
     * Create a model from given item data
     */
    prototype.createItemModel = function(data){
      return (function(){
        switch (data.itemType) {
        case 'weapon':
          return new this._models.Weapon;
        case 'armor':
          return new this._models.Armor;
        case 'item':
          return new this._models.Item;
        default:
          throw new Error("[" + data.itemType + "] is not a recognized item type.");
        }
      }.call(this)).useDataFrom(data);
    };
    /**
     * Load item data of a given item type.
     * @returns Promise or populated array, depending on returnPromise setting.
     */
    prototype.loadAllItems = function(itemType, returnPromise){
      var ref$, test, this$ = this;
      returnPromise == null && (returnPromise = true);
      if (((ref$ = this._storage)[itemType] || (ref$[itemType] = [])).$promise == null) {
        this._storage[itemType].$promise = test = this._externalDataSvc.loadJson("/modules/items/content/" + itemType + "s.json").then(function(itemData){
          each(function(it){
            var ref$;
            ((ref$ = this$._storage)[itemType] || (ref$[itemType] = [])).push(this$.createItemModel(it));
          })(
          itemData);
          return this$._storage[itemType];
        });
      }
      return returnPromise
        ? this._storage[itemType].$promise
        : this._storage[itemType];
    };
    prototype.getUpgraded = function(item, level){
      var this$ = this;
      level == null && (level = true);
      if (level === true) {
        level = item.upgradeId + 1;
      }
      return this._itemUpgradeSvc.findUpgradeFor(item, level).then(function(upgrade){
        if (upgrade == null) {
          return null;
        }
        return this$.findBaseItem(
        item).then(function(baseItem){
          return this$.createItemModel(baseItem);
        }).then(function(newItem){
          return this$._itemUpgradeSvc.apply(upgrade).to(newItem);
        }).then(function(newItem){
          return this$._itemIndexSvc.findEntry(function(it){
            return it.uid === newItem.uid;
          }).then(function(entry){
            newItem.name = entry.name;
            return newItem;
          });
        }).then(function(newItem){
          if (newItem.itemType === 'armor') {
            newItem.armorSet = this$._itemIndexSvc.findArmorSetFor(newItem).name;
          }
          return newItem;
        });
      });
    };
    return ItemService;
  }());
  if (typeof module != 'undefined' && module !== null) {
    module.exports = ItemService;
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{"./models/item-models":29}],26:[function(require,module,exports){
(function(){
  var ItemUpgradeService;
  if (typeof angular != 'undefined' && angular !== null) {
    angular.module("dsc").service("itemUpgradeSvc", function(externalDataSvc){
      return new ItemUpgradeService(externalDataSvc);
    });
  }
  ItemUpgradeService = (function(){
    ItemUpgradeService.displayName = 'ItemUpgradeService';
    var prototype = ItemUpgradeService.prototype, constructor = ItemUpgradeService;
    function ItemUpgradeService(externalDataSvc){
      this.externalDataSvc = externalDataSvc;
      this.apply = bind$(this, 'apply', prototype);
      this.canBeUpgradedFurther = bind$(this, 'canBeUpgradedFurther', prototype);
      this.canBeUpgraded = bind$(this, 'canBeUpgraded', prototype);
      this.isUpgraded = bind$(this, 'isUpgraded', prototype);
      this.upgradeLevelOf = bind$(this, 'upgradeLevelOf', prototype);
      this.ensureItCanBeUpgraded = bind$(this, 'ensureItCanBeUpgraded', prototype);
      this.loadAllUpgrades = bind$(this, 'loadAllUpgrades', prototype);
      this.loadAllMaterialSets = bind$(this, 'loadAllMaterialSets', prototype);
      this.deductFrom = bind$(this, 'deductFrom', prototype);
      this.are = bind$(this, 'are', prototype);
      this.findUpgradeMaterialsFor = bind$(this, 'findUpgradeMaterialsFor', prototype);
      this.findUpgradeFor = bind$(this, 'findUpgradeFor', prototype);
      this.getBaseItemIdOf = bind$(this, 'getBaseItemIdOf', prototype);
      this.getUpgradeLevelFrom = bind$(this, 'getUpgradeLevelFrom', prototype);
      this.getBaseIdFrom = bind$(this, 'getBaseIdFrom', prototype);
      this._upgrades = {};
      this._materialSets = [];
    }
    prototype.getBaseIdFrom = function(id){
      return id - this.getUpgradeLevelFrom(id);
    };
    prototype.getUpgradeLevelFrom = function(id){
      return id % 100;
    };
    prototype.getBaseItemIdOf = function(item){
      return this.getBaseIdFrom(item.id);
    };
    /**
     * Get the upgrade model for a given weapon at a given upgrade level
     * @returns Promise, resolved with the upgrade (or null if nothing found)
     */
    prototype.findUpgradeFor = function(item, level){
      var this$ = this;
      return this.loadAllUpgrades(item.itemType).then(function(upgrades){
        return find(function(it){
          return it.id === this$.getBaseIdFrom(item.upgradeId) + level;
        })(
        upgrades);
      });
    };
    /**
     * Find the materials required to upgrade a given item using a given upgrade model.
     * @returns Promise that is resolved with the material data.
     */
    prototype.findUpgradeMaterialsFor = function(item, upgrade){
      var x$, this$ = this;
      if (!(item != null && upgrade != null)) {
        throw new Error("Can't find upgrade materials, either item or upgrade is unset.");
      }
      if (item.matSetId < 0) {
        x$ = $q.defer();
        x$.resolve(null);
        return x$.promise;
      }
      return this.loadAllMaterialSets().then(function(){
        return find(function(it){
          return it.id === this$.getBaseIdFrom(item.matSetId) + upgrade.matSetId;
        })(
        this$._materialSets);
      });
    };
    prototype.are = function(materials){
      var this$ = this;
      return {
        enoughToUpgrade: function(item, level){
          return this$.findUpgradeFor(item, level).then(function(upgrade){
            if (upgrade == null) {
              return false;
            }
            return this$.findUpgradeMaterialsFor(item, upgrade);
          }).then(function(materialSet){
            if (materialSet === false) {
              return null;
            }
            return any(function(it){
              return it.id === materialSet.matId && it.amount >= materialSet.matCost;
            })(
            materials);
          });
        }
      };
    };
    prototype.deductFrom = function(materials){
      var this$ = this;
      return {
        costOfUpgrade: function(item, level){
          return this$.findUpgradeFor(item, level).then(function(upgrade){
            return this$.findUpgradeMaterialsFor(item, upgrade);
          }).then(function(materialSet){
            return find(function(it){
              return it.id === materialSet.matId;
            })(
            materials).amount -= materialSet.matCost;
          });
        }
      };
    };
    /**
     * Asynchronously loads all information on material sets required for upgrades
     * @returns Promise that will be resolved with the material set data.
     */
    prototype.loadAllMaterialSets = function(){
      if (this._materialSets.$promise == null) {
        this._materialSets = this.externalDataSvc.loadJson("/modules/items/content/material-sets.json", false);
      }
      return this._materialSets.$promise;
    };
    /**
     * Load information on all upgrades for a given item type
     * @returns Promise resolved with the upgrade data
     */
    prototype.loadAllUpgrades = function(itemType){
      var ref$;
      this.ensureItCanBeUpgraded(
      itemType);
      if (((ref$ = this._upgrades)[itemType] || (ref$[itemType] = [])).$promise == null) {
        this._upgrades[itemType] = this.externalDataSvc.loadJson("/modules/items/content/" + itemType + "-upgrades.json", false);
      }
      return this._upgrades[itemType].$promise;
    };
    prototype.ensureItCanBeUpgraded = function(item){
      if (item == null) {
        throw new Error("Item / item type not provided.");
      }
      if (typeof item === 'string') {
        item = {
          itemType: item
        };
      }
      if (!this.canBeUpgraded(
      item)) {
        throw new Error("Only weapons and armors can be upgraded, this is a [" + item.itemType + "].");
      }
    };
    prototype.upgradeLevelOf = function(item){
      return item.id % 100;
    };
    prototype.isUpgraded = function(item){
      return this.upgradeLevelOf(item) > 0;
    };
    prototype.canBeUpgraded = function(item){
      return item.itemType === 'weapon' || item.itemType === 'armor';
    };
    prototype.canBeUpgradedFurther = function(item){
      var this$ = this;
      if (!this.canBeUpgraded(item)) {
        return false;
      }
      return this.findUpgradeFor(item, this.upgradeLevelOf(item)).then(function(upgrade){
        return upgrade != null;
      });
    };
    prototype.apply = function(upgrade){
      var this$ = this;
      if (upgrade == null) {
        throw new Error("No upgrade data provided.");
      }
      return {
        to: function(item){
          var x$, i$, ref$, len$, field;
          this$.ensureItCanBeUpgraded(
          item);
          x$ = item;
          x$.id += upgrade['id'] % 100;
          x$.upgradeId = upgrade['id'];
          x$.matSetId += upgrade['matSetId'];
          for (i$ = 0, len$ = (ref$ = ['defModPhy', 'defModMag', 'defModFir', 'defModLit', 'defModTox', 'defModBlo', 'defModCur']).length; i$ < len$; ++i$) {
            field = ref$[i$];
            item[field.replace('Mod', '')] *= upgrade[field];
          }
          switch (item['itemType']) {
          case 'weapon':
            for (i$ = 0, len$ = (ref$ = ['atkModPhy', 'atkModMag', 'atkModFir', 'atkModLit', 'bonusModStr', 'bonusModDex', 'bonusModInt', 'bonusModFai']).length; i$ < len$; ++i$) {
              field = ref$[i$];
              item[field.replace('Mod', '')] *= upgrade[field];
            }
            break;
          case 'armor':
            for (i$ = 0, len$ = (ref$ = ['defModStrike', 'defModSlash', 'defModThrust']).length; i$ < len$; ++i$) {
              field = ref$[i$];
              item[field.replace('Mod', '')] *= upgrade[field];
            }
          }
          return item;
        }
      };
    };
    return ItemUpgradeService;
  }());
  if (typeof module != 'undefined' && module !== null) {
    module.exports = ItemUpgradeService;
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{}],27:[function(require,module,exports){
(function(){
  angular.module("dsc").controller("ItemsController", function($scope, dataExportSvc, itemSvc, uiGridConstants){
    var i$, ref$, len$, itemType;
    $scope.itemTypes = [];
    for (i$ = 0, len$ = (ref$ = ['none', 'items', 'weapons', 'armors']).length; i$ < len$; ++i$) {
      itemType = ref$[i$];
      $scope.itemTypes.push(itemType);
    }
    require('./config/items-grid-options')($scope, uiGridConstants);
    $scope.selectedItemTypeChanged = function(){
      if ($scope.selectedItemType === 'none') {
        $scope.gridOptions.data = [];
        $scope.gridOptions.columnDefs = [];
        return;
      }
      itemSvc.loadItemData($scope.selectedItemType).$promise.then(function(itemData){
        var i$, len$, weapon;
        if ($scope.selectedItemType === 'weapons') {
          for (i$ = 0, len$ = itemData.length; i$ < len$; ++i$) {
            weapon = itemData[i$];
            itemSvc.applyUpgradeTo(weapon, 0);
          }
        }
        $scope.gridOptions.data = itemData;
      });
      $scope.gridOptions.columnDefs = $scope.columnConfigs[$scope.selectedItemType];
    };
    $scope.exportAsJson = function(){
      dataExportSvc.exportJson(map(function(it){
        delete it.$$hashKey;
        return it;
      })(
      $scope.gridOptions.data));
    };
    $scope.exportAsCsv = function(){
      var outputData;
      outputData = map(function(it){
        var item;
        item = import$({}, it);
        delete item.$$hashKey;
        return item;
      })(
      $scope.gridOptions.data);
      dataExportSvc.exportCsv(outputData);
    };
    $scope.selectedItemType = 'none';
  });
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

},{"./config/items-grid-options":23}],28:[function(require,module,exports){
(function(){
  require('./items-controller');
  require('./item-service');
  require('./item-index-service');
  require('./item-upgrade-service');
}).call(this);

},{"./item-index-service":24,"./item-service":25,"./item-upgrade-service":26,"./items-controller":27}],29:[function(require,module,exports){
(function(){
  var ItemModel, EquipmentModel, WeaponModel, ArmorModel;
  if (typeof module != 'undefined' && module !== null) {
    module.exports = {
      'Item': ItemModel = (function(){
        ItemModel.displayName = 'ItemModel';
        var prototype = ItemModel.prototype, constructor = ItemModel;
        function ItemModel(){
          this.useDataFrom = bind$(this, 'useDataFrom', prototype);
          this.id = 0;
          this.itemType = 'item';
          this.itemSubtype = '';
          this.name = '';
          this.sellValue = 0;
          this.iconId = 0;
        }
        /**
         * A unique ID that doesn't overlap between item types.
         */
        Object.defineProperty(prototype, 'uid', {
          get: function(){
            return this.itemType + this.id;
          },
          configurable: true,
          enumerable: true
        });
        prototype.useDataFrom = function(itemData){
          return import$(this, itemData);
        };
        return ItemModel;
      }()),
      'Equipment': EquipmentModel = (function(superclass){
        var prototype = extend$((import$(EquipmentModel, superclass).displayName = 'EquipmentModel', EquipmentModel), superclass).prototype, constructor = EquipmentModel;
        function EquipmentModel(){
          EquipmentModel.superclass.call(this);
          this.weight = 0.0;
          this.durability = 0;
          this.defPhy = 0;
          this.defMag = 0;
          this.defFir = 0;
          this.defLit = 0;
          this.defTox = 0;
          this.defBlo = 0;
          this.defCur = 0;
          this.matSetId = 0;
          this.upgradeCost = 0;
          this.upgradeId = -1;
        }
        return EquipmentModel;
      }(ItemModel)),
      'Weapon': WeaponModel = (function(superclass){
        var prototype = extend$((import$(WeaponModel, superclass).displayName = 'WeaponModel', WeaponModel), superclass).prototype, constructor = WeaponModel;
        function WeaponModel(){
          WeaponModel.superclass.call(this);
          this.itemType = 'weapon';
          this.weaponType = '';
          this.weaponSubtype = '';
          this.path = '';
          this.canBlock = false;
          this.canParry = false;
          this.castsMagic = false;
          this.castsPyromancy = false;
          this.castsMiracles = false;
          this.damagesGhosts = false;
          this.isAugmentable = false;
          this.doesRegularDamage = false;
          this.doesStrikeDamage = false;
          this.doesSlashDamage = false;
          this.doesThrustDamage = false;
          this.reqStr = 0;
          this.reqDex = 0;
          this.reqInt = 0;
          this.reqFai = 0;
          this.atkPhy = 0;
          this.atkMag = 0;
          this.atkFir = 0;
          this.atkLit = 0;
          this.atkStaCost = 0;
          this.bonusStr = 0;
          this.bonusDex = 0;
          this.bonusInt = 0;
          this.bonusFai = 0;
          this.defSta = 0;
          this.divine = 0;
          this.occult = 0;
          this.range = 0;
          this.atkBlo = 0;
          this.dmgBlo = 0;
          this.atkTox = 0;
          this.dmgTox = 0;
          this.atkHeal = 0;
        }
        return WeaponModel;
      }(EquipmentModel)),
      'Armor': ArmorModel = (function(superclass){
        var prototype = extend$((import$(ArmorModel, superclass).displayName = 'ArmorModel', ArmorModel), superclass).prototype, constructor = ArmorModel;
        function ArmorModel(){
          ArmorModel.superclass.call(this);
          this.itemType = 'armor';
          this.armorType = '';
          this.armorSet = '';
          this.defSlash = 0;
          this.defStrike = 0;
          this.defThrust = 0;
          this.defPoise = 0;
          this.staRegenMod = 0;
        }
        Object.defineProperty(prototype, 'sortType', {
          get: function(){
            switch (this.armorType) {
            case 'head':
              return 1;
            case 'chest':
              return 2;
            case 'hands':
              return 3;
            case 'legs':
              return 4;
            }
          },
          configurable: true,
          enumerable: true
        });
        return ArmorModel;
      }(EquipmentModel))
    };
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
  function extend$(sub, sup){
    function fun(){} fun.prototype = (sub.superclass = sup).prototype;
    (sub.prototype = new fun).constructor = sub;
    if (typeof sup.extended == 'function') sup.extended(sub);
    return sub;
  }
}).call(this);

},{}],30:[function(require,module,exports){
(function(){
  angular.module("dsc").controller("PcController", function($scope, pcService){
    $scope.model = pcService.loadUserData();
    $scope.saveStats = function(){
      pcService.saveUserData($scope.model);
    };
  });
}).call(this);

},{}],31:[function(require,module,exports){
(function(){
  angular.module("dsc").filter("toStatArray", function(pcService){
    var output;
    output = [];
    return function(model){
      if (output.length > 0) {
        return output;
      }
      pcService.forEachStat(model, function(stat, name){
        output.push(model[name]);
      });
      return output;
    };
  });
}).call(this);

},{}],32:[function(require,module,exports){
(function(){
  angular.module("dsc");
  require("./service");
  require("./controller");
  require("./controller/filters");
}).call(this);

},{"./controller":30,"./controller/filters":31,"./service":35}],33:[function(require,module,exports){
(function(){
  var PcModel;
  if (typeof module != 'undefined' && module !== null) {
    module.exports = PcModel = (function(){
      PcModel.displayName = 'PcModel';
      var prototype = PcModel.prototype, constructor = PcModel;
      PcModel.Stats = ['vitality', 'attunement', 'endurance', 'strength', 'dexterity', 'resistance', 'intelligence', 'faith', 'humanity'];
      function PcModel(pcService){
        this.pcService = pcService;
        this.validate = bind$(this, 'validate', prototype);
        this.forEachStat = bind$(this, 'forEachStat', prototype);
        this.forEachStat(function(stat, name){
          return new (require('./PcStatModel'))(name);
        });
      }
      prototype.forEachStat = function(func){
        this.pcService.forEachStat(this, func);
      };
      prototype.validate = function(){
        this.forEachStat(function(it){
          it.base = max(8, min(99, it.base));
        });
      };
      return PcModel;
    }());
  }
  function bind$(obj, key, target){
    return function(){ return (target || obj)[key].apply(obj, arguments) };
  }
}).call(this);

},{"./PcStatModel":34}],34:[function(require,module,exports){
(function(){
  var PcStatModel;
  if (typeof module != 'undefined' && module !== null) {
    module.exports = PcStatModel = (function(){
      PcStatModel.displayName = 'PcStatModel';
      var prototype = PcStatModel.prototype, constructor = PcStatModel;
      function PcStatModel(name, base){
        this.name = name;
        this.base = base != null ? base : 0;
        this.bonus = 0;
      }
      Object.defineProperty(prototype, 'total', {
        get: function(){
          return this.base + this.bonus;
        },
        configurable: true,
        enumerable: true
      });
      Object.defineProperty(prototype, 'displayName', {
        get: function(){
          return capitalize(this.name);
        },
        configurable: true,
        enumerable: true
      });
      return PcStatModel;
    }());
  }
}).call(this);

},{}],35:[function(require,module,exports){
(function(){
  angular.module("dsc").service('pcService', function(storageSvc){
    var x$, svc, this$ = this;
    x$ = svc = {};
    x$.data = {};
    x$.PcModel = require('./models/PcModel');
    x$.PcStatModel = require('./models/PcStatModel');
    svc.statValueOf = function(name){
      svc.loadUserData();
      return svc.data.stats[name].total;
    };
    svc.forEachStat = function(model, func){
      var i$, ref$, len$, statName, stat, ref1$;
      model == null && (model = svc.data);
      for (i$ = 0, len$ = (ref$ = svc.PcModel.Stats).length; i$ < len$; ++i$) {
        statName = ref$[i$];
        stat = (model.stats || (model.stats = {}))[statName];
        (model.stats || (model.stats = {}))[statName] = (ref1$ = func(stat, statName)) != null ? ref1$ : stat;
      }
    };
    svc.loadUserData = function(){
      var data, model;
      data = storageSvc.load('pc' != null
        ? 'pc'
        : {});
      model = import$(new svc.PcModel(svc), data);
      model.forEachStat(function(stat, name){
        var x$, ref$;
        x$ = import$(new svc.PcStatModel, data != null ? (ref$ = data.stats) != null ? ref$[name] : void 8 : void 8);
        x$.name = name;
        return x$;
      });
      model.validate();
      svc.data = model;
      return model;
    };
    svc.saveUserData = function(model){
      var data, key, value;
      model == null && (model = svc.data);
      model.validate();
      data = import$({}, model);
      for (key in model) {
        value = model[key];
        if (key !== 'stats') {
          delete data[key];
        }
      }
      storageSvc.save('pc', data);
    };
    svc.statScalingFactorOf = function(name){
      var statValue, thresholds, result, i$, len$, threshold;
      svc.loadUserData();
      statValue = svc.statValueOf(name);
      thresholds = (function(){
        switch (name) {
        case 'strength':
          // fallthrough
        case 'dexterity':
          return [[10, 0.5], [10, 3.5], [20, 2.25]];
        case 'intelligence':
          // fallthrough
        case 'faith':
          return [[10, 0.5], [20, 2.25], [20, 1.5]];
        default:
          throw Error('unimplemented');
        }
      }());
      result = 0;
      for (i$ = 0, len$ = thresholds.length; i$ < len$; ++i$) {
        threshold = thresholds[i$];
        if (statValue >= threshold[0]) {
          result += threshold[0] * threshold[1];
        } else {
          result += statValue * threshold[1];
        }
        statValue -= threshold[0];
        if (statValue < 1) {
          break;
        }
      }
      result /= 100;
      return result;
    };
    return svc;
  });
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

},{"./models/PcModel":33,"./models/PcStatModel":34}],36:[function(require,module,exports){
(function(){
  angular.module("dsc").controller("WeaponCalcController", function($q, $scope, itemSvc, inventorySvc, pcService, uiGridConstants){
    var x$, _addResult;
    $scope.results = [];
    $scope.statBonus = 0;
    $scope.ignoreCrystal = true;
    x$ = $scope.gridOptions = require('./controller/gridOptions')(uiGridConstants);
    x$.data = $scope.results;
    _addResult = function(type, weapon){
      var scS, scD, scI, scF, str, dex, int, fai, dmgN, dmgM, defN, score, x$, result;
      scS = pcService.statScalingFactorOf('strength');
      scD = pcService.statScalingFactorOf('dexterity');
      scI = pcService.statScalingFactorOf('intelligence');
      scF = pcService.statScalingFactorOf('faith');
      str = $scope.statBonus + pcService.statValueOf('strength');
      dex = $scope.statBonus + pcService.statValueOf('dexterity');
      int = $scope.statBonus + pcService.statValueOf('intelligence');
      fai = $scope.statBonus + pcService.statValueOf('faith');
      if (weapon.reqS > str || weapon.reqD > dex || weapon.reqI > int || weapon.reqF > fai) {
        return;
      }
      dmgN = weapon.dmgN * (1 + (weapon.scS * scS + weapon.scD * scD));
      dmgM = weapon.dmgM * (1 + (weapon.scI * scI + weapon.scF * scF));
      defN = weapon.defN + (weapon.defM + weapon.defF + weapon.defL) * 0.2 + weapon.defS;
      score = type === 'defence' ? defN : dmgN;
      x$ = result = {};
      x$.weapon = weapon;
      x$.score = score;
      $scope.gridOptions.data.push(result);
    };
    $scope.calculate = function(type){
      var items, weapons, inventory;
      type == null && (type = 'offence');
      $scope.gridOptions.data = [];
      items = itemSvc.loadItemData('items');
      weapons = itemSvc.loadItemData('weapons');
      inventory = inventorySvc.loadUserInventory();
      $q.all([weapons.$promise, items.$promise]).then(function(){
        var availableWeapons, data, i$, len$, weapon, lresult$, materials, promise, j$, iteration, results$ = [];
        availableWeapons = reject(function(it){
          return it == null || ($scope.ignoreCrystal && take(4)(
          it.name) === 'Crys');
        })(
        map(function(item){
          return find(function(it){
            return it.id === item.id;
          })(
          weapons);
        })(
        inventory));
        data = {};
        for (i$ = 0, len$ = availableWeapons.length; i$ < len$; ++i$) {
          weapon = availableWeapons[i$];
          lresult$ = [];
          materials = map(fn$)(
          inventory);
          promise = $q(fn1$);
          for (j$ = 0; j$ <= 15; ++j$) {
            iteration = j$;
            lresult$.push(fn2$(weapon, materials, iteration));
          }
          results$.push(lresult$);
        }
        return results$;
        function fn$(it){
          return import$({}, it);
        }
        function fn1$(resolve, reject){
          resolve();
        }
        function fn2$(weapon, materials, iteration){
          promise = promise.then(function(){
            return itemSvc.canUpgradeWithMaterials(weapon, materials, iteration);
          }).then(function(canUpgrade){
            if (canUpgrade) {
              return $q.all([itemSvc.getUpgradedVersionOf(weapon, iteration), itemSvc.payForUpgradeFor(weapon, materials, iteration)]);
            } else {
              materials.length = 0;
              return null;
            }
          }).then(function(result){
            var upWeapon;
            upWeapon = result != null ? result[0] : void 8;
            if (upWeapon != null) {
              _addResult(type, upWeapon);
            }
          });
        }
      });
    };
  });
  function import$(obj, src){
    var own = {}.hasOwnProperty;
    for (var key in src) if (own.call(src, key)) obj[key] = src[key];
    return obj;
  }
}).call(this);

},{"./controller/gridOptions":37}],37:[function(require,module,exports){
(function(){
  if (typeof module != 'undefined' && module !== null) {
    module.exports = function(uiGridConstants){
      var percentFieldMinWidth;
      percentFieldMinWidth = 45;
      return {
        columnDefs: [
          {
            field: 'score',
            minWidth: 50,
            cellFilter: 'number:2',
            sort: {
              direction: uiGridConstants.DESC,
              priority: 1
            },
            type: 'number'
          }, {
            field: 'weapon.name',
            minWidth: 210
          }, {
            field: 'weapon.reqS',
            displayName: 'RS',
            type: 'number'
          }, {
            field: 'weapon.reqD',
            displayName: 'RD',
            type: 'number'
          }, {
            field: 'weapon.reqI',
            displayName: 'RI',
            type: 'number'
          }, {
            field: 'weapon.reqF',
            displayName: 'RF',
            type: 'number'
          }, {
            field: 'weapon.dmgN',
            displayName: 'AP',
            type: 'number'
          }, {
            field: 'weapon.dmgM',
            displayName: 'AM',
            type: 'number'
          }, {
            field: 'weapon.dmgF',
            displayName: 'AF',
            type: 'number'
          }, {
            field: 'weapon.dmgL',
            displayName: 'AL',
            type: 'number'
          }, {
            field: 'weapon.dmgS',
            displayName: 'AS',
            type: 'number'
          }, {
            field: 'weapon.scS',
            displayName: 'SS',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage',
            type: 'number'
          }, {
            field: 'weapon.scD',
            displayName: 'SD',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage',
            type: 'number'
          }, {
            field: 'weapon.scI',
            displayName: 'SI',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage',
            type: 'number'
          }, {
            field: 'weapon.scF',
            displayName: 'SF',
            minWidth: percentFieldMinWidth,
            cellFilter: 'percentage',
            type: 'number'
          }, {
            field: 'weapon.defN',
            displayName: 'DP',
            type: 'number'
          }, {
            field: 'weapon.defM',
            displayName: 'DM',
            type: 'number'
          }, {
            field: 'weapon.defF',
            displayName: 'DF',
            type: 'number'
          }, {
            field: 'weapon.defL',
            displayName: 'DL',
            type: 'number'
          }, {
            field: 'weapon.defT',
            displayName: 'DT',
            type: 'number'
          }, {
            field: 'weapon.defB',
            displayName: 'DB',
            type: 'number'
          }, {
            field: 'weapon.defC',
            displayName: 'DC',
            type: 'number'
          }, {
            field: 'weapon.defS',
            displayName: 'St',
            type: 'number'
          }, {
            field: 'weapon.divMod',
            minWidth: percentFieldMinWidth,
            displayName: 'Div',
            cellFilter: 'percentage',
            type: 'number'
          }, {
            field: 'weapon.occMod',
            minWidth: percentFieldMinWidth,
            displayName: 'Occ',
            cellFilter: 'percentage',
            type: 'number'
          }, {
            field: 'weapon.weight',
            displayName: 'Wt',
            type: 'number'
          }
        ]
      };
    };
  }
}).call(this);

},{}],38:[function(require,module,exports){
arguments[4][14][0].apply(exports,arguments)
},{"./controller":36,"dup":14}]},{},[7])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL1VzZXJzL01hcnRpbi9BcHBEYXRhL1JvYW1pbmcvbnBtL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIuLi9ub2RlX21vZHVsZXMvcHJlbHVkZS1scy9saWIvRnVuYy5qcyIsIi4uL25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9MaXN0LmpzIiwiLi4vbm9kZV9tb2R1bGVzL3ByZWx1ZGUtbHMvbGliL051bS5qcyIsIi4uL25vZGVfbW9kdWxlcy9wcmVsdWRlLWxzL2xpYi9PYmouanMiLCIuLi9ub2RlX21vZHVsZXMvcHJlbHVkZS1scy9saWIvU3RyLmpzIiwiLi4vbm9kZV9tb2R1bGVzL3ByZWx1ZGUtbHMvbGliL2luZGV4LmpzIiwiLi4vcHViL190ZW1wXy9hcHAuanMiLCIuLi9wdWIvX3RlbXBfL2FwcC9yb3V0ZXMuanMiLCIuLi9wdWIvX3RlbXBfL2FwcC9zZXJ2aWNlcy9kYXRhLWV4cG9ydC1zZXJ2aWNlLmpzIiwiLi4vcHViL190ZW1wXy9hcHAvc2VydmljZXMvZXh0ZXJuYWwtZGF0YS1zZXJ2aWNlLmpzIiwiLi4vcHViL190ZW1wXy9hcHAvc2VydmljZXMvc3RvcmFnZS1zZXJ2aWNlLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2FybW9yLWNhbGMvY29udHJvbGxlci5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9hcm1vci1jYWxjL2NvbnRyb2xsZXIvZ3JpZE9wdGlvbnMuanMiLCIuLi9wdWIvX3RlbXBfL21vZHVsZXMvYXJtb3ItY2FsYy9tYWluLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2d1aWRlL2d1aWRlLWNvbnRyb2xsZXIuanMiLCIuLi9wdWIvX3RlbXBfL21vZHVsZXMvZ3VpZGUvZ3VpZGUtc2VydmljZS5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9ndWlkZS9tYWluLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2ludmVudG9yeS9jb25maWcvaW52ZW50b3J5LWdyaWQtb3B0cy5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9pbnZlbnRvcnkvaW52ZW50b3J5LWNvbnRyb2xsZXIuanMiLCIuLi9wdWIvX3RlbXBfL21vZHVsZXMvaW52ZW50b3J5L2ludmVudG9yeS1zZXJ2aWNlLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2ludmVudG9yeS9tYWluLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2ludmVudG9yeS9tb2RlbHMvaW52ZW50b3J5LW1vZGVscy5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9pdGVtcy9jb25maWcvaXRlbXMtZ3JpZC1vcHRpb25zLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2l0ZW1zL2l0ZW0taW5kZXgtc2VydmljZS5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9pdGVtcy9pdGVtLXNlcnZpY2UuanMiLCIuLi9wdWIvX3RlbXBfL21vZHVsZXMvaXRlbXMvaXRlbS11cGdyYWRlLXNlcnZpY2UuanMiLCIuLi9wdWIvX3RlbXBfL21vZHVsZXMvaXRlbXMvaXRlbXMtY29udHJvbGxlci5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9pdGVtcy9tYWluLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL2l0ZW1zL21vZGVscy9pdGVtLW1vZGVscy5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9wYy9jb250cm9sbGVyLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL3BjL2NvbnRyb2xsZXIvZmlsdGVycy5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9wYy9tYWluLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL3BjL21vZGVscy9QY01vZGVsLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL3BjL21vZGVscy9QY1N0YXRNb2RlbC5qcyIsIi4uL3B1Yi9fdGVtcF8vbW9kdWxlcy9wYy9zZXJ2aWNlLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL3ctY2FsYy9jb250cm9sbGVyLmpzIiwiLi4vcHViL190ZW1wXy9tb2R1bGVzL3ctY2FsYy9jb250cm9sbGVyL2dyaWRPcHRpb25zLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3cUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2pMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIEdlbmVyYXRlZCBieSBMaXZlU2NyaXB0IDEuNC4wXG52YXIgYXBwbHksIGN1cnJ5LCBmbGlwLCBmaXgsIG92ZXIsIG1lbW9pemUsIHNsaWNlJCA9IFtdLnNsaWNlLCB0b1N0cmluZyQgPSB7fS50b1N0cmluZztcbmFwcGx5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIGxpc3Qpe1xuICByZXR1cm4gZi5hcHBseShudWxsLCBsaXN0KTtcbn0pO1xuY3VycnkgPSBmdW5jdGlvbihmKXtcbiAgcmV0dXJuIGN1cnJ5JChmKTtcbn07XG5mbGlwID0gY3VycnkkKGZ1bmN0aW9uKGYsIHgsIHkpe1xuICByZXR1cm4gZih5LCB4KTtcbn0pO1xuZml4ID0gZnVuY3Rpb24oZil7XG4gIHJldHVybiBmdW5jdGlvbihnKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBmKGcoZykpLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfShmdW5jdGlvbihnKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBmKGcoZykpLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSk7XG59O1xub3ZlciA9IGN1cnJ5JChmdW5jdGlvbihmLCBnLCB4LCB5KXtcbiAgcmV0dXJuIGYoZyh4KSwgZyh5KSk7XG59KTtcbm1lbW9pemUgPSBmdW5jdGlvbihmKXtcbiAgdmFyIG1lbW87XG4gIG1lbW8gPSB7fTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MsIGtleSwgYXJnO1xuICAgIGFyZ3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMpO1xuICAgIGtleSA9IChmdW5jdGlvbigpe1xuICAgICAgdmFyIGkkLCByZWYkLCBsZW4kLCByZXN1bHRzJCA9IFtdO1xuICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IGFyZ3MpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGFyZyA9IHJlZiRbaSRdO1xuICAgICAgICByZXN1bHRzJC5wdXNoKGFyZyArIHRvU3RyaW5nJC5jYWxsKGFyZykuc2xpY2UoOCwgLTEpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRzJDtcbiAgICB9KCkpLmpvaW4oJycpO1xuICAgIHJldHVybiBtZW1vW2tleV0gPSBrZXkgaW4gbWVtb1xuICAgICAgPyBtZW1vW2tleV1cbiAgICAgIDogZi5hcHBseShudWxsLCBhcmdzKTtcbiAgfTtcbn07XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY3Vycnk6IGN1cnJ5LFxuICBmbGlwOiBmbGlwLFxuICBmaXg6IGZpeCxcbiAgYXBwbHk6IGFwcGx5LFxuICBvdmVyOiBvdmVyLFxuICBtZW1vaXplOiBtZW1vaXplXG59O1xuZnVuY3Rpb24gY3VycnkkKGYsIGJvdW5kKXtcbiAgdmFyIGNvbnRleHQsXG4gIF9jdXJyeSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gZi5sZW5ndGggPiAxID8gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBwYXJhbXMgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdO1xuICAgICAgY29udGV4dCA9IGJvdW5kID8gY29udGV4dCB8fCB0aGlzIDogdGhpcztcbiAgICAgIHJldHVybiBwYXJhbXMucHVzaC5hcHBseShwYXJhbXMsIGFyZ3VtZW50cykgPFxuICAgICAgICAgIGYubGVuZ3RoICYmIGFyZ3VtZW50cy5sZW5ndGggP1xuICAgICAgICBfY3VycnkuY2FsbChjb250ZXh0LCBwYXJhbXMpIDogZi5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgIH0gOiBmO1xuICB9O1xuICByZXR1cm4gX2N1cnJ5KCk7XG59IiwiLy8gR2VuZXJhdGVkIGJ5IExpdmVTY3JpcHQgMS40LjBcbnZhciBlYWNoLCBtYXAsIGNvbXBhY3QsIGZpbHRlciwgcmVqZWN0LCBwYXJ0aXRpb24sIGZpbmQsIGhlYWQsIGZpcnN0LCB0YWlsLCBsYXN0LCBpbml0aWFsLCBlbXB0eSwgcmV2ZXJzZSwgdW5pcXVlLCB1bmlxdWVCeSwgZm9sZCwgZm9sZGwsIGZvbGQxLCBmb2xkbDEsIGZvbGRyLCBmb2xkcjEsIHVuZm9sZHIsIGNvbmNhdCwgY29uY2F0TWFwLCBmbGF0dGVuLCBkaWZmZXJlbmNlLCBpbnRlcnNlY3Rpb24sIHVuaW9uLCBjb3VudEJ5LCBncm91cEJ5LCBhbmRMaXN0LCBvckxpc3QsIGFueSwgYWxsLCBzb3J0LCBzb3J0V2l0aCwgc29ydEJ5LCBzdW0sIHByb2R1Y3QsIG1lYW4sIGF2ZXJhZ2UsIG1heGltdW0sIG1pbmltdW0sIG1heGltdW1CeSwgbWluaW11bUJ5LCBzY2FuLCBzY2FubCwgc2NhbjEsIHNjYW5sMSwgc2NhbnIsIHNjYW5yMSwgc2xpY2UsIHRha2UsIGRyb3AsIHNwbGl0QXQsIHRha2VXaGlsZSwgZHJvcFdoaWxlLCBzcGFuLCBicmVha0xpc3QsIHppcCwgemlwV2l0aCwgemlwQWxsLCB6aXBBbGxXaXRoLCBhdCwgZWxlbUluZGV4LCBlbGVtSW5kaWNlcywgZmluZEluZGV4LCBmaW5kSW5kaWNlcywgdG9TdHJpbmckID0ge30udG9TdHJpbmcsIHNsaWNlJCA9IFtdLnNsaWNlO1xuZWFjaCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgZih4KTtcbiAgfVxuICByZXR1cm4geHM7XG59KTtcbm1hcCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgcmVzdWx0cyQucHVzaChmKHgpKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbmNvbXBhY3QgPSBmdW5jdGlvbih4cyl7XG4gIHZhciBpJCwgbGVuJCwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKHgpIHtcbiAgICAgIHJlc3VsdHMkLnB1c2goeCk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG5maWx0ZXIgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXN1bHRzJC5wdXNoKHgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbnJlamVjdCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKCFmKHgpKSB7XG4gICAgICByZXN1bHRzJC5wdXNoKHgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbnBhcnRpdGlvbiA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBwYXNzZWQsIGZhaWxlZCwgaSQsIGxlbiQsIHg7XG4gIHBhc3NlZCA9IFtdO1xuICBmYWlsZWQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgKGYoeCkgPyBwYXNzZWQgOiBmYWlsZWQpLnB1c2goeCk7XG4gIH1cbiAgcmV0dXJuIFtwYXNzZWQsIGZhaWxlZF07XG59KTtcbmZpbmQgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXR1cm4geDtcbiAgICB9XG4gIH1cbn0pO1xuaGVhZCA9IGZpcnN0ID0gZnVuY3Rpb24oeHMpe1xuICByZXR1cm4geHNbMF07XG59O1xudGFpbCA9IGZ1bmN0aW9uKHhzKXtcbiAgaWYgKCF4cy5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgcmV0dXJuIHhzLnNsaWNlKDEpO1xufTtcbmxhc3QgPSBmdW5jdGlvbih4cyl7XG4gIHJldHVybiB4c1t4cy5sZW5ndGggLSAxXTtcbn07XG5pbml0aWFsID0gZnVuY3Rpb24oeHMpe1xuICBpZiAoIXhzLmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuICByZXR1cm4geHMuc2xpY2UoMCwgLTEpO1xufTtcbmVtcHR5ID0gZnVuY3Rpb24oeHMpe1xuICByZXR1cm4gIXhzLmxlbmd0aDtcbn07XG5yZXZlcnNlID0gZnVuY3Rpb24oeHMpe1xuICByZXR1cm4geHMuY29uY2F0KCkucmV2ZXJzZSgpO1xufTtcbnVuaXF1ZSA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHJlc3VsdCwgaSQsIGxlbiQsIHg7XG4gIHJlc3VsdCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoIWluJCh4LCByZXN1bHQpKSB7XG4gICAgICByZXN1bHQucHVzaCh4KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG51bmlxdWVCeSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBzZWVuLCBpJCwgbGVuJCwgeCwgdmFsLCByZXN1bHRzJCA9IFtdO1xuICBzZWVuID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIHZhbCA9IGYoeCk7XG4gICAgaWYgKGluJCh2YWwsIHNlZW4pKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgc2Vlbi5wdXNoKHZhbCk7XG4gICAgcmVzdWx0cyQucHVzaCh4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbmZvbGQgPSBmb2xkbCA9IGN1cnJ5JChmdW5jdGlvbihmLCBtZW1vLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgbWVtbyA9IGYobWVtbywgeCk7XG4gIH1cbiAgcmV0dXJuIG1lbW87XG59KTtcbmZvbGQxID0gZm9sZGwxID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgcmV0dXJuIGZvbGQoZiwgeHNbMF0sIHhzLnNsaWNlKDEpKTtcbn0pO1xuZm9sZHIgPSBjdXJyeSQoZnVuY3Rpb24oZiwgbWVtbywgeHMpe1xuICB2YXIgaSQsIHg7XG4gIGZvciAoaSQgPSB4cy5sZW5ndGggLSAxOyBpJCA+PSAwOyAtLWkkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBtZW1vID0gZih4LCBtZW1vKTtcbiAgfVxuICByZXR1cm4gbWVtbztcbn0pO1xuZm9sZHIxID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgcmV0dXJuIGZvbGRyKGYsIHhzW3hzLmxlbmd0aCAtIDFdLCB4cy5zbGljZSgwLCAtMSkpO1xufSk7XG51bmZvbGRyID0gY3VycnkkKGZ1bmN0aW9uKGYsIGIpe1xuICB2YXIgcmVzdWx0LCB4LCB0aGF0O1xuICByZXN1bHQgPSBbXTtcbiAgeCA9IGI7XG4gIHdoaWxlICgodGhhdCA9IGYoeCkpICE9IG51bGwpIHtcbiAgICByZXN1bHQucHVzaCh0aGF0WzBdKTtcbiAgICB4ID0gdGhhdFsxXTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufSk7XG5jb25jYXQgPSBmdW5jdGlvbih4c3Mpe1xuICByZXR1cm4gW10uY29uY2F0LmFwcGx5KFtdLCB4c3MpO1xufTtcbmNvbmNhdE1hcCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciB4O1xuICByZXR1cm4gW10uY29uY2F0LmFwcGx5KFtdLCAoZnVuY3Rpb24oKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHJlc3VsdHMkID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgeCA9IHJlZiRbaSRdO1xuICAgICAgcmVzdWx0cyQucHVzaChmKHgpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9KCkpKTtcbn0pO1xuZmxhdHRlbiA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHg7XG4gIHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIChmdW5jdGlvbigpe1xuICAgIHZhciBpJCwgcmVmJCwgbGVuJCwgcmVzdWx0cyQgPSBbXTtcbiAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB4ID0gcmVmJFtpJF07XG4gICAgICBpZiAodG9TdHJpbmckLmNhbGwoeCkuc2xpY2UoOCwgLTEpID09PSAnQXJyYXknKSB7XG4gICAgICAgIHJlc3VsdHMkLnB1c2goZmxhdHRlbih4KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRzJC5wdXNoKHgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cyQ7XG4gIH0oKSkpO1xufTtcbmRpZmZlcmVuY2UgPSBmdW5jdGlvbih4cyl7XG4gIHZhciB5c3MsIHJlc3VsdHMsIGkkLCBsZW4kLCB4LCBqJCwgbGVuMSQsIHlzO1xuICB5c3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMsIDEpO1xuICByZXN1bHRzID0gW107XG4gIG91dGVyOiBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBmb3IgKGokID0gMCwgbGVuMSQgPSB5c3MubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICB5cyA9IHlzc1tqJF07XG4gICAgICBpZiAoaW4kKHgsIHlzKSkge1xuICAgICAgICBjb250aW51ZSBvdXRlcjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0cy5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzO1xufTtcbmludGVyc2VjdGlvbiA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHlzcywgcmVzdWx0cywgaSQsIGxlbiQsIHgsIGokLCBsZW4xJCwgeXM7XG4gIHlzcyA9IHNsaWNlJC5jYWxsKGFyZ3VtZW50cywgMSk7XG4gIHJlc3VsdHMgPSBbXTtcbiAgb3V0ZXI6IGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGZvciAoaiQgPSAwLCBsZW4xJCA9IHlzcy5sZW5ndGg7IGokIDwgbGVuMSQ7ICsraiQpIHtcbiAgICAgIHlzID0geXNzW2okXTtcbiAgICAgIGlmICghaW4kKHgsIHlzKSkge1xuICAgICAgICBjb250aW51ZSBvdXRlcjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0cy5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzO1xufTtcbnVuaW9uID0gZnVuY3Rpb24oKXtcbiAgdmFyIHhzcywgcmVzdWx0cywgaSQsIGxlbiQsIHhzLCBqJCwgbGVuMSQsIHg7XG4gIHhzcyA9IHNsaWNlJC5jYWxsKGFyZ3VtZW50cyk7XG4gIHJlc3VsdHMgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4c3MubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4cyA9IHhzc1tpJF07XG4gICAgZm9yIChqJCA9IDAsIGxlbjEkID0geHMubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICB4ID0geHNbaiRdO1xuICAgICAgaWYgKCFpbiQoeCwgcmVzdWx0cykpIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn07XG5jb3VudEJ5ID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgdmFyIHJlc3VsdHMsIGkkLCBsZW4kLCB4LCBrZXk7XG4gIHJlc3VsdHMgPSB7fTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAga2V5ID0gZih4KTtcbiAgICBpZiAoa2V5IGluIHJlc3VsdHMpIHtcbiAgICAgIHJlc3VsdHNba2V5XSArPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHRzW2tleV0gPSAxO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn0pO1xuZ3JvdXBCeSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciByZXN1bHRzLCBpJCwgbGVuJCwgeCwga2V5O1xuICByZXN1bHRzID0ge307XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGtleSA9IGYoeCk7XG4gICAgaWYgKGtleSBpbiByZXN1bHRzKSB7XG4gICAgICByZXN1bHRzW2tleV0ucHVzaCh4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0c1trZXldID0gW3hdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cztcbn0pO1xuYW5kTGlzdCA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIGkkLCBsZW4kLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoIXgpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xub3JMaXN0ID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgaSQsIGxlbiQsIHg7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmICh4KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcbmFueSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGYoeCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59KTtcbmFsbCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKCFmKHgpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufSk7XG5zb3J0ID0gZnVuY3Rpb24oeHMpe1xuICByZXR1cm4geHMuY29uY2F0KCkuc29ydChmdW5jdGlvbih4LCB5KXtcbiAgICBpZiAoeCA+IHkpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH0gZWxzZSBpZiAoeCA8IHkpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9KTtcbn07XG5zb3J0V2l0aCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHJldHVybiB4cy5jb25jYXQoKS5zb3J0KGYpO1xufSk7XG5zb3J0QnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICByZXR1cm4geHMuY29uY2F0KCkuc29ydChmdW5jdGlvbih4LCB5KXtcbiAgICBpZiAoZih4KSA+IGYoeSkpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH0gZWxzZSBpZiAoZih4KSA8IGYoeSkpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9KTtcbn0pO1xuc3VtID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgcmVzdWx0LCBpJCwgbGVuJCwgeDtcbiAgcmVzdWx0ID0gMDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgcmVzdWx0ICs9IHg7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5wcm9kdWN0ID0gZnVuY3Rpb24oeHMpe1xuICB2YXIgcmVzdWx0LCBpJCwgbGVuJCwgeDtcbiAgcmVzdWx0ID0gMTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSB4c1tpJF07XG4gICAgcmVzdWx0ICo9IHg7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5tZWFuID0gYXZlcmFnZSA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIHN1bSwgaSQsIGxlbiQsIHg7XG4gIHN1bSA9IDA7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0geHNbaSRdO1xuICAgIHN1bSArPSB4O1xuICB9XG4gIHJldHVybiBzdW0gLyB4cy5sZW5ndGg7XG59O1xubWF4aW11bSA9IGZ1bmN0aW9uKHhzKXtcbiAgdmFyIG1heCwgaSQsIHJlZiQsIGxlbiQsIHg7XG4gIG1heCA9IHhzWzBdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0geHMuc2xpY2UoMSkpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IHJlZiRbaSRdO1xuICAgIGlmICh4ID4gbWF4KSB7XG4gICAgICBtYXggPSB4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbWF4O1xufTtcbm1pbmltdW0gPSBmdW5jdGlvbih4cyl7XG4gIHZhciBtaW4sIGkkLCByZWYkLCBsZW4kLCB4O1xuICBtaW4gPSB4c1swXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzLnNsaWNlKDEpKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSByZWYkW2kkXTtcbiAgICBpZiAoeCA8IG1pbikge1xuICAgICAgbWluID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1pbjtcbn07XG5tYXhpbXVtQnkgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgbWF4LCBpJCwgcmVmJCwgbGVuJCwgeDtcbiAgbWF4ID0geHNbMF07XG4gIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4cy5zbGljZSgxKSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICB4ID0gcmVmJFtpJF07XG4gICAgaWYgKGYoeCkgPiBmKG1heCkpIHtcbiAgICAgIG1heCA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiBtYXg7XG59KTtcbm1pbmltdW1CeSA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBtaW4sIGkkLCByZWYkLCBsZW4kLCB4O1xuICBtaW4gPSB4c1swXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzLnNsaWNlKDEpKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHggPSByZWYkW2kkXTtcbiAgICBpZiAoZih4KSA8IGYobWluKSkge1xuICAgICAgbWluID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1pbjtcbn0pO1xuc2NhbiA9IHNjYW5sID0gY3VycnkkKGZ1bmN0aW9uKGYsIG1lbW8sIHhzKXtcbiAgdmFyIGxhc3QsIHg7XG4gIGxhc3QgPSBtZW1vO1xuICByZXR1cm4gW21lbW9dLmNvbmNhdCgoZnVuY3Rpb24oKXtcbiAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIHJlc3VsdHMkID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHhzKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgeCA9IHJlZiRbaSRdO1xuICAgICAgcmVzdWx0cyQucHVzaChsYXN0ID0gZihsYXN0LCB4KSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzJDtcbiAgfSgpKSk7XG59KTtcbnNjYW4xID0gc2NhbmwxID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgaWYgKCF4cy5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgcmV0dXJuIHNjYW4oZiwgeHNbMF0sIHhzLnNsaWNlKDEpKTtcbn0pO1xuc2NhbnIgPSBjdXJyeSQoZnVuY3Rpb24oZiwgbWVtbywgeHMpe1xuICB4cyA9IHhzLmNvbmNhdCgpLnJldmVyc2UoKTtcbiAgcmV0dXJuIHNjYW4oZiwgbWVtbywgeHMpLnJldmVyc2UoKTtcbn0pO1xuc2NhbnIxID0gY3VycnkkKGZ1bmN0aW9uKGYsIHhzKXtcbiAgaWYgKCF4cy5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgeHMgPSB4cy5jb25jYXQoKS5yZXZlcnNlKCk7XG4gIHJldHVybiBzY2FuKGYsIHhzWzBdLCB4cy5zbGljZSgxKSkucmV2ZXJzZSgpO1xufSk7XG5zbGljZSA9IGN1cnJ5JChmdW5jdGlvbih4LCB5LCB4cyl7XG4gIHJldHVybiB4cy5zbGljZSh4LCB5KTtcbn0pO1xudGFrZSA9IGN1cnJ5JChmdW5jdGlvbihuLCB4cyl7XG4gIGlmIChuIDw9IDApIHtcbiAgICByZXR1cm4geHMuc2xpY2UoMCwgMCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHhzLnNsaWNlKDAsIG4pO1xuICB9XG59KTtcbmRyb3AgPSBjdXJyeSQoZnVuY3Rpb24obiwgeHMpe1xuICBpZiAobiA8PSAwKSB7XG4gICAgcmV0dXJuIHhzO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB4cy5zbGljZShuKTtcbiAgfVxufSk7XG5zcGxpdEF0ID0gY3VycnkkKGZ1bmN0aW9uKG4sIHhzKXtcbiAgcmV0dXJuIFt0YWtlKG4sIHhzKSwgZHJvcChuLCB4cyldO1xufSk7XG50YWtlV2hpbGUgPSBjdXJyeSQoZnVuY3Rpb24ocCwgeHMpe1xuICB2YXIgbGVuLCBpO1xuICBsZW4gPSB4cy5sZW5ndGg7XG4gIGlmICghbGVuKSB7XG4gICAgcmV0dXJuIHhzO1xuICB9XG4gIGkgPSAwO1xuICB3aGlsZSAoaSA8IGxlbiAmJiBwKHhzW2ldKSkge1xuICAgIGkgKz0gMTtcbiAgfVxuICByZXR1cm4geHMuc2xpY2UoMCwgaSk7XG59KTtcbmRyb3BXaGlsZSA9IGN1cnJ5JChmdW5jdGlvbihwLCB4cyl7XG4gIHZhciBsZW4sIGk7XG4gIGxlbiA9IHhzLmxlbmd0aDtcbiAgaWYgKCFsZW4pIHtcbiAgICByZXR1cm4geHM7XG4gIH1cbiAgaSA9IDA7XG4gIHdoaWxlIChpIDwgbGVuICYmIHAoeHNbaV0pKSB7XG4gICAgaSArPSAxO1xuICB9XG4gIHJldHVybiB4cy5zbGljZShpKTtcbn0pO1xuc3BhbiA9IGN1cnJ5JChmdW5jdGlvbihwLCB4cyl7XG4gIHJldHVybiBbdGFrZVdoaWxlKHAsIHhzKSwgZHJvcFdoaWxlKHAsIHhzKV07XG59KTtcbmJyZWFrTGlzdCA9IGN1cnJ5JChmdW5jdGlvbihwLCB4cyl7XG4gIHJldHVybiBzcGFuKGNvbXBvc2UkKHAsIG5vdCQpLCB4cyk7XG59KTtcbnppcCA9IGN1cnJ5JChmdW5jdGlvbih4cywgeXMpe1xuICB2YXIgcmVzdWx0LCBsZW4sIGkkLCBsZW4kLCBpLCB4O1xuICByZXN1bHQgPSBbXTtcbiAgbGVuID0geXMubGVuZ3RoO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKGkgPT09IGxlbikge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKFt4LCB5c1tpXV0pO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59KTtcbnppcFdpdGggPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMsIHlzKXtcbiAgdmFyIHJlc3VsdCwgbGVuLCBpJCwgbGVuJCwgaSwgeDtcbiAgcmVzdWx0ID0gW107XG4gIGxlbiA9IHlzLmxlbmd0aDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChpID09PSBsZW4pIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXN1bHQucHVzaChmKHgsIHlzW2ldKSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn0pO1xuemlwQWxsID0gZnVuY3Rpb24oKXtcbiAgdmFyIHhzcywgbWluTGVuZ3RoLCBpJCwgbGVuJCwgeHMsIHJlZiQsIGksIGxyZXN1bHQkLCBqJCwgcmVzdWx0cyQgPSBbXTtcbiAgeHNzID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzKTtcbiAgbWluTGVuZ3RoID0gdW5kZWZpbmVkO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzcy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHhzID0geHNzW2kkXTtcbiAgICBtaW5MZW5ndGggPD0gKHJlZiQgPSB4cy5sZW5ndGgpIHx8IChtaW5MZW5ndGggPSByZWYkKTtcbiAgfVxuICBmb3IgKGkkID0gMDsgaSQgPCBtaW5MZW5ndGg7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgbHJlc3VsdCQgPSBbXTtcbiAgICBmb3IgKGokID0gMCwgbGVuJCA9IHhzcy5sZW5ndGg7IGokIDwgbGVuJDsgKytqJCkge1xuICAgICAgeHMgPSB4c3NbaiRdO1xuICAgICAgbHJlc3VsdCQucHVzaCh4c1tpXSk7XG4gICAgfVxuICAgIHJlc3VsdHMkLnB1c2gobHJlc3VsdCQpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG56aXBBbGxXaXRoID0gZnVuY3Rpb24oZil7XG4gIHZhciB4c3MsIG1pbkxlbmd0aCwgaSQsIGxlbiQsIHhzLCByZWYkLCBpLCByZXN1bHRzJCA9IFtdO1xuICB4c3MgPSBzbGljZSQuY2FsbChhcmd1bWVudHMsIDEpO1xuICBtaW5MZW5ndGggPSB1bmRlZmluZWQ7XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHNzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeHMgPSB4c3NbaSRdO1xuICAgIG1pbkxlbmd0aCA8PSAocmVmJCA9IHhzLmxlbmd0aCkgfHwgKG1pbkxlbmd0aCA9IHJlZiQpO1xuICB9XG4gIGZvciAoaSQgPSAwOyBpJCA8IG1pbkxlbmd0aDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICByZXN1bHRzJC5wdXNoKGYuYXBwbHkobnVsbCwgKGZuJCgpKSkpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbiAgZnVuY3Rpb24gZm4kKCl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB4c3MpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICB4cyA9IHJlZiRbaSRdO1xuICAgICAgcmVzdWx0cyQucHVzaCh4c1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRzJDtcbiAgfVxufTtcbmF0ID0gY3VycnkkKGZ1bmN0aW9uKG4sIHhzKXtcbiAgaWYgKG4gPCAwKSB7XG4gICAgcmV0dXJuIHhzW3hzLmxlbmd0aCArIG5dO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB4c1tuXTtcbiAgfVxufSk7XG5lbGVtSW5kZXggPSBjdXJyeSQoZnVuY3Rpb24oZWwsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCBpLCB4O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKHggPT09IGVsKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbn0pO1xuZWxlbUluZGljZXMgPSBjdXJyeSQoZnVuY3Rpb24oZWwsIHhzKXtcbiAgdmFyIGkkLCBsZW4kLCBpLCB4LCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHhzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgaSA9IGkkO1xuICAgIHggPSB4c1tpJF07XG4gICAgaWYgKHggPT09IGVsKSB7XG4gICAgICByZXN1bHRzJC5wdXNoKGkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59KTtcbmZpbmRJbmRleCA9IGN1cnJ5JChmdW5jdGlvbihmLCB4cyl7XG4gIHZhciBpJCwgbGVuJCwgaSwgeDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSB4cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBpJDtcbiAgICB4ID0geHNbaSRdO1xuICAgIGlmIChmKHgpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbn0pO1xuZmluZEluZGljZXMgPSBjdXJyeSQoZnVuY3Rpb24oZiwgeHMpe1xuICB2YXIgaSQsIGxlbiQsIGksIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0geHMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAgeCA9IHhzW2kkXTtcbiAgICBpZiAoZih4KSkge1xuICAgICAgcmVzdWx0cyQucHVzaChpKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufSk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZWFjaDogZWFjaCxcbiAgbWFwOiBtYXAsXG4gIGZpbHRlcjogZmlsdGVyLFxuICBjb21wYWN0OiBjb21wYWN0LFxuICByZWplY3Q6IHJlamVjdCxcbiAgcGFydGl0aW9uOiBwYXJ0aXRpb24sXG4gIGZpbmQ6IGZpbmQsXG4gIGhlYWQ6IGhlYWQsXG4gIGZpcnN0OiBmaXJzdCxcbiAgdGFpbDogdGFpbCxcbiAgbGFzdDogbGFzdCxcbiAgaW5pdGlhbDogaW5pdGlhbCxcbiAgZW1wdHk6IGVtcHR5LFxuICByZXZlcnNlOiByZXZlcnNlLFxuICBkaWZmZXJlbmNlOiBkaWZmZXJlbmNlLFxuICBpbnRlcnNlY3Rpb246IGludGVyc2VjdGlvbixcbiAgdW5pb246IHVuaW9uLFxuICBjb3VudEJ5OiBjb3VudEJ5LFxuICBncm91cEJ5OiBncm91cEJ5LFxuICBmb2xkOiBmb2xkLFxuICBmb2xkMTogZm9sZDEsXG4gIGZvbGRsOiBmb2xkbCxcbiAgZm9sZGwxOiBmb2xkbDEsXG4gIGZvbGRyOiBmb2xkcixcbiAgZm9sZHIxOiBmb2xkcjEsXG4gIHVuZm9sZHI6IHVuZm9sZHIsXG4gIGFuZExpc3Q6IGFuZExpc3QsXG4gIG9yTGlzdDogb3JMaXN0LFxuICBhbnk6IGFueSxcbiAgYWxsOiBhbGwsXG4gIHVuaXF1ZTogdW5pcXVlLFxuICB1bmlxdWVCeTogdW5pcXVlQnksXG4gIHNvcnQ6IHNvcnQsXG4gIHNvcnRXaXRoOiBzb3J0V2l0aCxcbiAgc29ydEJ5OiBzb3J0QnksXG4gIHN1bTogc3VtLFxuICBwcm9kdWN0OiBwcm9kdWN0LFxuICBtZWFuOiBtZWFuLFxuICBhdmVyYWdlOiBhdmVyYWdlLFxuICBjb25jYXQ6IGNvbmNhdCxcbiAgY29uY2F0TWFwOiBjb25jYXRNYXAsXG4gIGZsYXR0ZW46IGZsYXR0ZW4sXG4gIG1heGltdW06IG1heGltdW0sXG4gIG1pbmltdW06IG1pbmltdW0sXG4gIG1heGltdW1CeTogbWF4aW11bUJ5LFxuICBtaW5pbXVtQnk6IG1pbmltdW1CeSxcbiAgc2Nhbjogc2NhbixcbiAgc2NhbjE6IHNjYW4xLFxuICBzY2FubDogc2NhbmwsXG4gIHNjYW5sMTogc2NhbmwxLFxuICBzY2Fucjogc2NhbnIsXG4gIHNjYW5yMTogc2NhbnIxLFxuICBzbGljZTogc2xpY2UsXG4gIHRha2U6IHRha2UsXG4gIGRyb3A6IGRyb3AsXG4gIHNwbGl0QXQ6IHNwbGl0QXQsXG4gIHRha2VXaGlsZTogdGFrZVdoaWxlLFxuICBkcm9wV2hpbGU6IGRyb3BXaGlsZSxcbiAgc3Bhbjogc3BhbixcbiAgYnJlYWtMaXN0OiBicmVha0xpc3QsXG4gIHppcDogemlwLFxuICB6aXBXaXRoOiB6aXBXaXRoLFxuICB6aXBBbGw6IHppcEFsbCxcbiAgemlwQWxsV2l0aDogemlwQWxsV2l0aCxcbiAgYXQ6IGF0LFxuICBlbGVtSW5kZXg6IGVsZW1JbmRleCxcbiAgZWxlbUluZGljZXM6IGVsZW1JbmRpY2VzLFxuICBmaW5kSW5kZXg6IGZpbmRJbmRleCxcbiAgZmluZEluZGljZXM6IGZpbmRJbmRpY2VzXG59O1xuZnVuY3Rpb24gY3VycnkkKGYsIGJvdW5kKXtcbiAgdmFyIGNvbnRleHQsXG4gIF9jdXJyeSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gZi5sZW5ndGggPiAxID8gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBwYXJhbXMgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdO1xuICAgICAgY29udGV4dCA9IGJvdW5kID8gY29udGV4dCB8fCB0aGlzIDogdGhpcztcbiAgICAgIHJldHVybiBwYXJhbXMucHVzaC5hcHBseShwYXJhbXMsIGFyZ3VtZW50cykgPFxuICAgICAgICAgIGYubGVuZ3RoICYmIGFyZ3VtZW50cy5sZW5ndGggP1xuICAgICAgICBfY3VycnkuY2FsbChjb250ZXh0LCBwYXJhbXMpIDogZi5hcHBseShjb250ZXh0LCBwYXJhbXMpO1xuICAgIH0gOiBmO1xuICB9O1xuICByZXR1cm4gX2N1cnJ5KCk7XG59XG5mdW5jdGlvbiBpbiQoeCwgeHMpe1xuICB2YXIgaSA9IC0xLCBsID0geHMubGVuZ3RoID4+PiAwO1xuICB3aGlsZSAoKytpIDwgbCkgaWYgKHggPT09IHhzW2ldKSByZXR1cm4gdHJ1ZTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gY29tcG9zZSQoKSB7XG4gIHZhciBmdW5jdGlvbnMgPSBhcmd1bWVudHM7XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgaSwgcmVzdWx0O1xuICAgIHJlc3VsdCA9IGZ1bmN0aW9uc1swXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIGZvciAoaSA9IDE7IGkgPCBmdW5jdGlvbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHJlc3VsdCA9IGZ1bmN0aW9uc1tpXShyZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xufVxuZnVuY3Rpb24gbm90JCh4KXsgcmV0dXJuICF4OyB9IiwiLy8gR2VuZXJhdGVkIGJ5IExpdmVTY3JpcHQgMS40LjBcbnZhciBtYXgsIG1pbiwgbmVnYXRlLCBhYnMsIHNpZ251bSwgcXVvdCwgcmVtLCBkaXYsIG1vZCwgcmVjaXAsIHBpLCB0YXUsIGV4cCwgc3FydCwgbG4sIHBvdywgc2luLCB0YW4sIGNvcywgYXNpbiwgYWNvcywgYXRhbiwgYXRhbjIsIHRydW5jYXRlLCByb3VuZCwgY2VpbGluZywgZmxvb3IsIGlzSXROYU4sIGV2ZW4sIG9kZCwgZ2NkLCBsY207XG5tYXggPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIHgkID4geSQgPyB4JCA6IHkkO1xufSk7XG5taW4gPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIHgkIDwgeSQgPyB4JCA6IHkkO1xufSk7XG5uZWdhdGUgPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIC14O1xufTtcbmFicyA9IE1hdGguYWJzO1xuc2lnbnVtID0gZnVuY3Rpb24oeCl7XG4gIGlmICh4IDwgMCkge1xuICAgIHJldHVybiAtMTtcbiAgfSBlbHNlIGlmICh4ID4gMCkge1xuICAgIHJldHVybiAxO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAwO1xuICB9XG59O1xucXVvdCA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgcmV0dXJuIH5+KHggLyB5KTtcbn0pO1xucmVtID0gY3VycnkkKGZ1bmN0aW9uKHgkLCB5JCl7XG4gIHJldHVybiB4JCAlIHkkO1xufSk7XG5kaXYgPSBjdXJyeSQoZnVuY3Rpb24oeCwgeSl7XG4gIHJldHVybiBNYXRoLmZsb29yKHggLyB5KTtcbn0pO1xubW9kID0gY3VycnkkKGZ1bmN0aW9uKHgkLCB5JCl7XG4gIHZhciByZWYkO1xuICByZXR1cm4gKCgoeCQpICUgKHJlZiQgPSB5JCkgKyByZWYkKSAlIHJlZiQpO1xufSk7XG5yZWNpcCA9IChmdW5jdGlvbihpdCl7XG4gIHJldHVybiAxIC8gaXQ7XG59KTtcbnBpID0gTWF0aC5QSTtcbnRhdSA9IHBpICogMjtcbmV4cCA9IE1hdGguZXhwO1xuc3FydCA9IE1hdGguc3FydDtcbmxuID0gTWF0aC5sb2c7XG5wb3cgPSBjdXJyeSQoZnVuY3Rpb24oeCQsIHkkKXtcbiAgcmV0dXJuIE1hdGgucG93KHgkLCB5JCk7XG59KTtcbnNpbiA9IE1hdGguc2luO1xudGFuID0gTWF0aC50YW47XG5jb3MgPSBNYXRoLmNvcztcbmFzaW4gPSBNYXRoLmFzaW47XG5hY29zID0gTWF0aC5hY29zO1xuYXRhbiA9IE1hdGguYXRhbjtcbmF0YW4yID0gY3VycnkkKGZ1bmN0aW9uKHgsIHkpe1xuICByZXR1cm4gTWF0aC5hdGFuMih4LCB5KTtcbn0pO1xudHJ1bmNhdGUgPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIH5+eDtcbn07XG5yb3VuZCA9IE1hdGgucm91bmQ7XG5jZWlsaW5nID0gTWF0aC5jZWlsO1xuZmxvb3IgPSBNYXRoLmZsb29yO1xuaXNJdE5hTiA9IGZ1bmN0aW9uKHgpe1xuICByZXR1cm4geCAhPT0geDtcbn07XG5ldmVuID0gZnVuY3Rpb24oeCl7XG4gIHJldHVybiB4ICUgMiA9PT0gMDtcbn07XG5vZGQgPSBmdW5jdGlvbih4KXtcbiAgcmV0dXJuIHggJSAyICE9PSAwO1xufTtcbmdjZCA9IGN1cnJ5JChmdW5jdGlvbih4LCB5KXtcbiAgdmFyIHo7XG4gIHggPSBNYXRoLmFicyh4KTtcbiAgeSA9IE1hdGguYWJzKHkpO1xuICB3aGlsZSAoeSAhPT0gMCkge1xuICAgIHogPSB4ICUgeTtcbiAgICB4ID0geTtcbiAgICB5ID0gejtcbiAgfVxuICByZXR1cm4geDtcbn0pO1xubGNtID0gY3VycnkkKGZ1bmN0aW9uKHgsIHkpe1xuICByZXR1cm4gTWF0aC5hYnMoTWF0aC5mbG9vcih4IC8gZ2NkKHgsIHkpICogeSkpO1xufSk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgbWF4OiBtYXgsXG4gIG1pbjogbWluLFxuICBuZWdhdGU6IG5lZ2F0ZSxcbiAgYWJzOiBhYnMsXG4gIHNpZ251bTogc2lnbnVtLFxuICBxdW90OiBxdW90LFxuICByZW06IHJlbSxcbiAgZGl2OiBkaXYsXG4gIG1vZDogbW9kLFxuICByZWNpcDogcmVjaXAsXG4gIHBpOiBwaSxcbiAgdGF1OiB0YXUsXG4gIGV4cDogZXhwLFxuICBzcXJ0OiBzcXJ0LFxuICBsbjogbG4sXG4gIHBvdzogcG93LFxuICBzaW46IHNpbixcbiAgdGFuOiB0YW4sXG4gIGNvczogY29zLFxuICBhY29zOiBhY29zLFxuICBhc2luOiBhc2luLFxuICBhdGFuOiBhdGFuLFxuICBhdGFuMjogYXRhbjIsXG4gIHRydW5jYXRlOiB0cnVuY2F0ZSxcbiAgcm91bmQ6IHJvdW5kLFxuICBjZWlsaW5nOiBjZWlsaW5nLFxuICBmbG9vcjogZmxvb3IsXG4gIGlzSXROYU46IGlzSXROYU4sXG4gIGV2ZW46IGV2ZW4sXG4gIG9kZDogb2RkLFxuICBnY2Q6IGdjZCxcbiAgbGNtOiBsY21cbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjQuMFxudmFyIHZhbHVlcywga2V5cywgcGFpcnNUb09iaiwgb2JqVG9QYWlycywgbGlzdHNUb09iaiwgb2JqVG9MaXN0cywgZW1wdHksIGVhY2gsIG1hcCwgY29tcGFjdCwgZmlsdGVyLCByZWplY3QsIHBhcnRpdGlvbiwgZmluZDtcbnZhbHVlcyA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciBpJCwgeCwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCBpbiBvYmplY3QpIHtcbiAgICB4ID0gb2JqZWN0W2kkXTtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIHgsIHJlc3VsdHMkID0gW107XG4gIGZvciAoeCBpbiBvYmplY3QpIHtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn07XG5wYWlyc1RvT2JqID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIGkkLCBsZW4kLCB4LCByZXN1bHRPYmokID0ge307XG4gIGZvciAoaSQgPSAwLCBsZW4kID0gb2JqZWN0Lmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgeCA9IG9iamVjdFtpJF07XG4gICAgcmVzdWx0T2JqJFt4WzBdXSA9IHhbMV07XG4gIH1cbiAgcmV0dXJuIHJlc3VsdE9iaiQ7XG59O1xub2JqVG9QYWlycyA9IGZ1bmN0aW9uKG9iamVjdCl7XG4gIHZhciBrZXksIHZhbHVlLCByZXN1bHRzJCA9IFtdO1xuICBmb3IgKGtleSBpbiBvYmplY3QpIHtcbiAgICB2YWx1ZSA9IG9iamVjdFtrZXldO1xuICAgIHJlc3VsdHMkLnB1c2goW2tleSwgdmFsdWVdKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0cyQ7XG59O1xubGlzdHNUb09iaiA9IGN1cnJ5JChmdW5jdGlvbihrZXlzLCB2YWx1ZXMpe1xuICB2YXIgaSQsIGxlbiQsIGksIGtleSwgcmVzdWx0T2JqJCA9IHt9O1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IGtleXMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBpID0gaSQ7XG4gICAga2V5ID0ga2V5c1tpJF07XG4gICAgcmVzdWx0T2JqJFtrZXldID0gdmFsdWVzW2ldO1xuICB9XG4gIHJldHVybiByZXN1bHRPYmokO1xufSk7XG5vYmpUb0xpc3RzID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIGtleXMsIHZhbHVlcywga2V5LCB2YWx1ZTtcbiAga2V5cyA9IFtdO1xuICB2YWx1ZXMgPSBbXTtcbiAgZm9yIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgdmFsdWUgPSBvYmplY3Rba2V5XTtcbiAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gIH1cbiAgcmV0dXJuIFtrZXlzLCB2YWx1ZXNdO1xufTtcbmVtcHR5ID0gZnVuY3Rpb24ob2JqZWN0KXtcbiAgdmFyIHg7XG4gIGZvciAoeCBpbiBvYmplY3QpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuZWFjaCA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaSQsIHg7XG4gIGZvciAoaSQgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtpJF07XG4gICAgZih4KTtcbiAgfVxuICByZXR1cm4gb2JqZWN0O1xufSk7XG5tYXAgPSBjdXJyeSQoZnVuY3Rpb24oZiwgb2JqZWN0KXtcbiAgdmFyIGssIHgsIHJlc3VsdE9iaiQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG4gICAgcmVzdWx0T2JqJFtrXSA9IGYoeCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdE9iaiQ7XG59KTtcbmNvbXBhY3QgPSBmdW5jdGlvbihvYmplY3Qpe1xuICB2YXIgaywgeCwgcmVzdWx0T2JqJCA9IHt9O1xuICBmb3IgKGsgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtrXTtcbiAgICBpZiAoeCkge1xuICAgICAgcmVzdWx0T2JqJFtrXSA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRPYmokO1xufTtcbmZpbHRlciA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaywgeCwgcmVzdWx0T2JqJCA9IHt9O1xuICBmb3IgKGsgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtrXTtcbiAgICBpZiAoZih4KSkge1xuICAgICAgcmVzdWx0T2JqJFtrXSA9IHg7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRPYmokO1xufSk7XG5yZWplY3QgPSBjdXJyeSQoZnVuY3Rpb24oZiwgb2JqZWN0KXtcbiAgdmFyIGssIHgsIHJlc3VsdE9iaiQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG4gICAgaWYgKCFmKHgpKSB7XG4gICAgICByZXN1bHRPYmokW2tdID0geDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdE9iaiQ7XG59KTtcbnBhcnRpdGlvbiA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgcGFzc2VkLCBmYWlsZWQsIGssIHg7XG4gIHBhc3NlZCA9IHt9O1xuICBmYWlsZWQgPSB7fTtcbiAgZm9yIChrIGluIG9iamVjdCkge1xuICAgIHggPSBvYmplY3Rba107XG4gICAgKGYoeCkgPyBwYXNzZWQgOiBmYWlsZWQpW2tdID0geDtcbiAgfVxuICByZXR1cm4gW3Bhc3NlZCwgZmFpbGVkXTtcbn0pO1xuZmluZCA9IGN1cnJ5JChmdW5jdGlvbihmLCBvYmplY3Qpe1xuICB2YXIgaSQsIHg7XG4gIGZvciAoaSQgaW4gb2JqZWN0KSB7XG4gICAgeCA9IG9iamVjdFtpJF07XG4gICAgaWYgKGYoeCkpIHtcbiAgICAgIHJldHVybiB4O1xuICAgIH1cbiAgfVxufSk7XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgdmFsdWVzOiB2YWx1ZXMsXG4gIGtleXM6IGtleXMsXG4gIHBhaXJzVG9PYmo6IHBhaXJzVG9PYmosXG4gIG9ialRvUGFpcnM6IG9ialRvUGFpcnMsXG4gIGxpc3RzVG9PYmo6IGxpc3RzVG9PYmosXG4gIG9ialRvTGlzdHM6IG9ialRvTGlzdHMsXG4gIGVtcHR5OiBlbXB0eSxcbiAgZWFjaDogZWFjaCxcbiAgbWFwOiBtYXAsXG4gIGZpbHRlcjogZmlsdGVyLFxuICBjb21wYWN0OiBjb21wYWN0LFxuICByZWplY3Q6IHJlamVjdCxcbiAgcGFydGl0aW9uOiBwYXJ0aXRpb24sXG4gIGZpbmQ6IGZpbmRcbn07XG5mdW5jdGlvbiBjdXJyeSQoZiwgYm91bmQpe1xuICB2YXIgY29udGV4dCxcbiAgX2N1cnJ5ID0gZnVuY3Rpb24oYXJncykge1xuICAgIHJldHVybiBmLmxlbmd0aCA+IDEgPyBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtcyA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW107XG4gICAgICBjb250ZXh0ID0gYm91bmQgPyBjb250ZXh0IHx8IHRoaXMgOiB0aGlzO1xuICAgICAgcmV0dXJuIHBhcmFtcy5wdXNoLmFwcGx5KHBhcmFtcywgYXJndW1lbnRzKSA8XG4gICAgICAgICAgZi5sZW5ndGggJiYgYXJndW1lbnRzLmxlbmd0aCA/XG4gICAgICAgIF9jdXJyeS5jYWxsKGNvbnRleHQsIHBhcmFtcykgOiBmLmFwcGx5KGNvbnRleHQsIHBhcmFtcyk7XG4gICAgfSA6IGY7XG4gIH07XG4gIHJldHVybiBfY3VycnkoKTtcbn0iLCIvLyBHZW5lcmF0ZWQgYnkgTGl2ZVNjcmlwdCAxLjQuMFxudmFyIHNwbGl0LCBqb2luLCBsaW5lcywgdW5saW5lcywgd29yZHMsIHVud29yZHMsIGNoYXJzLCB1bmNoYXJzLCByZXZlcnNlLCByZXBlYXQsIGNhcGl0YWxpemUsIGNhbWVsaXplLCBkYXNoZXJpemU7XG5zcGxpdCA9IGN1cnJ5JChmdW5jdGlvbihzZXAsIHN0cil7XG4gIHJldHVybiBzdHIuc3BsaXQoc2VwKTtcbn0pO1xuam9pbiA9IGN1cnJ5JChmdW5jdGlvbihzZXAsIHhzKXtcbiAgcmV0dXJuIHhzLmpvaW4oc2VwKTtcbn0pO1xubGluZXMgPSBmdW5jdGlvbihzdHIpe1xuICBpZiAoIXN0ci5sZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgcmV0dXJuIHN0ci5zcGxpdCgnXFxuJyk7XG59O1xudW5saW5lcyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0LmpvaW4oJ1xcbicpO1xufTtcbndvcmRzID0gZnVuY3Rpb24oc3RyKXtcbiAgaWYgKCFzdHIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHJldHVybiBzdHIuc3BsaXQoL1sgXSsvKTtcbn07XG51bndvcmRzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQuam9pbignICcpO1xufTtcbmNoYXJzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQuc3BsaXQoJycpO1xufTtcbnVuY2hhcnMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiBpdC5qb2luKCcnKTtcbn07XG5yZXZlcnNlID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5zcGxpdCgnJykucmV2ZXJzZSgpLmpvaW4oJycpO1xufTtcbnJlcGVhdCA9IGN1cnJ5JChmdW5jdGlvbihuLCBzdHIpe1xuICB2YXIgcmVzdWx0LCBpJDtcbiAgcmVzdWx0ID0gJyc7XG4gIGZvciAoaSQgPSAwOyBpJCA8IG47ICsraSQpIHtcbiAgICByZXN1bHQgKz0gc3RyO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59KTtcbmNhcGl0YWxpemUgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpO1xufTtcbmNhbWVsaXplID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXQucmVwbGFjZSgvWy1fXSsoLik/L2csIGZ1bmN0aW9uKGFyZyQsIGMpe1xuICAgIHJldHVybiAoYyAhPSBudWxsID8gYyA6ICcnKS50b1VwcGVyQ2FzZSgpO1xuICB9KTtcbn07XG5kYXNoZXJpemUgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbXi1BLVpdKShbQS1aXSspL2csIGZ1bmN0aW9uKGFyZyQsIGxvd2VyLCB1cHBlcil7XG4gICAgcmV0dXJuIGxvd2VyICsgXCItXCIgKyAodXBwZXIubGVuZ3RoID4gMVxuICAgICAgPyB1cHBlclxuICAgICAgOiB1cHBlci50b0xvd2VyQ2FzZSgpKTtcbiAgfSkucmVwbGFjZSgvXihbQS1aXSspLywgZnVuY3Rpb24oYXJnJCwgdXBwZXIpe1xuICAgIGlmICh1cHBlci5sZW5ndGggPiAxKSB7XG4gICAgICByZXR1cm4gdXBwZXIgKyBcIi1cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVwcGVyLnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuICB9KTtcbn07XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc3BsaXQ6IHNwbGl0LFxuICBqb2luOiBqb2luLFxuICBsaW5lczogbGluZXMsXG4gIHVubGluZXM6IHVubGluZXMsXG4gIHdvcmRzOiB3b3JkcyxcbiAgdW53b3JkczogdW53b3JkcyxcbiAgY2hhcnM6IGNoYXJzLFxuICB1bmNoYXJzOiB1bmNoYXJzLFxuICByZXZlcnNlOiByZXZlcnNlLFxuICByZXBlYXQ6IHJlcGVhdCxcbiAgY2FwaXRhbGl6ZTogY2FwaXRhbGl6ZSxcbiAgY2FtZWxpemU6IGNhbWVsaXplLFxuICBkYXNoZXJpemU6IGRhc2hlcml6ZVxufTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsIi8vIEdlbmVyYXRlZCBieSBMaXZlU2NyaXB0IDEuNC4wXG52YXIgRnVuYywgTGlzdCwgT2JqLCBTdHIsIE51bSwgaWQsIGlzVHlwZSwgcmVwbGljYXRlLCBwcmVsdWRlLCB0b1N0cmluZyQgPSB7fS50b1N0cmluZztcbkZ1bmMgPSByZXF1aXJlKCcuL0Z1bmMuanMnKTtcbkxpc3QgPSByZXF1aXJlKCcuL0xpc3QuanMnKTtcbk9iaiA9IHJlcXVpcmUoJy4vT2JqLmpzJyk7XG5TdHIgPSByZXF1aXJlKCcuL1N0ci5qcycpO1xuTnVtID0gcmVxdWlyZSgnLi9OdW0uanMnKTtcbmlkID0gZnVuY3Rpb24oeCl7XG4gIHJldHVybiB4O1xufTtcbmlzVHlwZSA9IGN1cnJ5JChmdW5jdGlvbih0eXBlLCB4KXtcbiAgcmV0dXJuIHRvU3RyaW5nJC5jYWxsKHgpLnNsaWNlKDgsIC0xKSA9PT0gdHlwZTtcbn0pO1xucmVwbGljYXRlID0gY3VycnkkKGZ1bmN0aW9uKG4sIHgpe1xuICB2YXIgaSQsIHJlc3VsdHMkID0gW107XG4gIGZvciAoaSQgPSAwOyBpJCA8IG47ICsraSQpIHtcbiAgICByZXN1bHRzJC5wdXNoKHgpO1xuICB9XG4gIHJldHVybiByZXN1bHRzJDtcbn0pO1xuU3RyLmVtcHR5ID0gTGlzdC5lbXB0eTtcblN0ci5zbGljZSA9IExpc3Quc2xpY2U7XG5TdHIudGFrZSA9IExpc3QudGFrZTtcblN0ci5kcm9wID0gTGlzdC5kcm9wO1xuU3RyLnNwbGl0QXQgPSBMaXN0LnNwbGl0QXQ7XG5TdHIudGFrZVdoaWxlID0gTGlzdC50YWtlV2hpbGU7XG5TdHIuZHJvcFdoaWxlID0gTGlzdC5kcm9wV2hpbGU7XG5TdHIuc3BhbiA9IExpc3Quc3BhbjtcblN0ci5icmVha1N0ciA9IExpc3QuYnJlYWtMaXN0O1xucHJlbHVkZSA9IHtcbiAgRnVuYzogRnVuYyxcbiAgTGlzdDogTGlzdCxcbiAgT2JqOiBPYmosXG4gIFN0cjogU3RyLFxuICBOdW06IE51bSxcbiAgaWQ6IGlkLFxuICBpc1R5cGU6IGlzVHlwZSxcbiAgcmVwbGljYXRlOiByZXBsaWNhdGVcbn07XG5wcmVsdWRlLmVhY2ggPSBMaXN0LmVhY2g7XG5wcmVsdWRlLm1hcCA9IExpc3QubWFwO1xucHJlbHVkZS5maWx0ZXIgPSBMaXN0LmZpbHRlcjtcbnByZWx1ZGUuY29tcGFjdCA9IExpc3QuY29tcGFjdDtcbnByZWx1ZGUucmVqZWN0ID0gTGlzdC5yZWplY3Q7XG5wcmVsdWRlLnBhcnRpdGlvbiA9IExpc3QucGFydGl0aW9uO1xucHJlbHVkZS5maW5kID0gTGlzdC5maW5kO1xucHJlbHVkZS5oZWFkID0gTGlzdC5oZWFkO1xucHJlbHVkZS5maXJzdCA9IExpc3QuZmlyc3Q7XG5wcmVsdWRlLnRhaWwgPSBMaXN0LnRhaWw7XG5wcmVsdWRlLmxhc3QgPSBMaXN0Lmxhc3Q7XG5wcmVsdWRlLmluaXRpYWwgPSBMaXN0LmluaXRpYWw7XG5wcmVsdWRlLmVtcHR5ID0gTGlzdC5lbXB0eTtcbnByZWx1ZGUucmV2ZXJzZSA9IExpc3QucmV2ZXJzZTtcbnByZWx1ZGUuZGlmZmVyZW5jZSA9IExpc3QuZGlmZmVyZW5jZTtcbnByZWx1ZGUuaW50ZXJzZWN0aW9uID0gTGlzdC5pbnRlcnNlY3Rpb247XG5wcmVsdWRlLnVuaW9uID0gTGlzdC51bmlvbjtcbnByZWx1ZGUuY291bnRCeSA9IExpc3QuY291bnRCeTtcbnByZWx1ZGUuZ3JvdXBCeSA9IExpc3QuZ3JvdXBCeTtcbnByZWx1ZGUuZm9sZCA9IExpc3QuZm9sZDtcbnByZWx1ZGUuZm9sZGwgPSBMaXN0LmZvbGRsO1xucHJlbHVkZS5mb2xkMSA9IExpc3QuZm9sZDE7XG5wcmVsdWRlLmZvbGRsMSA9IExpc3QuZm9sZGwxO1xucHJlbHVkZS5mb2xkciA9IExpc3QuZm9sZHI7XG5wcmVsdWRlLmZvbGRyMSA9IExpc3QuZm9sZHIxO1xucHJlbHVkZS51bmZvbGRyID0gTGlzdC51bmZvbGRyO1xucHJlbHVkZS5hbmRMaXN0ID0gTGlzdC5hbmRMaXN0O1xucHJlbHVkZS5vckxpc3QgPSBMaXN0Lm9yTGlzdDtcbnByZWx1ZGUuYW55ID0gTGlzdC5hbnk7XG5wcmVsdWRlLmFsbCA9IExpc3QuYWxsO1xucHJlbHVkZS51bmlxdWUgPSBMaXN0LnVuaXF1ZTtcbnByZWx1ZGUudW5pcXVlQnkgPSBMaXN0LnVuaXF1ZUJ5O1xucHJlbHVkZS5zb3J0ID0gTGlzdC5zb3J0O1xucHJlbHVkZS5zb3J0V2l0aCA9IExpc3Quc29ydFdpdGg7XG5wcmVsdWRlLnNvcnRCeSA9IExpc3Quc29ydEJ5O1xucHJlbHVkZS5zdW0gPSBMaXN0LnN1bTtcbnByZWx1ZGUucHJvZHVjdCA9IExpc3QucHJvZHVjdDtcbnByZWx1ZGUubWVhbiA9IExpc3QubWVhbjtcbnByZWx1ZGUuYXZlcmFnZSA9IExpc3QuYXZlcmFnZTtcbnByZWx1ZGUuY29uY2F0ID0gTGlzdC5jb25jYXQ7XG5wcmVsdWRlLmNvbmNhdE1hcCA9IExpc3QuY29uY2F0TWFwO1xucHJlbHVkZS5mbGF0dGVuID0gTGlzdC5mbGF0dGVuO1xucHJlbHVkZS5tYXhpbXVtID0gTGlzdC5tYXhpbXVtO1xucHJlbHVkZS5taW5pbXVtID0gTGlzdC5taW5pbXVtO1xucHJlbHVkZS5tYXhpbXVtQnkgPSBMaXN0Lm1heGltdW1CeTtcbnByZWx1ZGUubWluaW11bUJ5ID0gTGlzdC5taW5pbXVtQnk7XG5wcmVsdWRlLnNjYW4gPSBMaXN0LnNjYW47XG5wcmVsdWRlLnNjYW5sID0gTGlzdC5zY2FubDtcbnByZWx1ZGUuc2NhbjEgPSBMaXN0LnNjYW4xO1xucHJlbHVkZS5zY2FubDEgPSBMaXN0LnNjYW5sMTtcbnByZWx1ZGUuc2NhbnIgPSBMaXN0LnNjYW5yO1xucHJlbHVkZS5zY2FucjEgPSBMaXN0LnNjYW5yMTtcbnByZWx1ZGUuc2xpY2UgPSBMaXN0LnNsaWNlO1xucHJlbHVkZS50YWtlID0gTGlzdC50YWtlO1xucHJlbHVkZS5kcm9wID0gTGlzdC5kcm9wO1xucHJlbHVkZS5zcGxpdEF0ID0gTGlzdC5zcGxpdEF0O1xucHJlbHVkZS50YWtlV2hpbGUgPSBMaXN0LnRha2VXaGlsZTtcbnByZWx1ZGUuZHJvcFdoaWxlID0gTGlzdC5kcm9wV2hpbGU7XG5wcmVsdWRlLnNwYW4gPSBMaXN0LnNwYW47XG5wcmVsdWRlLmJyZWFrTGlzdCA9IExpc3QuYnJlYWtMaXN0O1xucHJlbHVkZS56aXAgPSBMaXN0LnppcDtcbnByZWx1ZGUuemlwV2l0aCA9IExpc3QuemlwV2l0aDtcbnByZWx1ZGUuemlwQWxsID0gTGlzdC56aXBBbGw7XG5wcmVsdWRlLnppcEFsbFdpdGggPSBMaXN0LnppcEFsbFdpdGg7XG5wcmVsdWRlLmF0ID0gTGlzdC5hdDtcbnByZWx1ZGUuZWxlbUluZGV4ID0gTGlzdC5lbGVtSW5kZXg7XG5wcmVsdWRlLmVsZW1JbmRpY2VzID0gTGlzdC5lbGVtSW5kaWNlcztcbnByZWx1ZGUuZmluZEluZGV4ID0gTGlzdC5maW5kSW5kZXg7XG5wcmVsdWRlLmZpbmRJbmRpY2VzID0gTGlzdC5maW5kSW5kaWNlcztcbnByZWx1ZGUuYXBwbHkgPSBGdW5jLmFwcGx5O1xucHJlbHVkZS5jdXJyeSA9IEZ1bmMuY3Vycnk7XG5wcmVsdWRlLmZsaXAgPSBGdW5jLmZsaXA7XG5wcmVsdWRlLmZpeCA9IEZ1bmMuZml4O1xucHJlbHVkZS5vdmVyID0gRnVuYy5vdmVyO1xucHJlbHVkZS5zcGxpdCA9IFN0ci5zcGxpdDtcbnByZWx1ZGUuam9pbiA9IFN0ci5qb2luO1xucHJlbHVkZS5saW5lcyA9IFN0ci5saW5lcztcbnByZWx1ZGUudW5saW5lcyA9IFN0ci51bmxpbmVzO1xucHJlbHVkZS53b3JkcyA9IFN0ci53b3JkcztcbnByZWx1ZGUudW53b3JkcyA9IFN0ci51bndvcmRzO1xucHJlbHVkZS5jaGFycyA9IFN0ci5jaGFycztcbnByZWx1ZGUudW5jaGFycyA9IFN0ci51bmNoYXJzO1xucHJlbHVkZS5yZXBlYXQgPSBTdHIucmVwZWF0O1xucHJlbHVkZS5jYXBpdGFsaXplID0gU3RyLmNhcGl0YWxpemU7XG5wcmVsdWRlLmNhbWVsaXplID0gU3RyLmNhbWVsaXplO1xucHJlbHVkZS5kYXNoZXJpemUgPSBTdHIuZGFzaGVyaXplO1xucHJlbHVkZS52YWx1ZXMgPSBPYmoudmFsdWVzO1xucHJlbHVkZS5rZXlzID0gT2JqLmtleXM7XG5wcmVsdWRlLnBhaXJzVG9PYmogPSBPYmoucGFpcnNUb09iajtcbnByZWx1ZGUub2JqVG9QYWlycyA9IE9iai5vYmpUb1BhaXJzO1xucHJlbHVkZS5saXN0c1RvT2JqID0gT2JqLmxpc3RzVG9PYmo7XG5wcmVsdWRlLm9ialRvTGlzdHMgPSBPYmoub2JqVG9MaXN0cztcbnByZWx1ZGUubWF4ID0gTnVtLm1heDtcbnByZWx1ZGUubWluID0gTnVtLm1pbjtcbnByZWx1ZGUubmVnYXRlID0gTnVtLm5lZ2F0ZTtcbnByZWx1ZGUuYWJzID0gTnVtLmFicztcbnByZWx1ZGUuc2lnbnVtID0gTnVtLnNpZ251bTtcbnByZWx1ZGUucXVvdCA9IE51bS5xdW90O1xucHJlbHVkZS5yZW0gPSBOdW0ucmVtO1xucHJlbHVkZS5kaXYgPSBOdW0uZGl2O1xucHJlbHVkZS5tb2QgPSBOdW0ubW9kO1xucHJlbHVkZS5yZWNpcCA9IE51bS5yZWNpcDtcbnByZWx1ZGUucGkgPSBOdW0ucGk7XG5wcmVsdWRlLnRhdSA9IE51bS50YXU7XG5wcmVsdWRlLmV4cCA9IE51bS5leHA7XG5wcmVsdWRlLnNxcnQgPSBOdW0uc3FydDtcbnByZWx1ZGUubG4gPSBOdW0ubG47XG5wcmVsdWRlLnBvdyA9IE51bS5wb3c7XG5wcmVsdWRlLnNpbiA9IE51bS5zaW47XG5wcmVsdWRlLnRhbiA9IE51bS50YW47XG5wcmVsdWRlLmNvcyA9IE51bS5jb3M7XG5wcmVsdWRlLmFjb3MgPSBOdW0uYWNvcztcbnByZWx1ZGUuYXNpbiA9IE51bS5hc2luO1xucHJlbHVkZS5hdGFuID0gTnVtLmF0YW47XG5wcmVsdWRlLmF0YW4yID0gTnVtLmF0YW4yO1xucHJlbHVkZS50cnVuY2F0ZSA9IE51bS50cnVuY2F0ZTtcbnByZWx1ZGUucm91bmQgPSBOdW0ucm91bmQ7XG5wcmVsdWRlLmNlaWxpbmcgPSBOdW0uY2VpbGluZztcbnByZWx1ZGUuZmxvb3IgPSBOdW0uZmxvb3I7XG5wcmVsdWRlLmlzSXROYU4gPSBOdW0uaXNJdE5hTjtcbnByZWx1ZGUuZXZlbiA9IE51bS5ldmVuO1xucHJlbHVkZS5vZGQgPSBOdW0ub2RkO1xucHJlbHVkZS5nY2QgPSBOdW0uZ2NkO1xucHJlbHVkZS5sY20gPSBOdW0ubGNtO1xucHJlbHVkZS5WRVJTSU9OID0gJzEuMS4yJztcbm1vZHVsZS5leHBvcnRzID0gcHJlbHVkZTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsIihmdW5jdGlvbigpe1xuICB2YXIgaSQsIHJlZiQsIGxlbiQsIG1vZHVsZTtcbiAgaWYgKHR5cGVvZiBnbG9iYWwgIT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsKSB7XG4gICAgaW1wb3J0JChnbG9iYWwsIHJlcXVpcmUoJ3ByZWx1ZGUtbHMnKSk7XG4gIH1cbiAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIiwgW1wibmdSb3V0ZVwiLCBcIm5nUmVzb3VyY2VcIiwgXCJMb2NhbFN0b3JhZ2VNb2R1bGVcIiwgXCJhbmd1Y29tcGxldGUtYWx0XCIsIFwidWkuZ3JpZFwiLCBcInVpLmdyaWQuYXV0b1Jlc2l6ZVwiXSkuZmlsdGVyKCdwZXJjZW50YWdlJywgZnVuY3Rpb24oJGZpbHRlcil7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBkZWNpbWFscyl7XG4gICAgICBkZWNpbWFscyA9PSBudWxsICYmIChkZWNpbWFscyA9IDApO1xuICAgICAgcmV0dXJuICRmaWx0ZXIoJ251bWJlcicpKGlucHV0ICogMTAwLCBkZWNpbWFscykgKyAnJSc7XG4gICAgfTtcbiAgfSk7XG4gIHJlcXVpcmUoJy4vYXBwL3JvdXRlcycpO1xuICByZXF1aXJlKCcuL2FwcC9zZXJ2aWNlcy9zdG9yYWdlLXNlcnZpY2UnKTtcbiAgcmVxdWlyZSgnLi9hcHAvc2VydmljZXMvZXh0ZXJuYWwtZGF0YS1zZXJ2aWNlJyk7XG4gIHJlcXVpcmUoJy4vYXBwL3NlcnZpY2VzL2RhdGEtZXhwb3J0LXNlcnZpY2UnKTtcbiAgKGZ1bmN0aW9uKCl7XG4gICAgcmVxdWlyZSgnLi9tb2R1bGVzL2FybW9yLWNhbGMvbWFpbi5qcycpO3JlcXVpcmUoJy4vbW9kdWxlcy9ndWlkZS9tYWluLmpzJyk7cmVxdWlyZSgnLi9tb2R1bGVzL2ludmVudG9yeS9tYWluLmpzJyk7cmVxdWlyZSgnLi9tb2R1bGVzL2l0ZW1zL21haW4uanMnKTtyZXF1aXJlKCcuL21vZHVsZXMvcGMvbWFpbi5qcycpO3JlcXVpcmUoJy4vbW9kdWxlcy93LWNhbGMvbWFpbi5qcycpO1xuICB9KTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IFsnZ3VpZGUnLCAnaXRlbXMnLCAnaW52ZW50b3J5JywgJ3BjJywgJ3ctY2FsYycsICdhLWNhbGMnXSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBtb2R1bGUgPSByZWYkW2kkXTtcbiAgICByZXF1aXJlKFwiLi9tb2R1bGVzL1wiICsgbW9kdWxlICsgXCIvbWFpbi5qc1wiKTtcbiAgfVxuICBmdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgICByZXR1cm4gb2JqO1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlcil7XG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignL2d1aWRlLzpzZWN0aW9uJywge1xuICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2d1aWRlL3ZpZXcuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnR3VpZGVDb250cm9sbGVyJ1xuICAgIH0pLndoZW4oJy9pdGVtcycsIHtcbiAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9pdGVtcy92aWV3Lmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ0l0ZW1zQ29udHJvbGxlcidcbiAgICB9KS53aGVuKCcvaW52ZW50b3J5Jywge1xuICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2ludmVudG9yeS9pbnZlbnRvcnktdmlldy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdJbnZlbnRvcnlDb250cm9sbGVyJ1xuICAgIH0pLndoZW4oJy9zdGF0cycsIHtcbiAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9wYy92aWV3Lmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ1BjQ29udHJvbGxlcidcbiAgICB9KS53aGVuKCcvdy1jYWxjJywge1xuICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL3ctY2FsYy92aWV3Lmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ1dlYXBvbkNhbGNDb250cm9sbGVyJ1xuICAgIH0pLndoZW4oJy9hLWNhbGMnLCB7XG4gICAgICB0ZW1wbGF0ZVVybDogJ21vZHVsZXMvYXJtb3ItY2FsYy92aWV3Lmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ0FybW9yQ2FsY0NvbnRyb2xsZXInXG4gICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgIHJlZGlyZWN0VG86ICcvZ3VpZGUvaW50cm8nXG4gICAgfSk7XG4gIH0pO1xufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICBhbmd1bGFyLm1vZHVsZShcImRzY1wiKS5zZXJ2aWNlKCdkYXRhRXhwb3J0U3ZjJywgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4ge1xuICAgICAgZXhwb3J0SnNvbjogZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIHdpbmRvdy5vcGVuKGVuY29kZVVSSShcImRhdGE6YXBwbGljYXRpb24vanNvbixcIiArIEpTT04uc3RyaW5naWZ5KGRhdGEpKSk7XG4gICAgICB9LFxuICAgICAgZXhwb3J0Q3N2OiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIGZpcnN0TGluZSwgcm93cywgaSQsIGxlbiQsIGl0ZW0sIHJvdywga2V5LCB2YWx1ZSwgb3V0cHV0O1xuICAgICAgICBmaXJzdExpbmUgPSBqb2luKCcsJykoXG4gICAgICAgIGtleXMoXG4gICAgICAgIGZpcnN0KFxuICAgICAgICBkYXRhKSkpO1xuICAgICAgICByb3dzID0gW107XG4gICAgICAgIGZvciAoaSQgPSAwLCBsZW4kID0gZGF0YS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgICAgIGl0ZW0gPSBkYXRhW2kkXTtcbiAgICAgICAgICByb3cgPSBbXTtcbiAgICAgICAgICBmb3IgKGtleSBpbiBpdGVtKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGl0ZW1ba2V5XTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCdcIicsICdcIlwiJykucmVwbGFjZSgvKFxcclxcbnxcXG58XFxyKS9nLCAnXFxcXG4nKTtcbiAgICAgICAgICAgICAgdmFsdWUgPSBcIlxcXCJcIiArIHZhbHVlICsgXCJcXFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3cucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJvdyA9IGpvaW4oJywnKShcbiAgICAgICAgICByb3cpO1xuICAgICAgICAgIHJvd3MucHVzaChyb3cpO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dCA9IGZpcnN0TGluZSArIFwiXFxuXCIgKyBqb2luKFwiXFxuXCIpKFxuICAgICAgICByb3dzKTtcbiAgICAgICAgd2luZG93Lm9wZW4oZW5jb2RlVVJJKFwiZGF0YTp0ZXh0L3BsYWluLFwiICsgb3V0cHV0KSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIHZhciBFeHRlcm5hbERhdGFTZXJ2aWNlO1xuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT0gJ3VuZGVmaW5lZCcgJiYgYW5ndWxhciAhPT0gbnVsbCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLnNlcnZpY2UoXCJleHRlcm5hbERhdGFTdmNcIiwgZnVuY3Rpb24oJHJlc291cmNlLCAkcSl7XG4gICAgICByZXR1cm4gbmV3IEV4dGVybmFsRGF0YVNlcnZpY2UoJHJlc291cmNlLCAkcSk7XG4gICAgfSk7XG4gIH1cbiAgRXh0ZXJuYWxEYXRhU2VydmljZSA9IChmdW5jdGlvbigpe1xuICAgIEV4dGVybmFsRGF0YVNlcnZpY2UuZGlzcGxheU5hbWUgPSAnRXh0ZXJuYWxEYXRhU2VydmljZSc7XG4gICAgdmFyIHByb3RvdHlwZSA9IEV4dGVybmFsRGF0YVNlcnZpY2UucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEV4dGVybmFsRGF0YVNlcnZpY2U7XG4gICAgZnVuY3Rpb24gRXh0ZXJuYWxEYXRhU2VydmljZSgkcmVzb3VyY2UsICRxKXtcbiAgICAgIHRoaXMuJHJlc291cmNlID0gJHJlc291cmNlO1xuICAgICAgdGhpcy4kcSA9ICRxO1xuICAgICAgdGhpcy5sb2FkSnNvbiA9IGJpbmQkKHRoaXMsICdsb2FkSnNvbicsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLl9jYWNoZSA9IHt9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2FkIGFuIGV4dGVybmFsIEpTT04gcmVzb3VyY2UgYW5kIHBhcnNlIGl0IGludG8gYW4gYXJyYXlcbiAgICAgKi9cbiAgICBwcm90b3R5cGUubG9hZEpzb24gPSBmdW5jdGlvbih1cmwsIHJldHVyblByb21pc2Upe1xuICAgICAgdmFyIHRhc2ssIHJlZiQsIHRoaXMkID0gdGhpcztcbiAgICAgIHJldHVyblByb21pc2UgPT0gbnVsbCAmJiAocmV0dXJuUHJvbWlzZSA9IHRydWUpO1xuICAgICAgaWYgKHVybCA9PSBudWxsIHx8IHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIgfHwgdXJsLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBVUkw6IFtcIiArIHVybCArIFwiXVwiKTtcbiAgICAgIH1cbiAgICAgIHRhc2sgPSB0aGlzLiRxLmRlZmVyKCk7XG4gICAgICBpZiAoZW1wdHkoXG4gICAgICAocmVmJCA9IHRoaXMuX2NhY2hlKVt1cmxdIHx8IChyZWYkW3VybF0gPSBbXSkpKSB7XG4gICAgICAgIHRoaXMuX2NhY2hlW3VybF0gPSB0aGlzLiRyZXNvdXJjZSh1cmwpLnF1ZXJ5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgdGFzay5yZXNvbHZlKHRoaXMkLl9jYWNoZVt1cmxdKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXNrLnJlc29sdmUodGhpcy5fY2FjaGVbdXJsXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV0dXJuUHJvbWlzZVxuICAgICAgICA/IHRhc2sucHJvbWlzZVxuICAgICAgICA6IHRoaXMuX2NhY2hlW3VybF07XG4gICAgfTtcbiAgICByZXR1cm4gRXh0ZXJuYWxEYXRhU2VydmljZTtcbiAgfSgpKTtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlICE9PSBudWxsKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBFeHRlcm5hbERhdGFTZXJ2aWNlO1xuICB9XG4gIGZ1bmN0aW9uIGJpbmQkKG9iaiwga2V5LCB0YXJnZXQpe1xuICAgIHJldHVybiBmdW5jdGlvbigpeyByZXR1cm4gKHRhcmdldCB8fCBvYmopW2tleV0uYXBwbHkob2JqLCBhcmd1bWVudHMpIH07XG4gIH1cbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuY29uZmlnKGZ1bmN0aW9uKGxvY2FsU3RvcmFnZVNlcnZpY2VQcm92aWRlcil7XG4gICAgbG9jYWxTdG9yYWdlU2VydmljZVByb3ZpZGVyLnNldFByZWZpeChcIkRTQ1wiKTtcbiAgfSkuc2VydmljZSgnc3RvcmFnZVN2YycsIFtcbiAgICAnbG9jYWxTdG9yYWdlU2VydmljZScsIGZ1bmN0aW9uKGxvY2FsU3RvcmFnZSl7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzYXZlOiBmdW5jdGlvbihrZXksIGRhdGEpe1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXQoa2V5LCBkYXRhKTtcbiAgICAgICAgfSxcbiAgICAgICAgbG9hZDogZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldChrZXkpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgXSk7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLmNvbnRyb2xsZXIoXCJBcm1vckNhbGNDb250cm9sbGVyXCIsIGZ1bmN0aW9uKCRxLCAkc2NvcGUsIGl0ZW1TdmMsIGl0ZW1VcGdyYWRlU3ZjLCBpbnZlbnRvcnlTdmMsIHBjU2VydmljZSwgdWlHcmlkQ29uc3RhbnRzKXtcbiAgICB2YXIgeCQsIF9jYWxjU2NvcmVzRm9yLCBfYWRkQXZhaWxhYmxlVXBncmFkZXNUbztcbiAgICAkc2NvcGUucmVzdWx0cyA9IFtdO1xuICAgICRzY29wZS5tYXhMb2FkID0gMDtcbiAgICAkc2NvcGUucmVzZXJ2ZWRXZWlnaHQgPSA0MDtcbiAgICAkc2NvcGUuYXZhaWxhYmxlTG9hZCA9IDA7XG4gICAgJHNjb3BlLm1heExvYWQgPSA0MCArIHBjU2VydmljZS5zdGF0VmFsdWVPZignZW5kdXJhbmNlJyk7XG4gICAgJHNjb3BlLnR5cGVOYW1lcyA9IHtcbiAgICAgIDA6ICdoZWFkJyxcbiAgICAgIDE6ICdjaGVzdCcsXG4gICAgICAyOiAnaGFuZHMnLFxuICAgICAgMzogJ2xlZ3MnXG4gICAgfTtcbiAgICAkc2NvcGUucGFydE5hbWVzID0gWydoZWFkJywgJ2NoZXN0JywgJ2hhbmRzJywgJ2xlZ3MnXTtcbiAgICB4JCA9ICRzY29wZS5ncmlkT3B0aW9ucyA9IHJlcXVpcmUoJy4vY29udHJvbGxlci9ncmlkT3B0aW9ucycpKHVpR3JpZENvbnN0YW50cyk7XG4gICAgeCQuZGF0YSA9ICRzY29wZS5yZXN1bHRzO1xuICAgIF9jYWxjU2NvcmVzRm9yID0gZnVuY3Rpb24oc2V0KXtcbiAgICAgIHZhciByZXN1bHQsIGkkLCBsZW4kLCBrZXksIGl0ZW0sIGRlZiwgc2NvcmU7XG4gICAgICByZXN1bHQgPSB7XG4gICAgICAgIHNjb3JlOiAwLFxuICAgICAgICB3ZWlnaHQ6IDAsXG4gICAgICAgIGRlZjogMFxuICAgICAgfTtcbiAgICAgIGZvciAoaSQgPSAwLCBsZW4kID0gc2V0Lmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGtleSA9IGkkO1xuICAgICAgICBpdGVtID0gc2V0W2kkXTtcbiAgICAgICAgZGVmID0gKGl0ZW0uZGVmUGh5ICsgaXRlbS5kZWZTdHJpa2UgKyBpdGVtLmRlZlNsYXNoICsgaXRlbS5kZWZUaHJ1c3QpIC8gNDtcbiAgICAgICAgc2NvcmUgPSBkZWY7XG4gICAgICAgIHJlc3VsdFskc2NvcGUudHlwZU5hbWVzW2tleV1dID0ge1xuICAgICAgICAgIHNjb3JlOiBzY29yZSxcbiAgICAgICAgICBpdGVtOiBpdGVtLFxuICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZVxuICAgICAgICB9O1xuICAgICAgICByZXN1bHQuZGVmICs9IGRlZjtcbiAgICAgICAgcmVzdWx0LnNjb3JlICs9IHNjb3JlO1xuICAgICAgICByZXN1bHQud2VpZ2h0ICs9IGl0ZW0ud2VpZ2h0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIF9hZGRBdmFpbGFibGVVcGdyYWRlc1RvID0gZnVuY3Rpb24oYXJtb3JzLCBpbnZlbnRvcnkpe1xuICAgICAgdmFyIGRlZiwgcHJvbWlzZSwgZnVsbEFybW9yTGlzdCwgaSQsIGxlbiQsIGFybW9yLCBtYXRlcmlhbHMsIGokLCBsZXZlbDtcbiAgICAgIGRlZiA9ICRxLmRlZmVyKCk7XG4gICAgICBwcm9taXNlID0gJHEoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgICBmdWxsQXJtb3JMaXN0ID0gW107XG4gICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IGFybW9ycy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgICBhcm1vciA9IGFybW9yc1tpJF07XG4gICAgICAgIGZ1bGxBcm1vckxpc3QucHVzaChhcm1vcik7XG4gICAgICAgIGlmIChhcm1vci5pZCA8IDAgfHwgYXJtb3IudXBncmFkZUlkIDwgMCkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIG1hdGVyaWFscyA9IG1hcChmbiQpKFxuICAgICAgICBpbnZlbnRvcnkpO1xuICAgICAgICBmb3IgKGokID0gMTsgaiQgPD0gMTA7ICsraiQpIHtcbiAgICAgICAgICBsZXZlbCA9IGokO1xuICAgICAgICAgIGZuMSQoYXJtb3IsIG1hdGVyaWFscywgbGV2ZWwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGRlZi5yZXNvbHZlKGZ1bGxBcm1vckxpc3QpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVmLnByb21pc2U7XG4gICAgICBmdW5jdGlvbiBmbiQoaXQpe1xuICAgICAgICByZXR1cm4gaW1wb3J0JCh7fSwgaXQpO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gZm4xJChhcm1vciwgbWF0ZXJpYWxzLCBsZXZlbCl7XG4gICAgICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICByZXR1cm4gaXRlbVVwZ3JhZGVTdmMuYXJlKG1hdGVyaWFscykuZW5vdWdoVG9VcGdyYWRlKGFybW9yLCBsZXZlbCk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oY2FuVXBncmFkZSl7XG4gICAgICAgICAgaWYgKGNhblVwZ3JhZGUpIHtcbiAgICAgICAgICAgIHJldHVybiAkcS5hbGwoW2l0ZW1TdmMuZ2V0VXBncmFkZWQoYXJtb3IsIGxldmVsKSwgaXRlbVVwZ3JhZGVTdmMuZGVkdWN0RnJvbShtYXRlcmlhbHMpLmNvc3RPZlVwZ3JhZGUoYXJtb3IsIGxldmVsKV0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXRlcmlhbHMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgIHZhciB1cEFybW9yO1xuICAgICAgICAgIHVwQXJtb3IgPSByZXN1bHQgIT0gbnVsbCA/IHJlc3VsdFswXSA6IHZvaWQgODtcbiAgICAgICAgICBpZiAodXBBcm1vciAhPSBudWxsKSB7XG4gICAgICAgICAgICBmdWxsQXJtb3JMaXN0LnB1c2godXBBcm1vcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgICRzY29wZS5jYWxjdWxhdGUgPSBmdW5jdGlvbih0eXBlKXtcbiAgICAgIHZhciByZXN1bHRzO1xuICAgICAgdHlwZSA9PSBudWxsICYmICh0eXBlID0gJ29mZmVuY2UnKTtcbiAgICAgICRzY29wZS5mcmVlV2VpZ2h0ID0gJHNjb3BlLm1heExvYWQgLSAkc2NvcGUucmVzZXJ2ZWRXZWlnaHQ7XG4gICAgICByZXN1bHRzID0gW107XG4gICAgICBpbnZlbnRvcnlTdmMubG9hZCgpLnRoZW4oZnVuY3Rpb24oaW52ZW50b3J5KXtcbiAgICAgICAgcmV0dXJuICRxLmFsbChtYXAoZnVuY3Rpb24oaW52KXtcbiAgICAgICAgICByZXR1cm4gaXRlbVN2Yy5maW5kQW55SXRlbShmdW5jdGlvbihpdCl7XG4gICAgICAgICAgICByZXR1cm4gaXQudWlkID09PSBpbnYudWlkO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KShcbiAgICAgICAgZmlsdGVyKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQuaXRlbVR5cGUgPT09ICdhcm1vcic7XG4gICAgICAgIH0pKFxuICAgICAgICBpbnZlbnRvcnkpKSk7XG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKGFybW9ycyl7XG4gICAgICAgIHZhciBhdmFpbGFibGVBcm1vcnMsIHN0YXRpY0FybW9ycywgZHluYW1pY0FybW9ycywgaSQsIHJlZiQsIGxlbiQsIGtleSwgcGFydCwgaGVhZCwgaiQsIHJlZjEkLCBsZW4xJCwgY2hlc3QsIGskLCByZWYyJCwgbGVuMiQsIGhhbmRzLCBsJCwgcmVmMyQsIGxlbjMkLCBsZWdzLCBzZXQsIHdTdW0sIGJlc3RSZXN1bHRzLCBiZXN0QXJtb3JzLCByZXN1bHQsIGl0ZW0sIGZpdEFybW9ycztcbiAgICAgICAgYXZhaWxhYmxlQXJtb3JzID0gcmVqZWN0KGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQud2VpZ2h0ID4gJHNjb3BlLmZyZWVXZWlnaHQ7XG4gICAgICAgIH0pKFxuICAgICAgICBhcm1vcnMpO1xuICAgICAgICBzdGF0aWNBcm1vcnMgPSBmaWx0ZXIoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgIHJldHVybiBpdC51cGdyYWRlSWQgPCAwO1xuICAgICAgICB9KShcbiAgICAgICAgYXZhaWxhYmxlQXJtb3JzKTtcbiAgICAgICAgZHluYW1pY0FybW9ycyA9IHJlamVjdChmdW5jdGlvbihpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LnVwZ3JhZGVJZCA8IDA7XG4gICAgICAgIH0pKFxuICAgICAgICBhdmFpbGFibGVBcm1vcnMpO1xuICAgICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0gJHNjb3BlLnBhcnROYW1lcykubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgICAgICBrZXkgPSBpJDtcbiAgICAgICAgICBwYXJ0ID0gcmVmJFtpJF07XG4gICAgICAgICAgZHluYW1pY0FybW9ycy5wdXNoKGl0ZW1TdmMuY3JlYXRlSXRlbU1vZGVsKHtcbiAgICAgICAgICAgIG5hbWU6IFwiKG5vdGhpbmcpXCIsXG4gICAgICAgICAgICBpZDogLShrZXkgKyAxKSxcbiAgICAgICAgICAgIGFybW9yVHlwZTogcGFydCxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiAnYXJtb3InXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSBmaWx0ZXIoZm4kKShcbiAgICAgICAgZHluYW1pY0FybW9ycykpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgICAgaGVhZCA9IHJlZiRbaSRdO1xuICAgICAgICAgIGZvciAoaiQgPSAwLCBsZW4xJCA9IChyZWYxJCA9IGZpbHRlcihmbjEkKShcbiAgICAgICAgICBkeW5hbWljQXJtb3JzKSkubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICAgICAgICBjaGVzdCA9IHJlZjEkW2okXTtcbiAgICAgICAgICAgIGZvciAoayQgPSAwLCBsZW4yJCA9IChyZWYyJCA9IGZpbHRlcihmbjIkKShcbiAgICAgICAgICAgIGR5bmFtaWNBcm1vcnMpKS5sZW5ndGg7IGskIDwgbGVuMiQ7ICsrayQpIHtcbiAgICAgICAgICAgICAgaGFuZHMgPSByZWYyJFtrJF07XG4gICAgICAgICAgICAgIGZvciAobCQgPSAwLCBsZW4zJCA9IChyZWYzJCA9IGZpbHRlcihmbjMkKShcbiAgICAgICAgICAgICAgZHluYW1pY0FybW9ycykpLmxlbmd0aDsgbCQgPCBsZW4zJDsgKytsJCkge1xuICAgICAgICAgICAgICAgIGxlZ3MgPSByZWYzJFtsJF07XG4gICAgICAgICAgICAgICAgc2V0ID0gW2hlYWQsIGNoZXN0LCBoYW5kcywgbGVnc107XG4gICAgICAgICAgICAgICAgd1N1bSA9IHN1bShcbiAgICAgICAgICAgICAgICBtYXAoZm40JCkoXG4gICAgICAgICAgICAgICAgc2V0KSk7XG4gICAgICAgICAgICAgICAgaWYgKHdTdW0gPD0gJHNjb3BlLmZyZWVXZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChfY2FsY1Njb3Jlc0ZvcihzZXQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYmVzdFJlc3VsdHMgPSB0YWtlKDUpKFxuICAgICAgICByZXZlcnNlKFxuICAgICAgICBzb3J0QnkoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgIHJldHVybiBpdC5zY29yZTtcbiAgICAgICAgfSkoXG4gICAgICAgIHJlc3VsdHMpKSk7XG4gICAgICAgIGJlc3RBcm1vcnMgPSB7fTtcbiAgICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSBiZXN0UmVzdWx0cy5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgICAgIHJlc3VsdCA9IGJlc3RSZXN1bHRzW2kkXTtcbiAgICAgICAgICBmb3IgKGokID0gMCwgbGVuMSQgPSAocmVmJCA9ICRzY29wZS5wYXJ0TmFtZXMpLmxlbmd0aDsgaiQgPCBsZW4xJDsgKytqJCkge1xuICAgICAgICAgICAgcGFydCA9IHJlZiRbaiRdO1xuICAgICAgICAgICAgaXRlbSA9IHJlc3VsdFtwYXJ0XS5pdGVtO1xuICAgICAgICAgICAgYmVzdEFybW9yc1tpdGVtLmlkXSA9IGl0ZW07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZpdEFybW9ycyA9IHN0YXRpY0FybW9ycy5jb25jYXQodmFsdWVzKFxuICAgICAgICBiZXN0QXJtb3JzKSk7XG4gICAgICAgIHJldHVybiBpbnZlbnRvcnlTdmMubG9hZCgpLnRoZW4oZnVuY3Rpb24oaW52ZW50b3J5KXtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgZml0QXJtb3JzLCByZWplY3QoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgICAgICByZXR1cm4gaXQuaXRlbVR5cGUgIT09ICdpdGVtJztcbiAgICAgICAgICAgIH0pKFxuICAgICAgICAgICAgaW52ZW50b3J5KVxuICAgICAgICAgIF07XG4gICAgICAgIH0pO1xuICAgICAgICBmdW5jdGlvbiBmbiQoaXQpe1xuICAgICAgICAgIHJldHVybiBpdC5hcm1vclR5cGUgPT09ICdoZWFkJztcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBmbjEkKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQuYXJtb3JUeXBlID09PSAnY2hlc3QnO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGZuMiQoaXQpe1xuICAgICAgICAgIHJldHVybiBpdC5hcm1vclR5cGUgPT09ICdoYW5kcyc7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZm4zJChpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LmFybW9yVHlwZSA9PT0gJ2xlZ3MnO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGZuNCQoaXQpe1xuICAgICAgICAgIHJldHVybiBpdC53ZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIHZhciBmaXRBcm1vcnMsIGludmVudG9yeTtcbiAgICAgICAgZml0QXJtb3JzID0gZGF0YVswXTtcbiAgICAgICAgaW52ZW50b3J5ID0gZGF0YVsxXTtcbiAgICAgICAgcmV0dXJuIF9hZGRBdmFpbGFibGVVcGdyYWRlc1RvKE9iai52YWx1ZXMoXG4gICAgICAgIGZpdEFybW9ycyksIGludmVudG9yeSk7XG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKGF2YWlsYWJsZUFybW9ycyl7XG4gICAgICAgIHZhciByZXN1bHRzLCBpJCwgcmVmJCwgbGVuJCwgaGVhZCwgaiQsIHJlZjEkLCBsZW4xJCwgY2hlc3QsIGskLCByZWYyJCwgbGVuMiQsIGhhbmRzLCBsJCwgcmVmMyQsIGxlbjMkLCBsZWdzLCBzZXQsIHdTdW07XG4gICAgICAgIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IGZpbHRlcihmbiQpKFxuICAgICAgICBhdmFpbGFibGVBcm1vcnMpKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgICAgIGhlYWQgPSByZWYkW2kkXTtcbiAgICAgICAgICBmb3IgKGokID0gMCwgbGVuMSQgPSAocmVmMSQgPSBmaWx0ZXIoZm4xJCkoXG4gICAgICAgICAgYXZhaWxhYmxlQXJtb3JzKSkubGVuZ3RoOyBqJCA8IGxlbjEkOyArK2okKSB7XG4gICAgICAgICAgICBjaGVzdCA9IHJlZjEkW2okXTtcbiAgICAgICAgICAgIGZvciAoayQgPSAwLCBsZW4yJCA9IChyZWYyJCA9IGZpbHRlcihmbjIkKShcbiAgICAgICAgICAgIGF2YWlsYWJsZUFybW9ycykpLmxlbmd0aDsgayQgPCBsZW4yJDsgKytrJCkge1xuICAgICAgICAgICAgICBoYW5kcyA9IHJlZjIkW2skXTtcbiAgICAgICAgICAgICAgZm9yIChsJCA9IDAsIGxlbjMkID0gKHJlZjMkID0gZmlsdGVyKGZuMyQpKFxuICAgICAgICAgICAgICBhdmFpbGFibGVBcm1vcnMpKS5sZW5ndGg7IGwkIDwgbGVuMyQ7ICsrbCQpIHtcbiAgICAgICAgICAgICAgICBsZWdzID0gcmVmMyRbbCRdO1xuICAgICAgICAgICAgICAgIHNldCA9IFtoZWFkLCBjaGVzdCwgaGFuZHMsIGxlZ3NdO1xuICAgICAgICAgICAgICAgIHdTdW0gPSBzdW0oXG4gICAgICAgICAgICAgICAgT2JqLnZhbHVlcyhcbiAgICAgICAgICAgICAgICBPYmoubWFwKGZuNCQpKFxuICAgICAgICAgICAgICAgIHNldCkpKTtcbiAgICAgICAgICAgICAgICBpZiAod1N1bSA8PSAkc2NvcGUuZnJlZVdlaWdodCkge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKF9jYWxjU2NvcmVzRm9yKHNldCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUucmVzdWx0cyA9IHJlc3VsdHM7XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gJHNjb3BlLnJlc3VsdHM7XG4gICAgICAgIGZ1bmN0aW9uIGZuJChpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LmFybW9yVHlwZSA9PT0gJ2hlYWQnO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGZuMSQoaXQpe1xuICAgICAgICAgIHJldHVybiBpdC5hcm1vclR5cGUgPT09ICdjaGVzdCc7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZm4yJChpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LmFybW9yVHlwZSA9PT0gJ2hhbmRzJztcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBmbjMkKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQuYXJtb3JUeXBlID09PSAnbGVncyc7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZm40JChpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LndlaWdodDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG4gIGZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICAgIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICAgIHJldHVybiBvYmo7XG4gIH1cbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlICE9PSBudWxsKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih1aUdyaWRDb25zdGFudHMpe1xuICAgICAgdmFyIHBlcmNlbnRGaWVsZE1pbldpZHRoO1xuICAgICAgcGVyY2VudEZpZWxkTWluV2lkdGggPSA0NTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbHVtbkRlZnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogJ3Njb3JlJyxcbiAgICAgICAgICAgIHdpZHRoOiA3NSxcbiAgICAgICAgICAgIGNlbGxGaWx0ZXI6ICdudW1iZXI6MicsXG4gICAgICAgICAgICBzb3J0OiB7XG4gICAgICAgICAgICAgIGRpcmVjdGlvbjogdWlHcmlkQ29uc3RhbnRzLkRFU0MsXG4gICAgICAgICAgICAgIHByaW9yaXR5OiAwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlaWdodCcsXG4gICAgICAgICAgICB3aWR0aDogNTAsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAnbnVtYmVyOjInLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICBzb3J0OiB7XG4gICAgICAgICAgICAgIGRpcmVjdGlvbjogdWlHcmlkQ29uc3RhbnRzLkFTQyxcbiAgICAgICAgICAgICAgcHJpb3JpdHk6IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ2hlYWQubmFtZSdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ2hlYWQuc2NvcmUnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICB3aWR0aDogNTAsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAnbnVtYmVyOjInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdjaGVzdC5uYW1lJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnY2hlc3Quc2NvcmUnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICB3aWR0aDogNTAsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAnbnVtYmVyOjInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdoYW5kcy5uYW1lJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnaGFuZHMuc2NvcmUnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICB3aWR0aDogNTAsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAnbnVtYmVyOjInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdsZWdzLm5hbWUnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdsZWdzLnNjb3JlJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgd2lkdGg6IDUwLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ251bWJlcjoyJ1xuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfTtcbiAgICB9O1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpO1xuICByZXF1aXJlKCcuL2NvbnRyb2xsZXInKTtcbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuY29udHJvbGxlcihcIkd1aWRlQ29udHJvbGxlclwiLCBmdW5jdGlvbigkc2NlLCAkc2NvcGUsICRyb3V0ZVBhcmFtcywgJHJlc291cmNlLCBndWlkZVNlcnZpY2UsIHN0b3JhZ2VTdmMpe1xuICAgIHZhciBfZ2V0QXJyb3dGb3IsIF9wcmVwYXJlR3VpZGVDb250ZW50LCBfc2F2ZVVzZXJEYXRhLCBfbG9hZFVzZXJEYXRhLCBkYXRhO1xuICAgICRzY29wZS5zZWN0aW9ucyA9IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdpbnRybycsXG4gICAgICAgIG5hbWU6IFwiSW50cm9cIlxuICAgICAgfSwge1xuICAgICAgICBpZDogJ2FzeWx1bScsXG4gICAgICAgIG5hbWU6IFwiTm9ydGhlcm4gVW5kZWFkIEFzeWx1bVwiXG4gICAgICB9LCB7XG4gICAgICAgIGlkOiAnZmlyZWxpbmsnLFxuICAgICAgICBuYW1lOiBcIkZpcmVsaW5rIFNocmluZVwiXG4gICAgICB9LCB7XG4gICAgICAgIGlkOiAnYnVyZycsXG4gICAgICAgIG5hbWU6IFwiVW5kZWFkIEJ1cmdcIlxuICAgICAgfSwge1xuICAgICAgICBpZDogJ3BhcmlzaCcsXG4gICAgICAgIG5hbWU6IFwiVW5kZWFkIFBhcmlzaFwiXG4gICAgICB9LCB7XG4gICAgICAgIGlkOiAnbG93JyxcbiAgICAgICAgbmFtZTogXCJMb3dlciBVbmRlYWQgQnVyZ1wiXG4gICAgICB9LCB7XG4gICAgICAgIGlkOiAnZGVwdGhzJyxcbiAgICAgICAgbmFtZTogXCJUaGUgRGVwdGhzXCJcbiAgICAgIH0sIHtcbiAgICAgICAgaWQ6ICdibGlnaHQnLFxuICAgICAgICBuYW1lOiBcIkJsaWdodHRvd25cIlxuICAgICAgfVxuICAgIF07XG4gICAgJHNjb3BlLnNlY3Rpb24gPSAkcm91dGVQYXJhbXNbJ3NlY3Rpb24nXTtcbiAgICAkc2NvcGUudXNlckRhdGEgPSBudWxsO1xuICAgICRzY29wZS5lbnRyeUluZGV4ID0ge307XG4gICAgX2dldEFycm93Rm9yID0gZnVuY3Rpb24oZW50cnkpe1xuICAgICAgaWYgKCEoZW50cnkubWV0YSB8fCAoZW50cnkubWV0YSA9IHt9KSkuaXNFeHBhbmRhYmxlKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICAgIHJldHVybiAoZW50cnkubWV0YSB8fCAoZW50cnkubWV0YSA9IHt9KSkuaXNDb2xsYXBzZWQgPyAnWy4uXScgOiAnJztcbiAgICB9O1xuICAgIF9wcmVwYXJlR3VpZGVDb250ZW50ID0gZnVuY3Rpb24oZW50cnkpe1xuICAgICAgdmFyIHVzZXJNZXRhLCByZWYkLCByZWYxJCwgeCQsIGkkLCBsZW4kLCBjaGVjaywgY2hpbGQ7XG4gICAgICBpZiAoZW50cnkuaWQgIT0gbnVsbCkge1xuICAgICAgICAkc2NvcGUuZW50cnlJbmRleFtlbnRyeS5pZF0gPSBlbnRyeTtcbiAgICAgIH1cbiAgICAgIGlmIChlbnRyeS5jb250ZW50ICE9IG51bGwpIHtcbiAgICAgICAgZW50cnkuY29udGVudCA9ICRzY2UudHJ1c3RBc0h0bWwoZW50cnkuY29udGVudCk7XG4gICAgICB9XG4gICAgICB1c2VyTWV0YSA9IChyZWYkID0gKChyZWYxJCA9ICRzY29wZS51c2VyRGF0YSB8fCAoJHNjb3BlLnVzZXJEYXRhID0ge30pKS5lbnRyeU1ldGEgfHwgKHJlZjEkLmVudHJ5TWV0YSA9IHt9KSlbZW50cnkuaWRdKSAhPSBudWxsXG4gICAgICAgID8gcmVmJFxuICAgICAgICA6IHt9O1xuICAgICAgeCQgPSBlbnRyeS5tZXRhIHx8IChlbnRyeS5tZXRhID0ge30pO1xuICAgICAgeCQuaXNDb2xsYXBzZWQgPSAocmVmJCA9IHVzZXJNZXRhLmlzQ29sbGFwc2VkKSAhPSBudWxsXG4gICAgICAgID8gcmVmJFxuICAgICAgICA6IGVudHJ5LmNvbnRlbnQgIT0gbnVsbDtcbiAgICAgIHgkLmlzRG9uZSA9IChyZWYkID0gdXNlck1ldGEuaXNEb25lKSAhPSBudWxsID8gcmVmJCA6IGZhbHNlO1xuICAgICAgeCQuaXNFeHBhbmRhYmxlID0gZW50cnkuY2hpbGRyZW4gIT0gbnVsbCB8fCBlbnRyeS5jb250ZW50ICE9IG51bGw7XG4gICAgICB4JC5hcnJvdyA9IF9nZXRBcnJvd0ZvcihlbnRyeSk7XG4gICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0gWydjb250ZW50JywgJ2NoaWxkcmVuJ10pLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGNoZWNrID0gcmVmJFtpJF07XG4gICAgICAgICgocmVmMSQgPSBlbnRyeS5tZXRhIHx8IChlbnRyeS5tZXRhID0ge30pKS5hZGRpdGlvbmFsQ2xhc3NlcyB8fCAocmVmMSQuYWRkaXRpb25hbENsYXNzZXMgPSBbXSkpLnB1c2goZW50cnlbY2hlY2tdICE9IG51bGxcbiAgICAgICAgICA/IFwid2l0aC1cIiArIGNoZWNrXG4gICAgICAgICAgOiBcIndpdGhvdXQtXCIgKyBjaGVjayk7XG4gICAgICB9XG4gICAgICBpZiAoZW50cnkuY2hpbGRyZW4gIT0gbnVsbCkge1xuICAgICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0gZW50cnkuY2hpbGRyZW4pLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgICAgY2hpbGQgPSByZWYkW2kkXTtcbiAgICAgICAgICBfcHJlcGFyZUd1aWRlQ29udGVudChjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIF9zYXZlVXNlckRhdGEgPSBmdW5jdGlvbigpe1xuICAgICAgdmFyIGlkLCByZWYkLCBlbnRyeSwgaSQsIHJlZjEkLCBsZW4kLCBmaWVsZCwgcmVmMiQsIHJlZjMkO1xuICAgICAgZm9yIChpZCBpbiByZWYkID0gJHNjb3BlLmVudHJ5SW5kZXgpIHtcbiAgICAgICAgZW50cnkgPSByZWYkW2lkXTtcbiAgICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmMSQgPSBbJ2lzQ29sbGFwc2VkJywgJ2lzRG9uZSddKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgICAgIGZpZWxkID0gcmVmMSRbaSRdO1xuICAgICAgICAgICgocmVmMiQgPSAocmVmMyQgPSAkc2NvcGUudXNlckRhdGEgfHwgKCRzY29wZS51c2VyRGF0YSA9IHt9KSkuZW50cnlNZXRhIHx8IChyZWYzJC5lbnRyeU1ldGEgPSB7fSkpW2lkXSB8fCAocmVmMiRbaWRdID0ge30pKVtmaWVsZF0gPSBlbnRyeS5tZXRhW2ZpZWxkXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc3RvcmFnZVN2Yy5zYXZlKCdndWlkZTp1c2VyRGF0YScsICRzY29wZS51c2VyRGF0YSk7XG4gICAgfTtcbiAgICBfbG9hZFVzZXJEYXRhID0gZnVuY3Rpb24oKXtcbiAgICAgIHZhciByZWYkO1xuICAgICAgJHNjb3BlLnVzZXJEYXRhID0gKHJlZiQgPSBzdG9yYWdlU3ZjLmxvYWQoJ2d1aWRlOnVzZXJEYXRhJykpICE9IG51bGxcbiAgICAgICAgPyByZWYkXG4gICAgICAgIDoge307XG4gICAgfTtcbiAgICBfbG9hZFVzZXJEYXRhKCk7XG4gICAgZGF0YSA9IGd1aWRlU2VydmljZS5nZXRDb250ZW50Rm9yKCRzY29wZS5zZWN0aW9uKTtcbiAgICAkc2NvcGUuZW50cnkgPSB7XG4gICAgICBjaGlsZHJlbjogZGF0YVxuICAgIH07XG4gICAgZGF0YS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICBfcHJlcGFyZUd1aWRlQ29udGVudCgkc2NvcGUuZW50cnkpO1xuICAgIH0pO1xuICAgICRzY29wZS5jYW5BZGRUb0ludmVudG9yeSA9IGZ1bmN0aW9uKGVudHJ5KXtcbiAgICAgIHZhciBjYW47XG4gICAgICBjYW4gPSBhbnkoKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgcmV0dXJuIGl0ID09PSAnaXRlbSc7XG4gICAgICB9KSkoXG4gICAgICBlbnRyeS5sYWJlbHMgfHwgKGVudHJ5LmxhYmVscyA9IFtdKSk7XG4gICAgICBjYW4gPSBjYW4gJiYgIWFueSgoZnVuY3Rpb24oaXQpe1xuICAgICAgICByZXR1cm4gaXQgPT09ICdhYnN0cmFjdCc7XG4gICAgICB9KSkoXG4gICAgICBlbnRyeS5mbGFncyB8fCAoZW50cnkuZmxhZ3MgPSBbXSkpO1xuICAgICAgcmV0dXJuIGNhbjtcbiAgICB9O1xuICAgICRzY29wZS5lbnRyeUNsaWNrZWQgPSBmdW5jdGlvbigkZXZlbnQsIGVudHJ5KXtcbiAgICAgIHZhciB4JDtcbiAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGlmICghKGVudHJ5Lm1ldGEgfHwgKGVudHJ5Lm1ldGEgPSB7fSkpLmlzRXhwYW5kYWJsZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB4JCA9IGVudHJ5Lm1ldGEgfHwgKGVudHJ5Lm1ldGEgPSB7fSk7XG4gICAgICB4JC5pc0NvbGxhcHNlZCA9ICEoZW50cnkubWV0YSB8fCAoZW50cnkubWV0YSA9IHt9KSkuaXNDb2xsYXBzZWQ7XG4gICAgICB4JC5hcnJvdyA9IF9nZXRBcnJvd0ZvcihlbnRyeSk7XG4gICAgICBfc2F2ZVVzZXJEYXRhKCk7XG4gICAgfTtcbiAgICAkc2NvcGUuZW50cnlEb25lID0gZnVuY3Rpb24oZW50cnkpe1xuICAgICAgZW50cnkubWV0YS5pc0RvbmUgPSB0cnVlO1xuICAgICAgX3NhdmVVc2VyRGF0YSgpO1xuICAgIH07XG4gIH0pO1xufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICBhbmd1bGFyLm1vZHVsZShcImRzY1wiKS5zZXJ2aWNlKFwiZ3VpZGVTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRyZXNvdXJjZSl7XG4gICAgdmFyIHN2YztcbiAgICBzdmMgPSB7fTtcbiAgICBzdmMuZ2V0Q29udGVudEZvciA9IGZ1bmN0aW9uKHNlY3Rpb24pe1xuICAgICAgcmV0dXJuICRyZXNvdXJjZShcIi9tb2R1bGVzL2d1aWRlL2NvbnRlbnQvXCIgKyBzZWN0aW9uICsgXCIuanNvblwiKS5xdWVyeSgpO1xuICAgIH07XG4gICAgcmV0dXJuIHN2YztcbiAgfSk7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIHJlcXVpcmUoJy4vZ3VpZGUtY29udHJvbGxlcicpO1xuICByZXF1aXJlKCcuL2d1aWRlLXNlcnZpY2UnKTtcbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlICE9PSBudWxsKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih1aUdyaWRDb25zdGFudHMpe1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZW5hYmxlRmlsdGVyaW5nOiB0cnVlLFxuICAgICAgICBjb2x1bW5EZWZzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6ICduYW1lJyxcbiAgICAgICAgICAgIHNvcnQ6IHtcbiAgICAgICAgICAgICAgZGlyZWN0aW9uOiB1aUdyaWRDb25zdGFudHMuQVNDXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdpdGVtVHlwZScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1R5cGUnLFxuICAgICAgICAgICAgZmlsdGVyOiB7XG4gICAgICAgICAgICAgIHR5cGU6IHVpR3JpZENvbnN0YW50cy5maWx0ZXIuU0VMRUNULFxuICAgICAgICAgICAgICBzZWxlY3RPcHRpb25zOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgdmFsdWU6ICd3ZWFwb24nLFxuICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiV2VhcG9uc1wiXG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgdmFsdWU6ICdhcm1vcicsXG4gICAgICAgICAgICAgICAgICBsYWJlbDogXCJBcm1vclwiXG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgdmFsdWU6ICdpdGVtJyxcbiAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkl0ZW1zXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ2Ftb3VudCcsXG4gICAgICAgICAgICB3aWR0aDogNTBcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIG9uUmVnaXN0ZXJBcGk6IGZ1bmN0aW9uKGdyaWRBcGkpe1xuICAgICAgICAgIGdyaWRBcGkuY29yZS5hZGRSb3dIZWFkZXJDb2x1bW4oe1xuICAgICAgICAgICAgbmFtZTogJ3Jvd0hlYWRlckNvbCcsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJycsXG4gICAgICAgICAgICB3aWR0aDogMTAwLFxuICAgICAgICAgICAgY2VsbFRlbXBsYXRlOiAnR3JpZFJvd0hlYWRlci5odG1sJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH07XG4gIH1cbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuY29udHJvbGxlcihcIkludmVudG9yeUNvbnRyb2xsZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCB1aUdyaWRDb25zdGFudHMsIGl0ZW1TdmMsIGl0ZW1JbmRleFN2YywgaXRlbVVwZ3JhZGVTdmMsIHN0b3JhZ2VTdmMsIGludmVudG9yeVN2YywgZGF0YUV4cG9ydFN2Yyl7XG4gICAgJHNjb3BlLnNlbGVjdGVkSXRlbSA9IG51bGw7XG4gICAgJHNjb3BlLmFybW9yU2V0cyA9IFtdO1xuICAgICRzY29wZS5hbGxJdGVtcyA9IFtdO1xuICAgICRzY29wZS5pdGVtVHlwZXMgPSBbJ3dlYXBvbicsICdhcm1vcicsICdpdGVtJ107XG4gICAgJHNjb3BlLmdyaWRPcHRpb25zID0gcmVxdWlyZSgnLi9jb25maWcvaW52ZW50b3J5LWdyaWQtb3B0cycpKHVpR3JpZENvbnN0YW50cyk7XG4gICAgJHNjb3BlLmFsbEl0ZW1zID0gaXRlbUluZGV4U3ZjLmxvYWRBbGxFbnRyaWVzKGZhbHNlKTtcbiAgICAkc2NvcGUuYXJtb3JTZXRzID0gaXRlbUluZGV4U3ZjLmxvYWRBbGxBcm1vclNldEVudHJpZXMoZmFsc2UpO1xuICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gaW52ZW50b3J5U3ZjLmxvYWQoZmFsc2UpO1xuICAgICRzY29wZVsnZXhwb3J0J10gPSBmdW5jdGlvbigpe307XG4gICAgJHNjb3BlLmNhblVwZ3JhZGUgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgIHJldHVybiBpdGVtVXBncmFkZVN2Yy5jYW5CZVVwZ3JhZGVkKFxuICAgICAgaXRlbSk7XG4gICAgfTtcbiAgICAkc2NvcGUudXBncmFkZSA9IGZ1bmN0aW9uKGludkVudHJ5KXtcbiAgICAgIHJldHVybiBpdGVtU3ZjLmZpbmRBbnlJdGVtKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgcmV0dXJuIGl0LnVpZCA9PT0gaW52RW50cnkudWlkO1xuICAgICAgfSkudGhlbihmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgcmV0dXJuIGl0ZW1TdmMuZ2V0VXBncmFkZWQoaXRlbSk7XG4gICAgICB9KS50aGVuKGZ1bmN0aW9uKHVwSXRlbSl7XG4gICAgICAgIGlmICh1cEl0ZW0gPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUucmVtb3ZlKGludkVudHJ5KTtcbiAgICAgICAgJHNjb3BlLmFkZCh1cEl0ZW0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAkc2NvcGUuYWRkTmV3SXRlbSA9IGZ1bmN0aW9uKHNlbGVjdGlvbil7XG4gICAgICAkc2NvcGUuYWRkKHNlbGVjdGlvbi5vcmlnaW5hbE9iamVjdCk7XG4gICAgfTtcbiAgICAkc2NvcGUuYWRkID0gaW52ZW50b3J5U3ZjLmFkZDtcbiAgICAkc2NvcGUucmVtb3ZlID0gaW52ZW50b3J5U3ZjLnJlbW92ZTtcbiAgICAkc2NvcGUuYWRkQXJtb3JTZXQgPSBmdW5jdGlvbihzZWxlY3Rpb24pe1xuICAgICAgdmFyIGFybW9yU2V0O1xuICAgICAgYXJtb3JTZXQgPSBzZWxlY3Rpb24ub3JpZ2luYWxPYmplY3Q7XG4gICAgICBpdGVtSW5kZXhTdmMuZmluZEJ5QXJtb3JTZXQoYXJtb3JTZXQpLnRoZW4oZnVuY3Rpb24oYXJtb3JzKXtcbiAgICAgICAgZWFjaCgkc2NvcGUuYWRkKShcbiAgICAgICAgYXJtb3JzKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICB2YXIgSW52ZW50b3J5U3ZjO1xuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT0gJ3VuZGVmaW5lZCcgJiYgYW5ndWxhciAhPT0gbnVsbCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLnNlcnZpY2UoXCJpbnZlbnRvcnlTdmNcIiwgZnVuY3Rpb24oc3RvcmFnZVN2YywgaXRlbUluZGV4U3ZjLCAkcSl7XG4gICAgICByZXR1cm4gbmV3IEludmVudG9yeVN2YyhzdG9yYWdlU3ZjLCBpdGVtSW5kZXhTdmMsICRxKTtcbiAgICB9KTtcbiAgfVxuICBJbnZlbnRvcnlTdmMgPSAoZnVuY3Rpb24oKXtcbiAgICBJbnZlbnRvcnlTdmMuZGlzcGxheU5hbWUgPSAnSW52ZW50b3J5U3ZjJztcbiAgICB2YXIgcHJvdG90eXBlID0gSW52ZW50b3J5U3ZjLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBJbnZlbnRvcnlTdmM7XG4gICAgZnVuY3Rpb24gSW52ZW50b3J5U3ZjKHN0b3JhZ2VTdmMsIGl0ZW1JbmRleFN2YywgJHEpe1xuICAgICAgdGhpcy5zdG9yYWdlU3ZjID0gc3RvcmFnZVN2YztcbiAgICAgIHRoaXMuaXRlbUluZGV4U3ZjID0gaXRlbUluZGV4U3ZjO1xuICAgICAgdGhpcy4kcSA9ICRxO1xuICAgICAgdGhpcy5jbGVhciA9IGJpbmQkKHRoaXMsICdjbGVhcicsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLnJlbW92ZSA9IGJpbmQkKHRoaXMsICdyZW1vdmUnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5hZGQgPSBiaW5kJCh0aGlzLCAnYWRkJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuY3JlYXRlSW52ZW50b3J5SXRlbUZyb20gPSBiaW5kJCh0aGlzLCAnY3JlYXRlSW52ZW50b3J5SXRlbUZyb20nLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5maW5kID0gYmluZCQodGhpcywgJ2ZpbmQnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5maW5kSXRlbUJ5VWlkID0gYmluZCQodGhpcywgJ2ZpbmRJdGVtQnlVaWQnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5sb2FkID0gYmluZCQodGhpcywgJ2xvYWQnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5zYXZlID0gYmluZCQodGhpcywgJ3NhdmUnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5faW52ZW50b3J5ID0gW107XG4gICAgICB0aGlzLl9tb2RlbHMgPSByZXF1aXJlKCcuL21vZGVscy9pbnZlbnRvcnktbW9kZWxzJyk7XG4gICAgfVxuICAgIHByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBkYXRhLCBpJCwgcmVmJCwgbGVuJCwgaXRlbTtcbiAgICAgIGRhdGEgPSBbXTtcbiAgICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSB0aGlzLl9pbnZlbnRvcnkpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGl0ZW0gPSByZWYkW2kkXTtcbiAgICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgICAndWlkJzogaXRlbS51aWQsXG4gICAgICAgICAgJ2Ftb3VudCc6IGl0ZW0uYW1vdW50XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy5zdG9yYWdlU3ZjLnNhdmUoJ2ludmVudG9yeScsIGRhdGEpO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbihyZXR1cm5Qcm9taXNlKXtcbiAgICAgIHZhciBwcm9taXNlcywgaSQsIHJlZiQsIGxlbiQsIGRhdGEsIHByb21pc2UsIHRoaXMkID0gdGhpcztcbiAgICAgIHJldHVyblByb21pc2UgPT0gbnVsbCAmJiAocmV0dXJuUHJvbWlzZSA9IHRydWUpO1xuICAgICAgaWYgKHRoaXMuX2ludmVudG9yeS4kcHJvbWlzZSA9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgcHJvbWlzZXMgPSBbXTtcbiAgICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHRoaXMuc3RvcmFnZVN2Yy5sb2FkKCdpbnZlbnRvcnknKSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgICAgICBkYXRhID0gcmVmJFtpJF07XG4gICAgICAgICAgcHJvbWlzZSA9IGZuJChkYXRhKTtcbiAgICAgICAgICBwcm9taXNlcy5wdXNoKHByb21pc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2ludmVudG9yeS4kcHJvbWlzZSA9IHRoaXMuJHEuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgcmV0dXJuIHRoaXMkLl9pbnZlbnRvcnk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJldHVyblByb21pc2VcbiAgICAgICAgPyB0aGlzLl9pbnZlbnRvcnkuJHByb21pc2VcbiAgICAgICAgOiB0aGlzLl9pbnZlbnRvcnk7XG4gICAgICBmdW5jdGlvbiBmbiQoZGF0YSl7XG4gICAgICAgIHZhciBpdGVtO1xuICAgICAgICBpdGVtID0gbmV3IHRoaXMkLl9tb2RlbHMuSW52ZW50b3J5SXRlbShkYXRhKTtcbiAgICAgICAgcmV0dXJuIHRoaXMkLml0ZW1JbmRleFN2Yy5maW5kRW50cnkoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgIHJldHVybiBpdC51aWQgPT09IGRhdGEudWlkO1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKGluZGV4RW50cnkpe1xuICAgICAgICAgIGl0ZW0udXNlRGF0YUZyb20oaW5kZXhFbnRyeSk7XG4gICAgICAgICAgdGhpcyQuX2ludmVudG9yeS5wdXNoKGl0ZW0pO1xuICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHByb3RvdHlwZS5maW5kSXRlbUJ5VWlkID0gZnVuY3Rpb24odWlkKXtcbiAgICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgICByZXR1cm4gdGhpcy5sb2FkKCkudGhlbihmdW5jdGlvbihpbnZlbnRvcnkpe1xuICAgICAgICByZXR1cm4gZmluZChmdW5jdGlvbihpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LnVpZCA9PT0gdWlkO1xuICAgICAgICB9KShcbiAgICAgICAgaW52ZW50b3J5KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgIGlmIChpdGVtLnVpZCA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGZpbmQgYW4gaXRlbSB3aXRob3V0IFVJRC5cIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5maW5kSXRlbUJ5VWlkKGl0ZW0udWlkKTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5jcmVhdGVJbnZlbnRvcnlJdGVtRnJvbSA9IGZ1bmN0aW9uKGl0ZW0sIGFtb3VudCl7XG4gICAgICB2YXIgeCQ7XG4gICAgICBhbW91bnQgPT0gbnVsbCAmJiAoYW1vdW50ID0gMSk7XG4gICAgICB4JCA9IG5ldyB0aGlzLl9tb2RlbHMuSW52ZW50b3J5SXRlbTtcbiAgICAgIHgkLnVzZURhdGFGcm9tKGl0ZW0pO1xuICAgICAgeCQuYW1vdW50ID0gYW1vdW50O1xuICAgICAgcmV0dXJuIHgkO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGl0ZW0sIGFtb3VudCl7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgYW1vdW50ID09IG51bGwgJiYgKGFtb3VudCA9IDEpO1xuICAgICAgcmV0dXJuIHRoaXMuZmluZChpdGVtKS50aGVuKGZ1bmN0aW9uKGludkl0ZW0pe1xuICAgICAgICB2YXIgeCQ7XG4gICAgICAgIGlmIChpbnZJdGVtICE9IG51bGwpIHtcbiAgICAgICAgICBpbnZJdGVtLmFtb3VudCArPSBhbW91bnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgeCQgPSBpbnZJdGVtID0gdGhpcyQuY3JlYXRlSW52ZW50b3J5SXRlbUZyb20oaXRlbSwgYW1vdW50KTtcbiAgICAgICAgICB0aGlzJC5faW52ZW50b3J5LnB1c2goXG4gICAgICAgICAgeCQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMkLnNhdmUoKTtcbiAgICAgICAgcmV0dXJuIGludkl0ZW07XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbihpdGVtLCBhbW91bnQpe1xuICAgICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICAgIGFtb3VudCA9PSBudWxsICYmIChhbW91bnQgPSAxKTtcbiAgICAgIHJldHVybiB0aGlzLmZpbmQoaXRlbSkudGhlbihmdW5jdGlvbihlbnRyeSl7XG4gICAgICAgIGlmIChlbnRyeSA9PSBudWxsKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHJlbW92ZSB0aGUgYWJvdmUgaXRlbSBiZWNhdXNlIGNvdWxkbid0IGZpbmQgaXQgaW4gdGhlIGludmVudG9yeS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZW50cnkuYW1vdW50ID0gYW1vdW50ID09PSB0cnVlXG4gICAgICAgICAgPyAwXG4gICAgICAgICAgOiBlbnRyeS5hbW91bnQgLT0gYW1vdW50O1xuICAgICAgICBpZiAoZW50cnkuYW1vdW50IDwgMSkge1xuICAgICAgICAgIHRoaXMkLl9pbnZlbnRvcnkuc3BsaWNlKHRoaXMkLl9pbnZlbnRvcnkuaW5kZXhPZihlbnRyeSksIDEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMkLnNhdmUoKTtcbiAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgICAgfSk7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpe1xuICAgICAgdGhpcy5faW52ZW50b3J5Lmxlbmd0aCA9IDA7XG4gICAgICBkZWxldGUgdGhpcy5faW52ZW50b3J5LiRwcm9taXNlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gSW52ZW50b3J5U3ZjO1xuICB9KCkpO1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPSAndW5kZWZpbmVkJyAmJiBtb2R1bGUgIT09IG51bGwpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IEludmVudG9yeVN2YztcbiAgfVxuICBmdW5jdGlvbiBiaW5kJChvYmosIGtleSwgdGFyZ2V0KXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXsgcmV0dXJuICh0YXJnZXQgfHwgb2JqKVtrZXldLmFwcGx5KG9iaiwgYXJndW1lbnRzKSB9O1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpO1xuICByZXF1aXJlKFwiLi9pbnZlbnRvcnktY29udHJvbGxlclwiKTtcbiAgcmVxdWlyZShcIi4vaW52ZW50b3J5LXNlcnZpY2VcIik7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIHZhciBJbnZlbnRvcnlJdGVtTW9kZWw7XG4gIEludmVudG9yeUl0ZW1Nb2RlbCA9IChmdW5jdGlvbigpe1xuICAgIEludmVudG9yeUl0ZW1Nb2RlbC5kaXNwbGF5TmFtZSA9ICdJbnZlbnRvcnlJdGVtTW9kZWwnO1xuICAgIHZhciBwcm90b3R5cGUgPSBJbnZlbnRvcnlJdGVtTW9kZWwucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEludmVudG9yeUl0ZW1Nb2RlbDtcbiAgICBmdW5jdGlvbiBJbnZlbnRvcnlJdGVtTW9kZWwoaXRlbSl7XG4gICAgICB0aGlzLnVzZURhdGFGcm9tID0gYmluZCQodGhpcywgJ3VzZURhdGFGcm9tJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuYW1vdW50ID0gMTtcbiAgICAgIHRoaXMubmFtZSA9ICcnO1xuICAgICAgdGhpcy5pdGVtVHlwZSA9ICcnO1xuICAgICAgdGhpcy5pZCA9ICcnO1xuICAgICAgdGhpcy51aWQgPSAnJztcbiAgICAgIHRoaXMudXNlRGF0YUZyb20oaXRlbSk7XG4gICAgfVxuICAgIHByb3RvdHlwZS51c2VEYXRhRnJvbSA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgdmFyIGkkLCByZWYkLCBsZW4kLCBmaWVsZDtcbiAgICAgIGlmIChpdGVtID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IFsnYW1vdW50JywgJ3VpZCcsICduYW1lJywgJ2l0ZW1UeXBlJywgJ2lkJ10pLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGZpZWxkID0gcmVmJFtpJF07XG4gICAgICAgIGlmIChpdGVtW2ZpZWxkXSAhPSBudWxsKSB7XG4gICAgICAgICAgdGhpc1tmaWVsZF0gPSBpdGVtW2ZpZWxkXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gSW52ZW50b3J5SXRlbU1vZGVsO1xuICB9KCkpO1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPSAndW5kZWZpbmVkJyAmJiBtb2R1bGUgIT09IG51bGwpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAgICdJbnZlbnRvcnlJdGVtJzogSW52ZW50b3J5SXRlbU1vZGVsXG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBiaW5kJChvYmosIGtleSwgdGFyZ2V0KXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXsgcmV0dXJuICh0YXJnZXQgfHwgb2JqKVtrZXldLmFwcGx5KG9iaiwgYXJndW1lbnRzKSB9O1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGlmICh0eXBlb2YgbW9kdWxlICE9ICd1bmRlZmluZWQnICYmIG1vZHVsZSAhPT0gbnVsbCkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oJHNjb3BlLCB1aUdyaWRDb25zdGFudHMpe1xuICAgICAgdmFyIHBlcmNlbnRGaWVsZE1pbldpZHRoLCBpJCwgcmVmJCwgbGVuJCwgaXRlbVR5cGU7XG4gICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMgPSB7fTtcbiAgICAgIHBlcmNlbnRGaWVsZE1pbldpZHRoID0gNDU7XG4gICAgICAkc2NvcGUuY29sdW1uQ29uZmlncyA9IHtcbiAgICAgICAgJ3dlYXBvbnMnOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb25DYXRlZ29yeScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1R5cGUnLFxuICAgICAgICAgICAgbWluV2lkdGg6IDcwLFxuICAgICAgICAgICAgc29ydDoge1xuICAgICAgICAgICAgICBkaXJlY3Rpb246IHVpR3JpZENvbnN0YW50cy5BU0MsXG4gICAgICAgICAgICAgIHByaW9yaXR5OiAwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICduYW1lJyxcbiAgICAgICAgICAgIG1pbldpZHRoOiAyMTAsXG4gICAgICAgICAgICBzb3J0OiB7XG4gICAgICAgICAgICAgIGRpcmVjdGlvbjogdWlHcmlkQ29uc3RhbnRzLkFTQyxcbiAgICAgICAgICAgICAgcHJpb3JpdHk6IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3JlcVMnLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdSUycsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAncmVxRCcsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JEJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAncmVxSScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JJJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAncmVxRicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JGJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnZG1nTicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FQJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnZG1nTScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FNJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnZG1nRicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FGJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnZG1nTCcsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FMJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnZG1nUycsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FTJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnc2NTJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU1MnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdzY0QnLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdTRCcsXG4gICAgICAgICAgICBtaW5XaWR0aDogcGVyY2VudEZpZWxkTWluV2lkdGgsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAncGVyY2VudGFnZSdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3NjSScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1NJJyxcbiAgICAgICAgICAgIG1pbldpZHRoOiBwZXJjZW50RmllbGRNaW5XaWR0aCxcbiAgICAgICAgICAgIGNlbGxGaWx0ZXI6ICdwZXJjZW50YWdlJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnc2NGJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU0YnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZOJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRFAnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZNJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRE0nXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZGJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREYnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZMJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREwnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZUJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRFQnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZCJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZDJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREMnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkZWZTJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU3QnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdkaXZNb2QnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdEaXYnLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICdvY2NNb2QnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdPY2MnLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICAnYXJtb3JzJzogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdhcm1vclNldCcsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1NldCcsXG4gICAgICAgICAgICBtaW5XaWR0aDogMTUwLFxuICAgICAgICAgICAgc29ydDoge1xuICAgICAgICAgICAgICBkaXJlY3Rpb246IHVpR3JpZENvbnN0YW50cy5BU0MsXG4gICAgICAgICAgICAgIHByaW9yaXR5OiAwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2FybW9yVHlwZScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1R5cGUnLFxuICAgICAgICAgICAgc29ydDoge1xuICAgICAgICAgICAgICBkaXJlY3Rpb246IHVpR3JpZENvbnN0YW50cy5BU0MsXG4gICAgICAgICAgICAgIHByaW9yaXR5OiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc29ydGluZ0FsZ29yaXRobTogZnVuY3Rpb24oYSwgYil7XG4gICAgICAgICAgICAgIHZhciB2YWx1ZXM7XG4gICAgICAgICAgICAgIHZhbHVlcyA9IHtcbiAgICAgICAgICAgICAgICAnaGVhZCc6IDEsXG4gICAgICAgICAgICAgICAgJ2NoZXN0JzogMixcbiAgICAgICAgICAgICAgICAnaGFuZHMnOiAzLFxuICAgICAgICAgICAgICAgICdsZWdzJzogNFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWVzW2FdID4gdmFsdWVzW2JdXG4gICAgICAgICAgICAgICAgPyAxXG4gICAgICAgICAgICAgICAgOiB2YWx1ZXNbYV0gPCB2YWx1ZXNbYl0gPyAtMSA6IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICduYW1lJyxcbiAgICAgICAgICAgIG1pbldpZHRoOiAyNTBcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnZGVmTicsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRE4nXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2RlZlNsJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdEU2wnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2RlZlN0JyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdEU3QnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2RlZlRoJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdEVGgnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2RlZk0nLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0RNJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdkZWZGJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdERidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnZGVmTCcsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREwnXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2RlZlAnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0RQJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdkZWZUJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdSUCdcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnZGVmQicsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnUkInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2RlZkMnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JDJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdzdFJlYycsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU3InXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ3dlaWdodCcsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnV3QnXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9O1xuICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IFsnaXRlbXMnLCAna2V5cycsICdtYXRlcmlhbHMnLCAncmluZ3MnXSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgICAgaXRlbVR5cGUgPSByZWYkW2kkXTtcbiAgICAgICAgJHNjb3BlLmNvbHVtbkNvbmZpZ3NbaXRlbVR5cGVdID0gW3tcbiAgICAgICAgICBmaWVsZDogJ25hbWUnLFxuICAgICAgICAgIHNvcnQ6IHtcbiAgICAgICAgICAgIGRpcmVjdGlvbjogdWlHcmlkQ29uc3RhbnRzLkFTQyxcbiAgICAgICAgICAgIHByaW9yaXR5OiAwXG4gICAgICAgICAgfVxuICAgICAgICB9XTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIHZhciBJdGVtSW5kZXhTZXJ2aWNlO1xuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT0gJ3VuZGVmaW5lZCcgJiYgYW5ndWxhciAhPT0gbnVsbCkge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLnNlcnZpY2UoXCJpdGVtSW5kZXhTdmNcIiwgZnVuY3Rpb24oZXh0ZXJuYWxEYXRhU3ZjKXtcbiAgICAgIHJldHVybiBuZXcgSXRlbUluZGV4U2VydmljZShleHRlcm5hbERhdGFTdmMpO1xuICAgIH0pO1xuICB9XG4gIEl0ZW1JbmRleFNlcnZpY2UgPSAoZnVuY3Rpb24oKXtcbiAgICBJdGVtSW5kZXhTZXJ2aWNlLmRpc3BsYXlOYW1lID0gJ0l0ZW1JbmRleFNlcnZpY2UnO1xuICAgIHZhciBwcm90b3R5cGUgPSBJdGVtSW5kZXhTZXJ2aWNlLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBJdGVtSW5kZXhTZXJ2aWNlO1xuICAgIGZ1bmN0aW9uIEl0ZW1JbmRleFNlcnZpY2UoZXh0ZXJuYWxEYXRhU3ZjKXtcbiAgICAgIHRoaXMuZXh0ZXJuYWxEYXRhU3ZjID0gZXh0ZXJuYWxEYXRhU3ZjO1xuICAgICAgdGhpcy5sb2FkQWxsRW50cmllcyA9IGJpbmQkKHRoaXMsICdsb2FkQWxsRW50cmllcycsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmxvYWRBbGxBcm1vclNldEVudHJpZXMgPSBiaW5kJCh0aGlzLCAnbG9hZEFsbEFybW9yU2V0RW50cmllcycsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmZpbmRCeUFybW9yU2V0ID0gYmluZCQodGhpcywgJ2ZpbmRCeUFybW9yU2V0JywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuZmluZEFybW9yU2V0Rm9yID0gYmluZCQodGhpcywgJ2ZpbmRBcm1vclNldEZvcicsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmZpbmRFbnRyaWVzID0gYmluZCQodGhpcywgJ2ZpbmRFbnRyaWVzJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuZmluZEVudHJ5ID0gYmluZCQodGhpcywgJ2ZpbmRFbnRyeScsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmNsZWFyID0gYmluZCQodGhpcywgJ2NsZWFyJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuX2luZGV4ID0gW107XG4gICAgICB0aGlzLl9hcm1vclNldEluZGV4ID0gW107XG4gICAgfVxuICAgIHByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCl7XG4gICAgICB0aGlzLl9pbmRleC5sZW5ndGggPSAwO1xuICAgICAgZGVsZXRlIHRoaXMuX2luZGV4LiRwcm9taXNlO1xuICAgICAgdGhpcy5fYXJtb3JTZXRJbmRleC5sZW5ndGggPSAwO1xuICAgICAgZGVsZXRlIHRoaXMuX2FybW9yU2V0SW5kZXguJHByb21pc2U7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZpbmRzIHRoZSBmaXJzdCBpdGVtIG1hdGNoaW5nIGEgZ2l2ZW4gZmlsdGVyLlxuICAgICAqIEBwYXJhbSBieUZpbHRlciBGdW5jdGlvbiBmaWx0ZXIgZnVuY3Rpb24gdGhhdCB0YWtlcyBpdGVtIGFzXG4gICAgICogYSBwYXJhbWV0ZXIgYW5kIHJldHVybnMgdHJ1ZS9mYWxzZSBpZiBpdCBtYXRjaGVzL2RvZXNuJ3QuXG4gICAgICogQHJldHVybnMgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIGZvdW5kIHZhbHVlLlxuICAgICAqL1xuICAgIHByb3RvdHlwZS5maW5kRW50cnkgPSBmdW5jdGlvbihieUZpbHRlcil7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgaWYgKHR5cGVvZiBieUZpbHRlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJbYnlGaWx0ZXJdIGlzIG5vdCBhIGZ1bmN0aW9uLlwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmxvYWRBbGxFbnRyaWVzKCkudGhlbihmdW5jdGlvbihpdCl7XG4gICAgICAgIHJldHVybiBmaW5kKGJ5RmlsdGVyKShcbiAgICAgICAgaXQpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuZmluZEVudHJpZXMgPSBmdW5jdGlvbihieUZpbHRlcil7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgaWYgKHR5cGVvZiBieUZpbHRlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJbYnlGaWx0ZXJdIGlzIG5vdCBhIGZ1bmN0aW9uLlwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmxvYWRBbGxFbnRyaWVzKCkudGhlbihmdW5jdGlvbihpdCl7XG4gICAgICAgIHJldHVybiBmaWx0ZXIoYnlGaWx0ZXIpKFxuICAgICAgICBpdCk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5maW5kQXJtb3JTZXRGb3IgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgICByZXR1cm4gdGhpcy5sb2FkQWxsQXJtb3JTZXRFbnRyaWVzKCkudGhlbihmdW5jdGlvbihpdCl7XG4gICAgICAgIHJldHVybiBmaW5kKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQudWlkID09PSBpdGVtLnVpZDtcbiAgICAgICAgfSkoXG4gICAgICAgIGl0KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmZpbmRCeUFybW9yU2V0ID0gZnVuY3Rpb24oc2V0TmFtZSl7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgaWYgKHR5cGVvZiBzZXROYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgICBzZXROYW1lID0gc2V0TmFtZS5uYW1lO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBzZXROYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBcm1vciBzZXQgbmFtZSBtdXN0IGJlIGEgc3RyaW5nLCBvciBhbiBvYmplY3Qgd2l0aCBzdHJpbmcgcHJvcGVydHkgW25hbWVdLlwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmxvYWRBbGxBcm1vclNldEVudHJpZXMoKS50aGVuKGZ1bmN0aW9uKHNldHMpe1xuICAgICAgICB2YXIgYXJtb3JJZHMsIHJlZiQ7XG4gICAgICAgIGFybW9ySWRzID0gKHJlZiQgPSBmaW5kKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQubmFtZSA9PT0gc2V0TmFtZTtcbiAgICAgICAgfSkoXG4gICAgICAgIHNldHMpKSAhPSBudWxsID8gcmVmJC5hcm1vcnMgOiB2b2lkIDg7XG4gICAgICAgIHJldHVybiB0aGlzJC5maW5kRW50cmllcyhmdW5jdGlvbihlbnRyeSl7XG4gICAgICAgICAgcmV0dXJuIGFueSgoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgICAgcmV0dXJuIGl0ID09PSBlbnRyeS5pZDtcbiAgICAgICAgICB9KSkoXG4gICAgICAgICAgYXJtb3JJZHMpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmxvYWRBbGxBcm1vclNldEVudHJpZXMgPSBmdW5jdGlvbihyZXR1cm5Qcm9taXNlKXtcbiAgICAgIHJldHVyblByb21pc2UgPT0gbnVsbCAmJiAocmV0dXJuUHJvbWlzZSA9IHRydWUpO1xuICAgICAgaWYgKHRoaXMuX2FybW9yU2V0SW5kZXguJHByb21pc2UgPT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9hcm1vclNldEluZGV4ID0gdGhpcy5leHRlcm5hbERhdGFTdmMubG9hZEpzb24oJy9tb2R1bGVzL2l0ZW1zL2NvbnRlbnQvYXJtb3Itc2V0LWluZGV4Lmpzb24nLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV0dXJuUHJvbWlzZVxuICAgICAgICA/IHRoaXMuX2FybW9yU2V0SW5kZXguJHByb21pc2VcbiAgICAgICAgOiB0aGlzLl9hcm1vclNldEluZGV4O1xuICAgIH07XG4gICAgcHJvdG90eXBlLmxvYWRBbGxFbnRyaWVzID0gZnVuY3Rpb24ocmV0dXJuUHJvbWlzZSl7XG4gICAgICByZXR1cm5Qcm9taXNlID09IG51bGwgJiYgKHJldHVyblByb21pc2UgPSB0cnVlKTtcbiAgICAgIGlmICh0aGlzLl9pbmRleC4kcHJvbWlzZSA9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2luZGV4ID0gdGhpcy5leHRlcm5hbERhdGFTdmMubG9hZEpzb24oJy9tb2R1bGVzL2l0ZW1zL2NvbnRlbnQvaW5kZXguanNvbicsIGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5Qcm9taXNlXG4gICAgICAgID8gdGhpcy5faW5kZXguJHByb21pc2VcbiAgICAgICAgOiB0aGlzLl9pbmRleDtcbiAgICB9O1xuICAgIHJldHVybiBJdGVtSW5kZXhTZXJ2aWNlO1xuICB9KCkpO1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPSAndW5kZWZpbmVkJyAmJiBtb2R1bGUgIT09IG51bGwpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IEl0ZW1JbmRleFNlcnZpY2U7XG4gIH1cbiAgZnVuY3Rpb24gYmluZCQob2JqLCBrZXksIHRhcmdldCl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7IHJldHVybiAodGFyZ2V0IHx8IG9iailba2V5XS5hcHBseShvYmosIGFyZ3VtZW50cykgfTtcbiAgfVxufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICB2YXIgSXRlbVNlcnZpY2U7XG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPSAndW5kZWZpbmVkJyAmJiBhbmd1bGFyICE9PSBudWxsKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuc2VydmljZShcIml0ZW1TdmNcIiwgZnVuY3Rpb24oZXh0ZXJuYWxEYXRhU3ZjLCBpdGVtSW5kZXhTdmMsIGl0ZW1VcGdyYWRlU3ZjKXtcbiAgICAgIHJldHVybiBuZXcgSXRlbVNlcnZpY2UoZXh0ZXJuYWxEYXRhU3ZjLCBpdGVtSW5kZXhTdmMsIGl0ZW1VcGdyYWRlU3ZjKTtcbiAgICB9KTtcbiAgfVxuICBJdGVtU2VydmljZSA9IChmdW5jdGlvbigpe1xuICAgIEl0ZW1TZXJ2aWNlLmRpc3BsYXlOYW1lID0gJ0l0ZW1TZXJ2aWNlJztcbiAgICB2YXIgcHJvdG90eXBlID0gSXRlbVNlcnZpY2UucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEl0ZW1TZXJ2aWNlO1xuICAgIGZ1bmN0aW9uIEl0ZW1TZXJ2aWNlKF9leHRlcm5hbERhdGFTdmMsIF9pdGVtSW5kZXhTdmMsIF9pdGVtVXBncmFkZVN2Yyl7XG4gICAgICB0aGlzLl9leHRlcm5hbERhdGFTdmMgPSBfZXh0ZXJuYWxEYXRhU3ZjO1xuICAgICAgdGhpcy5faXRlbUluZGV4U3ZjID0gX2l0ZW1JbmRleFN2YztcbiAgICAgIHRoaXMuX2l0ZW1VcGdyYWRlU3ZjID0gX2l0ZW1VcGdyYWRlU3ZjO1xuICAgICAgdGhpcy5nZXRVcGdyYWRlZCA9IGJpbmQkKHRoaXMsICdnZXRVcGdyYWRlZCcsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmxvYWRBbGxJdGVtcyA9IGJpbmQkKHRoaXMsICdsb2FkQWxsSXRlbXMnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5jcmVhdGVJdGVtTW9kZWwgPSBiaW5kJCh0aGlzLCAnY3JlYXRlSXRlbU1vZGVsJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuZmluZEFueUl0ZW0gPSBiaW5kJCh0aGlzLCAnZmluZEFueUl0ZW0nLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5maW5kQmFzZUl0ZW0gPSBiaW5kJCh0aGlzLCAnZmluZEJhc2VJdGVtJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuZmluZEl0ZW0gPSBiaW5kJCh0aGlzLCAnZmluZEl0ZW0nLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5jbGVhciA9IGJpbmQkKHRoaXMsICdjbGVhcicsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLl9zdG9yYWdlID0ge307XG4gICAgICB0aGlzLl9tb2RlbHMgPSByZXF1aXJlKCcuL21vZGVscy9pdGVtLW1vZGVscycpO1xuICAgIH1cbiAgICBwcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpe1xuICAgICAgdGhpcy5fc3RvcmFnZSA9IHt9O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBpdGVtIG1hdGNoaW5nIGEgZ2l2ZW4gZmlsdGVyXG4gICAgICogQHBhcmFtIGl0ZW1UeXBlIFN0cmluZyB0eXBlIG9mIGl0ZW0gdG8gZmluZC5cbiAgICAgKiBAcGFyYW0gZmlsdGVyRm4gRnVuY3Rpb24gRmlsdGVyIGZ1bmN0aW9uXG4gICAgICogQHJldHVybiBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgZm91bmQgaXRlbSwgb3IgbnVsbCBpZiBub3RoaW5nIGZvdW5kLlxuICAgICAqL1xuICAgIHByb3RvdHlwZS5maW5kSXRlbSA9IGZ1bmN0aW9uKGl0ZW1UeXBlLCBmaWx0ZXJGbil7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgaWYgKHR5cGVvZiBpdGVtVHlwZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSXRlbSB0eXBlIGlzIGludmFsaWQgb3Igbm90IHByb3ZpZGVkXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMubG9hZEFsbEl0ZW1zKGl0ZW1UeXBlKS50aGVuKGZ1bmN0aW9uKGl0ZW1zKXtcbiAgICAgICAgdmFyIGl0ZW07XG4gICAgICAgIGl0ZW0gPSBmaW5kKGZpbHRlckZuKShcbiAgICAgICAgaXRlbXMpO1xuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmZpbmRCYXNlSXRlbSA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICAgIHJldHVybiB0aGlzLmZpbmRJdGVtKGl0ZW0uaXRlbVR5cGUsIGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgcmV0dXJuIGl0LmlkID09PSB0aGlzJC5faXRlbVVwZ3JhZGVTdmMuZ2V0QmFzZUlkRnJvbShpdGVtLmlkKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogRmluZHMgYW55IGl0ZW0sIHJlZ2FyZGxlc3Mgb2YgdHlwZSwgYnV0IGNhbiBvbmx5XG4gICAgICogY2hlY2sgZmllbGRzIHRoYXQgYXJlIGluIHRoZSBpbmRleC5cbiAgICAgKi9cbiAgICBwcm90b3R5cGUuZmluZEFueUl0ZW0gPSBmdW5jdGlvbihmaWx0ZXJGbil7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1JbmRleFN2Yy5maW5kRW50cnkoZmlsdGVyRm4pLnRoZW4oZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIHZhciBiYXNlSWQsIHVwTGV2ZWw7XG4gICAgICAgIGlmICh0aGlzJC5faXRlbVVwZ3JhZGVTdmMuaXNVcGdyYWRlZChpdGVtKSkge1xuICAgICAgICAgIGJhc2VJZCA9IHRoaXMkLl9pdGVtVXBncmFkZVN2Yy5nZXRCYXNlSWRGcm9tKGl0ZW0uaWQpO1xuICAgICAgICAgIHVwTGV2ZWwgPSB0aGlzJC5faXRlbVVwZ3JhZGVTdmMuZ2V0VXBncmFkZUxldmVsRnJvbShpdGVtLmlkKTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oaXRlbSwgYmFzZUlkLCB1cExldmVsKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzJC5maW5kSXRlbShpdGVtLml0ZW1UeXBlLCBmdW5jdGlvbihpdCl7XG4gICAgICAgICAgICAgIHJldHVybiBpdC5pZCA9PT0gYmFzZUlkO1xuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihiYXNlSXRlbSl7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzJC5nZXRVcGdyYWRlZChiYXNlSXRlbSwgdXBMZXZlbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KGl0ZW0sIGJhc2VJZCwgdXBMZXZlbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMkLmZpbmRJdGVtKGl0ZW0uaXRlbVR5cGUsIGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICAgIHJldHVybiBpdC5pZCA9PT0gaXRlbS5pZDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBtb2RlbCBmcm9tIGdpdmVuIGl0ZW0gZGF0YVxuICAgICAqL1xuICAgIHByb3RvdHlwZS5jcmVhdGVJdGVtTW9kZWwgPSBmdW5jdGlvbihkYXRhKXtcbiAgICAgIHJldHVybiAoZnVuY3Rpb24oKXtcbiAgICAgICAgc3dpdGNoIChkYXRhLml0ZW1UeXBlKSB7XG4gICAgICAgIGNhc2UgJ3dlYXBvbic6XG4gICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLl9tb2RlbHMuV2VhcG9uO1xuICAgICAgICBjYXNlICdhcm1vcic6XG4gICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLl9tb2RlbHMuQXJtb3I7XG4gICAgICAgIGNhc2UgJ2l0ZW0nOlxuICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5fbW9kZWxzLkl0ZW07XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiW1wiICsgZGF0YS5pdGVtVHlwZSArIFwiXSBpcyBub3QgYSByZWNvZ25pemVkIGl0ZW0gdHlwZS5cIik7XG4gICAgICAgIH1cbiAgICAgIH0uY2FsbCh0aGlzKSkudXNlRGF0YUZyb20oZGF0YSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBMb2FkIGl0ZW0gZGF0YSBvZiBhIGdpdmVuIGl0ZW0gdHlwZS5cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlIG9yIHBvcHVsYXRlZCBhcnJheSwgZGVwZW5kaW5nIG9uIHJldHVyblByb21pc2Ugc2V0dGluZy5cbiAgICAgKi9cbiAgICBwcm90b3R5cGUubG9hZEFsbEl0ZW1zID0gZnVuY3Rpb24oaXRlbVR5cGUsIHJldHVyblByb21pc2Upe1xuICAgICAgdmFyIHJlZiQsIHRlc3QsIHRoaXMkID0gdGhpcztcbiAgICAgIHJldHVyblByb21pc2UgPT0gbnVsbCAmJiAocmV0dXJuUHJvbWlzZSA9IHRydWUpO1xuICAgICAgaWYgKCgocmVmJCA9IHRoaXMuX3N0b3JhZ2UpW2l0ZW1UeXBlXSB8fCAocmVmJFtpdGVtVHlwZV0gPSBbXSkpLiRwcm9taXNlID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fc3RvcmFnZVtpdGVtVHlwZV0uJHByb21pc2UgPSB0ZXN0ID0gdGhpcy5fZXh0ZXJuYWxEYXRhU3ZjLmxvYWRKc29uKFwiL21vZHVsZXMvaXRlbXMvY29udGVudC9cIiArIGl0ZW1UeXBlICsgXCJzLmpzb25cIikudGhlbihmdW5jdGlvbihpdGVtRGF0YSl7XG4gICAgICAgICAgZWFjaChmdW5jdGlvbihpdCl7XG4gICAgICAgICAgICB2YXIgcmVmJDtcbiAgICAgICAgICAgICgocmVmJCA9IHRoaXMkLl9zdG9yYWdlKVtpdGVtVHlwZV0gfHwgKHJlZiRbaXRlbVR5cGVdID0gW10pKS5wdXNoKHRoaXMkLmNyZWF0ZUl0ZW1Nb2RlbChpdCkpO1xuICAgICAgICAgIH0pKFxuICAgICAgICAgIGl0ZW1EYXRhKTtcbiAgICAgICAgICByZXR1cm4gdGhpcyQuX3N0b3JhZ2VbaXRlbVR5cGVdO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5Qcm9taXNlXG4gICAgICAgID8gdGhpcy5fc3RvcmFnZVtpdGVtVHlwZV0uJHByb21pc2VcbiAgICAgICAgOiB0aGlzLl9zdG9yYWdlW2l0ZW1UeXBlXTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5nZXRVcGdyYWRlZCA9IGZ1bmN0aW9uKGl0ZW0sIGxldmVsKXtcbiAgICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgICBsZXZlbCA9PSBudWxsICYmIChsZXZlbCA9IHRydWUpO1xuICAgICAgaWYgKGxldmVsID09PSB0cnVlKSB7XG4gICAgICAgIGxldmVsID0gaXRlbS51cGdyYWRlSWQgKyAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1VcGdyYWRlU3ZjLmZpbmRVcGdyYWRlRm9yKGl0ZW0sIGxldmVsKS50aGVuKGZ1bmN0aW9uKHVwZ3JhZGUpe1xuICAgICAgICBpZiAodXBncmFkZSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMkLmZpbmRCYXNlSXRlbShcbiAgICAgICAgaXRlbSkudGhlbihmdW5jdGlvbihiYXNlSXRlbSl7XG4gICAgICAgICAgcmV0dXJuIHRoaXMkLmNyZWF0ZUl0ZW1Nb2RlbChiYXNlSXRlbSk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24obmV3SXRlbSl7XG4gICAgICAgICAgcmV0dXJuIHRoaXMkLl9pdGVtVXBncmFkZVN2Yy5hcHBseSh1cGdyYWRlKS50byhuZXdJdGVtKTtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihuZXdJdGVtKXtcbiAgICAgICAgICByZXR1cm4gdGhpcyQuX2l0ZW1JbmRleFN2Yy5maW5kRW50cnkoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgICAgcmV0dXJuIGl0LnVpZCA9PT0gbmV3SXRlbS51aWQ7XG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihlbnRyeSl7XG4gICAgICAgICAgICBuZXdJdGVtLm5hbWUgPSBlbnRyeS5uYW1lO1xuICAgICAgICAgICAgcmV0dXJuIG5ld0l0ZW07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24obmV3SXRlbSl7XG4gICAgICAgICAgaWYgKG5ld0l0ZW0uaXRlbVR5cGUgPT09ICdhcm1vcicpIHtcbiAgICAgICAgICAgIG5ld0l0ZW0uYXJtb3JTZXQgPSB0aGlzJC5faXRlbUluZGV4U3ZjLmZpbmRBcm1vclNldEZvcihuZXdJdGVtKS5uYW1lO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbmV3SXRlbTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBJdGVtU2VydmljZTtcbiAgfSgpKTtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlICE9PSBudWxsKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBJdGVtU2VydmljZTtcbiAgfVxuICBmdW5jdGlvbiBiaW5kJChvYmosIGtleSwgdGFyZ2V0KXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXsgcmV0dXJuICh0YXJnZXQgfHwgb2JqKVtrZXldLmFwcGx5KG9iaiwgYXJndW1lbnRzKSB9O1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIHZhciBJdGVtVXBncmFkZVNlcnZpY2U7XG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPSAndW5kZWZpbmVkJyAmJiBhbmd1bGFyICE9PSBudWxsKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuc2VydmljZShcIml0ZW1VcGdyYWRlU3ZjXCIsIGZ1bmN0aW9uKGV4dGVybmFsRGF0YVN2Yyl7XG4gICAgICByZXR1cm4gbmV3IEl0ZW1VcGdyYWRlU2VydmljZShleHRlcm5hbERhdGFTdmMpO1xuICAgIH0pO1xuICB9XG4gIEl0ZW1VcGdyYWRlU2VydmljZSA9IChmdW5jdGlvbigpe1xuICAgIEl0ZW1VcGdyYWRlU2VydmljZS5kaXNwbGF5TmFtZSA9ICdJdGVtVXBncmFkZVNlcnZpY2UnO1xuICAgIHZhciBwcm90b3R5cGUgPSBJdGVtVXBncmFkZVNlcnZpY2UucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEl0ZW1VcGdyYWRlU2VydmljZTtcbiAgICBmdW5jdGlvbiBJdGVtVXBncmFkZVNlcnZpY2UoZXh0ZXJuYWxEYXRhU3ZjKXtcbiAgICAgIHRoaXMuZXh0ZXJuYWxEYXRhU3ZjID0gZXh0ZXJuYWxEYXRhU3ZjO1xuICAgICAgdGhpcy5hcHBseSA9IGJpbmQkKHRoaXMsICdhcHBseScsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmNhbkJlVXBncmFkZWRGdXJ0aGVyID0gYmluZCQodGhpcywgJ2NhbkJlVXBncmFkZWRGdXJ0aGVyJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuY2FuQmVVcGdyYWRlZCA9IGJpbmQkKHRoaXMsICdjYW5CZVVwZ3JhZGVkJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuaXNVcGdyYWRlZCA9IGJpbmQkKHRoaXMsICdpc1VwZ3JhZGVkJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMudXBncmFkZUxldmVsT2YgPSBiaW5kJCh0aGlzLCAndXBncmFkZUxldmVsT2YnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5lbnN1cmVJdENhbkJlVXBncmFkZWQgPSBiaW5kJCh0aGlzLCAnZW5zdXJlSXRDYW5CZVVwZ3JhZGVkJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMubG9hZEFsbFVwZ3JhZGVzID0gYmluZCQodGhpcywgJ2xvYWRBbGxVcGdyYWRlcycsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmxvYWRBbGxNYXRlcmlhbFNldHMgPSBiaW5kJCh0aGlzLCAnbG9hZEFsbE1hdGVyaWFsU2V0cycsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmRlZHVjdEZyb20gPSBiaW5kJCh0aGlzLCAnZGVkdWN0RnJvbScsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmFyZSA9IGJpbmQkKHRoaXMsICdhcmUnLCBwcm90b3R5cGUpO1xuICAgICAgdGhpcy5maW5kVXBncmFkZU1hdGVyaWFsc0ZvciA9IGJpbmQkKHRoaXMsICdmaW5kVXBncmFkZU1hdGVyaWFsc0ZvcicsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmZpbmRVcGdyYWRlRm9yID0gYmluZCQodGhpcywgJ2ZpbmRVcGdyYWRlRm9yJywgcHJvdG90eXBlKTtcbiAgICAgIHRoaXMuZ2V0QmFzZUl0ZW1JZE9mID0gYmluZCQodGhpcywgJ2dldEJhc2VJdGVtSWRPZicsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmdldFVwZ3JhZGVMZXZlbEZyb20gPSBiaW5kJCh0aGlzLCAnZ2V0VXBncmFkZUxldmVsRnJvbScsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLmdldEJhc2VJZEZyb20gPSBiaW5kJCh0aGlzLCAnZ2V0QmFzZUlkRnJvbScsIHByb3RvdHlwZSk7XG4gICAgICB0aGlzLl91cGdyYWRlcyA9IHt9O1xuICAgICAgdGhpcy5fbWF0ZXJpYWxTZXRzID0gW107XG4gICAgfVxuICAgIHByb3RvdHlwZS5nZXRCYXNlSWRGcm9tID0gZnVuY3Rpb24oaWQpe1xuICAgICAgcmV0dXJuIGlkIC0gdGhpcy5nZXRVcGdyYWRlTGV2ZWxGcm9tKGlkKTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5nZXRVcGdyYWRlTGV2ZWxGcm9tID0gZnVuY3Rpb24oaWQpe1xuICAgICAgcmV0dXJuIGlkICUgMTAwO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmdldEJhc2VJdGVtSWRPZiA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QmFzZUlkRnJvbShpdGVtLmlkKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgdXBncmFkZSBtb2RlbCBmb3IgYSBnaXZlbiB3ZWFwb24gYXQgYSBnaXZlbiB1cGdyYWRlIGxldmVsXG4gICAgICogQHJldHVybnMgUHJvbWlzZSwgcmVzb2x2ZWQgd2l0aCB0aGUgdXBncmFkZSAob3IgbnVsbCBpZiBub3RoaW5nIGZvdW5kKVxuICAgICAqL1xuICAgIHByb3RvdHlwZS5maW5kVXBncmFkZUZvciA9IGZ1bmN0aW9uKGl0ZW0sIGxldmVsKXtcbiAgICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgICByZXR1cm4gdGhpcy5sb2FkQWxsVXBncmFkZXMoaXRlbS5pdGVtVHlwZSkudGhlbihmdW5jdGlvbih1cGdyYWRlcyl7XG4gICAgICAgIHJldHVybiBmaW5kKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQuaWQgPT09IHRoaXMkLmdldEJhc2VJZEZyb20oaXRlbS51cGdyYWRlSWQpICsgbGV2ZWw7XG4gICAgICAgIH0pKFxuICAgICAgICB1cGdyYWRlcyk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEZpbmQgdGhlIG1hdGVyaWFscyByZXF1aXJlZCB0byB1cGdyYWRlIGEgZ2l2ZW4gaXRlbSB1c2luZyBhIGdpdmVuIHVwZ3JhZGUgbW9kZWwuXG4gICAgICogQHJldHVybnMgUHJvbWlzZSB0aGF0IGlzIHJlc29sdmVkIHdpdGggdGhlIG1hdGVyaWFsIGRhdGEuXG4gICAgICovXG4gICAgcHJvdG90eXBlLmZpbmRVcGdyYWRlTWF0ZXJpYWxzRm9yID0gZnVuY3Rpb24oaXRlbSwgdXBncmFkZSl7XG4gICAgICB2YXIgeCQsIHRoaXMkID0gdGhpcztcbiAgICAgIGlmICghKGl0ZW0gIT0gbnVsbCAmJiB1cGdyYWRlICE9IG51bGwpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGZpbmQgdXBncmFkZSBtYXRlcmlhbHMsIGVpdGhlciBpdGVtIG9yIHVwZ3JhZGUgaXMgdW5zZXQuXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZW0ubWF0U2V0SWQgPCAwKSB7XG4gICAgICAgIHgkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgeCQucmVzb2x2ZShudWxsKTtcbiAgICAgICAgcmV0dXJuIHgkLnByb21pc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5sb2FkQWxsTWF0ZXJpYWxTZXRzKCkudGhlbihmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gZmluZChmdW5jdGlvbihpdCl7XG4gICAgICAgICAgcmV0dXJuIGl0LmlkID09PSB0aGlzJC5nZXRCYXNlSWRGcm9tKGl0ZW0ubWF0U2V0SWQpICsgdXBncmFkZS5tYXRTZXRJZDtcbiAgICAgICAgfSkoXG4gICAgICAgIHRoaXMkLl9tYXRlcmlhbFNldHMpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuYXJlID0gZnVuY3Rpb24obWF0ZXJpYWxzKXtcbiAgICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbm91Z2hUb1VwZ3JhZGU6IGZ1bmN0aW9uKGl0ZW0sIGxldmVsKXtcbiAgICAgICAgICByZXR1cm4gdGhpcyQuZmluZFVwZ3JhZGVGb3IoaXRlbSwgbGV2ZWwpLnRoZW4oZnVuY3Rpb24odXBncmFkZSl7XG4gICAgICAgICAgICBpZiAodXBncmFkZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzJC5maW5kVXBncmFkZU1hdGVyaWFsc0ZvcihpdGVtLCB1cGdyYWRlKTtcbiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKG1hdGVyaWFsU2V0KXtcbiAgICAgICAgICAgIGlmIChtYXRlcmlhbFNldCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYW55KGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICAgICAgcmV0dXJuIGl0LmlkID09PSBtYXRlcmlhbFNldC5tYXRJZCAmJiBpdC5hbW91bnQgPj0gbWF0ZXJpYWxTZXQubWF0Q29zdDtcbiAgICAgICAgICAgIH0pKFxuICAgICAgICAgICAgbWF0ZXJpYWxzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9O1xuICAgIHByb3RvdHlwZS5kZWR1Y3RGcm9tID0gZnVuY3Rpb24obWF0ZXJpYWxzKXtcbiAgICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb3N0T2ZVcGdyYWRlOiBmdW5jdGlvbihpdGVtLCBsZXZlbCl7XG4gICAgICAgICAgcmV0dXJuIHRoaXMkLmZpbmRVcGdyYWRlRm9yKGl0ZW0sIGxldmVsKS50aGVuKGZ1bmN0aW9uKHVwZ3JhZGUpe1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMkLmZpbmRVcGdyYWRlTWF0ZXJpYWxzRm9yKGl0ZW0sIHVwZ3JhZGUpO1xuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24obWF0ZXJpYWxTZXQpe1xuICAgICAgICAgICAgcmV0dXJuIGZpbmQoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgICAgICByZXR1cm4gaXQuaWQgPT09IG1hdGVyaWFsU2V0Lm1hdElkO1xuICAgICAgICAgICAgfSkoXG4gICAgICAgICAgICBtYXRlcmlhbHMpLmFtb3VudCAtPSBtYXRlcmlhbFNldC5tYXRDb3N0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQXN5bmNocm9ub3VzbHkgbG9hZHMgYWxsIGluZm9ybWF0aW9uIG9uIG1hdGVyaWFsIHNldHMgcmVxdWlyZWQgZm9yIHVwZ3JhZGVzXG4gICAgICogQHJldHVybnMgUHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgbWF0ZXJpYWwgc2V0IGRhdGEuXG4gICAgICovXG4gICAgcHJvdG90eXBlLmxvYWRBbGxNYXRlcmlhbFNldHMgPSBmdW5jdGlvbigpe1xuICAgICAgaWYgKHRoaXMuX21hdGVyaWFsU2V0cy4kcHJvbWlzZSA9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX21hdGVyaWFsU2V0cyA9IHRoaXMuZXh0ZXJuYWxEYXRhU3ZjLmxvYWRKc29uKFwiL21vZHVsZXMvaXRlbXMvY29udGVudC9tYXRlcmlhbC1zZXRzLmpzb25cIiwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX21hdGVyaWFsU2V0cy4kcHJvbWlzZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIExvYWQgaW5mb3JtYXRpb24gb24gYWxsIHVwZ3JhZGVzIGZvciBhIGdpdmVuIGl0ZW0gdHlwZVxuICAgICAqIEByZXR1cm5zIFByb21pc2UgcmVzb2x2ZWQgd2l0aCB0aGUgdXBncmFkZSBkYXRhXG4gICAgICovXG4gICAgcHJvdG90eXBlLmxvYWRBbGxVcGdyYWRlcyA9IGZ1bmN0aW9uKGl0ZW1UeXBlKXtcbiAgICAgIHZhciByZWYkO1xuICAgICAgdGhpcy5lbnN1cmVJdENhbkJlVXBncmFkZWQoXG4gICAgICBpdGVtVHlwZSk7XG4gICAgICBpZiAoKChyZWYkID0gdGhpcy5fdXBncmFkZXMpW2l0ZW1UeXBlXSB8fCAocmVmJFtpdGVtVHlwZV0gPSBbXSkpLiRwcm9taXNlID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fdXBncmFkZXNbaXRlbVR5cGVdID0gdGhpcy5leHRlcm5hbERhdGFTdmMubG9hZEpzb24oXCIvbW9kdWxlcy9pdGVtcy9jb250ZW50L1wiICsgaXRlbVR5cGUgKyBcIi11cGdyYWRlcy5qc29uXCIsIGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl91cGdyYWRlc1tpdGVtVHlwZV0uJHByb21pc2U7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuZW5zdXJlSXRDYW5CZVVwZ3JhZGVkID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICBpZiAoaXRlbSA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkl0ZW0gLyBpdGVtIHR5cGUgbm90IHByb3ZpZGVkLlwiKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaXRlbSA9IHtcbiAgICAgICAgICBpdGVtVHlwZTogaXRlbVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmNhbkJlVXBncmFkZWQoXG4gICAgICBpdGVtKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IHdlYXBvbnMgYW5kIGFybW9ycyBjYW4gYmUgdXBncmFkZWQsIHRoaXMgaXMgYSBbXCIgKyBpdGVtLml0ZW1UeXBlICsgXCJdLlwiKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHByb3RvdHlwZS51cGdyYWRlTGV2ZWxPZiA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgcmV0dXJuIGl0ZW0uaWQgJSAxMDA7XG4gICAgfTtcbiAgICBwcm90b3R5cGUuaXNVcGdyYWRlZCA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgcmV0dXJuIHRoaXMudXBncmFkZUxldmVsT2YoaXRlbSkgPiAwO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmNhbkJlVXBncmFkZWQgPSBmdW5jdGlvbihpdGVtKXtcbiAgICAgIHJldHVybiBpdGVtLml0ZW1UeXBlID09PSAnd2VhcG9uJyB8fCBpdGVtLml0ZW1UeXBlID09PSAnYXJtb3InO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmNhbkJlVXBncmFkZWRGdXJ0aGVyID0gZnVuY3Rpb24oaXRlbSl7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgaWYgKCF0aGlzLmNhbkJlVXBncmFkZWQoaXRlbSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZmluZFVwZ3JhZGVGb3IoaXRlbSwgdGhpcy51cGdyYWRlTGV2ZWxPZihpdGVtKSkudGhlbihmdW5jdGlvbih1cGdyYWRlKXtcbiAgICAgICAgcmV0dXJuIHVwZ3JhZGUgIT0gbnVsbDtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgcHJvdG90eXBlLmFwcGx5ID0gZnVuY3Rpb24odXBncmFkZSl7XG4gICAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgICAgaWYgKHVwZ3JhZGUgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB1cGdyYWRlIGRhdGEgcHJvdmlkZWQuXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG86IGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgIHZhciB4JCwgaSQsIHJlZiQsIGxlbiQsIGZpZWxkO1xuICAgICAgICAgIHRoaXMkLmVuc3VyZUl0Q2FuQmVVcGdyYWRlZChcbiAgICAgICAgICBpdGVtKTtcbiAgICAgICAgICB4JCA9IGl0ZW07XG4gICAgICAgICAgeCQuaWQgKz0gdXBncmFkZVsnaWQnXSAlIDEwMDtcbiAgICAgICAgICB4JC51cGdyYWRlSWQgPSB1cGdyYWRlWydpZCddO1xuICAgICAgICAgIHgkLm1hdFNldElkICs9IHVwZ3JhZGVbJ21hdFNldElkJ107XG4gICAgICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IFsnZGVmTW9kUGh5JywgJ2RlZk1vZE1hZycsICdkZWZNb2RGaXInLCAnZGVmTW9kTGl0JywgJ2RlZk1vZFRveCcsICdkZWZNb2RCbG8nLCAnZGVmTW9kQ3VyJ10pLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgICAgICBmaWVsZCA9IHJlZiRbaSRdO1xuICAgICAgICAgICAgaXRlbVtmaWVsZC5yZXBsYWNlKCdNb2QnLCAnJyldICo9IHVwZ3JhZGVbZmllbGRdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzd2l0Y2ggKGl0ZW1bJ2l0ZW1UeXBlJ10pIHtcbiAgICAgICAgICBjYXNlICd3ZWFwb24nOlxuICAgICAgICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IFsnYXRrTW9kUGh5JywgJ2F0a01vZE1hZycsICdhdGtNb2RGaXInLCAnYXRrTW9kTGl0JywgJ2JvbnVzTW9kU3RyJywgJ2JvbnVzTW9kRGV4JywgJ2JvbnVzTW9kSW50JywgJ2JvbnVzTW9kRmFpJ10pLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgICAgICAgIGZpZWxkID0gcmVmJFtpJF07XG4gICAgICAgICAgICAgIGl0ZW1bZmllbGQucmVwbGFjZSgnTW9kJywgJycpXSAqPSB1cGdyYWRlW2ZpZWxkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2FybW9yJzpcbiAgICAgICAgICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSBbJ2RlZk1vZFN0cmlrZScsICdkZWZNb2RTbGFzaCcsICdkZWZNb2RUaHJ1c3QnXSkubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgICAgICAgICAgZmllbGQgPSByZWYkW2kkXTtcbiAgICAgICAgICAgICAgaXRlbVtmaWVsZC5yZXBsYWNlKCdNb2QnLCAnJyldICo9IHVwZ3JhZGVbZmllbGRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9O1xuICAgIHJldHVybiBJdGVtVXBncmFkZVNlcnZpY2U7XG4gIH0oKSk7XG4gIGlmICh0eXBlb2YgbW9kdWxlICE9ICd1bmRlZmluZWQnICYmIG1vZHVsZSAhPT0gbnVsbCkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gSXRlbVVwZ3JhZGVTZXJ2aWNlO1xuICB9XG4gIGZ1bmN0aW9uIGJpbmQkKG9iaiwga2V5LCB0YXJnZXQpe1xuICAgIHJldHVybiBmdW5jdGlvbigpeyByZXR1cm4gKHRhcmdldCB8fCBvYmopW2tleV0uYXBwbHkob2JqLCBhcmd1bWVudHMpIH07XG4gIH1cbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuY29udHJvbGxlcihcIkl0ZW1zQ29udHJvbGxlclwiLCBmdW5jdGlvbigkc2NvcGUsIGRhdGFFeHBvcnRTdmMsIGl0ZW1TdmMsIHVpR3JpZENvbnN0YW50cyl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCBpdGVtVHlwZTtcbiAgICAkc2NvcGUuaXRlbVR5cGVzID0gW107XG4gICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IFsnbm9uZScsICdpdGVtcycsICd3ZWFwb25zJywgJ2FybW9ycyddKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgaXRlbVR5cGUgPSByZWYkW2kkXTtcbiAgICAgICRzY29wZS5pdGVtVHlwZXMucHVzaChpdGVtVHlwZSk7XG4gICAgfVxuICAgIHJlcXVpcmUoJy4vY29uZmlnL2l0ZW1zLWdyaWQtb3B0aW9ucycpKCRzY29wZSwgdWlHcmlkQ29uc3RhbnRzKTtcbiAgICAkc2NvcGUuc2VsZWN0ZWRJdGVtVHlwZUNoYW5nZWQgPSBmdW5jdGlvbigpe1xuICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZEl0ZW1UeXBlID09PSAnbm9uZScpIHtcbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmRhdGEgPSBbXTtcbiAgICAgICAgJHNjb3BlLmdyaWRPcHRpb25zLmNvbHVtbkRlZnMgPSBbXTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaXRlbVN2Yy5sb2FkSXRlbURhdGEoJHNjb3BlLnNlbGVjdGVkSXRlbVR5cGUpLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oaXRlbURhdGEpe1xuICAgICAgICB2YXIgaSQsIGxlbiQsIHdlYXBvbjtcbiAgICAgICAgaWYgKCRzY29wZS5zZWxlY3RlZEl0ZW1UeXBlID09PSAnd2VhcG9ucycpIHtcbiAgICAgICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IGl0ZW1EYXRhLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgICAgICB3ZWFwb24gPSBpdGVtRGF0YVtpJF07XG4gICAgICAgICAgICBpdGVtU3ZjLmFwcGx5VXBncmFkZVRvKHdlYXBvbiwgMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gaXRlbURhdGE7XG4gICAgICB9KTtcbiAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5jb2x1bW5EZWZzID0gJHNjb3BlLmNvbHVtbkNvbmZpZ3NbJHNjb3BlLnNlbGVjdGVkSXRlbVR5cGVdO1xuICAgIH07XG4gICAgJHNjb3BlLmV4cG9ydEFzSnNvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICBkYXRhRXhwb3J0U3ZjLmV4cG9ydEpzb24obWFwKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgZGVsZXRlIGl0LiQkaGFzaEtleTtcbiAgICAgICAgcmV0dXJuIGl0O1xuICAgICAgfSkoXG4gICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSkpO1xuICAgIH07XG4gICAgJHNjb3BlLmV4cG9ydEFzQ3N2ID0gZnVuY3Rpb24oKXtcbiAgICAgIHZhciBvdXRwdXREYXRhO1xuICAgICAgb3V0cHV0RGF0YSA9IG1hcChmdW5jdGlvbihpdCl7XG4gICAgICAgIHZhciBpdGVtO1xuICAgICAgICBpdGVtID0gaW1wb3J0JCh7fSwgaXQpO1xuICAgICAgICBkZWxldGUgaXRlbS4kJGhhc2hLZXk7XG4gICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgfSkoXG4gICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMuZGF0YSk7XG4gICAgICBkYXRhRXhwb3J0U3ZjLmV4cG9ydENzdihvdXRwdXREYXRhKTtcbiAgICB9O1xuICAgICRzY29wZS5zZWxlY3RlZEl0ZW1UeXBlID0gJ25vbmUnO1xuICB9KTtcbiAgZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gICAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICAgIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gICAgcmV0dXJuIG9iajtcbiAgfVxufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICByZXF1aXJlKCcuL2l0ZW1zLWNvbnRyb2xsZXInKTtcbiAgcmVxdWlyZSgnLi9pdGVtLXNlcnZpY2UnKTtcbiAgcmVxdWlyZSgnLi9pdGVtLWluZGV4LXNlcnZpY2UnKTtcbiAgcmVxdWlyZSgnLi9pdGVtLXVwZ3JhZGUtc2VydmljZScpO1xufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICB2YXIgSXRlbU1vZGVsLCBFcXVpcG1lbnRNb2RlbCwgV2VhcG9uTW9kZWwsIEFybW9yTW9kZWw7XG4gIGlmICh0eXBlb2YgbW9kdWxlICE9ICd1bmRlZmluZWQnICYmIG1vZHVsZSAhPT0gbnVsbCkge1xuICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgJ0l0ZW0nOiBJdGVtTW9kZWwgPSAoZnVuY3Rpb24oKXtcbiAgICAgICAgSXRlbU1vZGVsLmRpc3BsYXlOYW1lID0gJ0l0ZW1Nb2RlbCc7XG4gICAgICAgIHZhciBwcm90b3R5cGUgPSBJdGVtTW9kZWwucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEl0ZW1Nb2RlbDtcbiAgICAgICAgZnVuY3Rpb24gSXRlbU1vZGVsKCl7XG4gICAgICAgICAgdGhpcy51c2VEYXRhRnJvbSA9IGJpbmQkKHRoaXMsICd1c2VEYXRhRnJvbScsIHByb3RvdHlwZSk7XG4gICAgICAgICAgdGhpcy5pZCA9IDA7XG4gICAgICAgICAgdGhpcy5pdGVtVHlwZSA9ICdpdGVtJztcbiAgICAgICAgICB0aGlzLml0ZW1TdWJ0eXBlID0gJyc7XG4gICAgICAgICAgdGhpcy5uYW1lID0gJyc7XG4gICAgICAgICAgdGhpcy5zZWxsVmFsdWUgPSAwO1xuICAgICAgICAgIHRoaXMuaWNvbklkID0gMDtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogQSB1bmlxdWUgSUQgdGhhdCBkb2Vzbid0IG92ZXJsYXAgYmV0d2VlbiBpdGVtIHR5cGVzLlxuICAgICAgICAgKi9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZSwgJ3VpZCcsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtVHlwZSArIHRoaXMuaWQ7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcHJvdG90eXBlLnVzZURhdGFGcm9tID0gZnVuY3Rpb24oaXRlbURhdGEpe1xuICAgICAgICAgIHJldHVybiBpbXBvcnQkKHRoaXMsIGl0ZW1EYXRhKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEl0ZW1Nb2RlbDtcbiAgICAgIH0oKSksXG4gICAgICAnRXF1aXBtZW50JzogRXF1aXBtZW50TW9kZWwgPSAoZnVuY3Rpb24oc3VwZXJjbGFzcyl7XG4gICAgICAgIHZhciBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKEVxdWlwbWVudE1vZGVsLCBzdXBlcmNsYXNzKS5kaXNwbGF5TmFtZSA9ICdFcXVpcG1lbnRNb2RlbCcsIEVxdWlwbWVudE1vZGVsKSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEVxdWlwbWVudE1vZGVsO1xuICAgICAgICBmdW5jdGlvbiBFcXVpcG1lbnRNb2RlbCgpe1xuICAgICAgICAgIEVxdWlwbWVudE1vZGVsLnN1cGVyY2xhc3MuY2FsbCh0aGlzKTtcbiAgICAgICAgICB0aGlzLndlaWdodCA9IDAuMDtcbiAgICAgICAgICB0aGlzLmR1cmFiaWxpdHkgPSAwO1xuICAgICAgICAgIHRoaXMuZGVmUGh5ID0gMDtcbiAgICAgICAgICB0aGlzLmRlZk1hZyA9IDA7XG4gICAgICAgICAgdGhpcy5kZWZGaXIgPSAwO1xuICAgICAgICAgIHRoaXMuZGVmTGl0ID0gMDtcbiAgICAgICAgICB0aGlzLmRlZlRveCA9IDA7XG4gICAgICAgICAgdGhpcy5kZWZCbG8gPSAwO1xuICAgICAgICAgIHRoaXMuZGVmQ3VyID0gMDtcbiAgICAgICAgICB0aGlzLm1hdFNldElkID0gMDtcbiAgICAgICAgICB0aGlzLnVwZ3JhZGVDb3N0ID0gMDtcbiAgICAgICAgICB0aGlzLnVwZ3JhZGVJZCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBFcXVpcG1lbnRNb2RlbDtcbiAgICAgIH0oSXRlbU1vZGVsKSksXG4gICAgICAnV2VhcG9uJzogV2VhcG9uTW9kZWwgPSAoZnVuY3Rpb24oc3VwZXJjbGFzcyl7XG4gICAgICAgIHZhciBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKFdlYXBvbk1vZGVsLCBzdXBlcmNsYXNzKS5kaXNwbGF5TmFtZSA9ICdXZWFwb25Nb2RlbCcsIFdlYXBvbk1vZGVsKSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IFdlYXBvbk1vZGVsO1xuICAgICAgICBmdW5jdGlvbiBXZWFwb25Nb2RlbCgpe1xuICAgICAgICAgIFdlYXBvbk1vZGVsLnN1cGVyY2xhc3MuY2FsbCh0aGlzKTtcbiAgICAgICAgICB0aGlzLml0ZW1UeXBlID0gJ3dlYXBvbic7XG4gICAgICAgICAgdGhpcy53ZWFwb25UeXBlID0gJyc7XG4gICAgICAgICAgdGhpcy53ZWFwb25TdWJ0eXBlID0gJyc7XG4gICAgICAgICAgdGhpcy5wYXRoID0gJyc7XG4gICAgICAgICAgdGhpcy5jYW5CbG9jayA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuY2FuUGFycnkgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmNhc3RzTWFnaWMgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLmNhc3RzUHlyb21hbmN5ID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5jYXN0c01pcmFjbGVzID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5kYW1hZ2VzR2hvc3RzID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5pc0F1Z21lbnRhYmxlID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5kb2VzUmVndWxhckRhbWFnZSA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZG9lc1N0cmlrZURhbWFnZSA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZG9lc1NsYXNoRGFtYWdlID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5kb2VzVGhydXN0RGFtYWdlID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5yZXFTdHIgPSAwO1xuICAgICAgICAgIHRoaXMucmVxRGV4ID0gMDtcbiAgICAgICAgICB0aGlzLnJlcUludCA9IDA7XG4gICAgICAgICAgdGhpcy5yZXFGYWkgPSAwO1xuICAgICAgICAgIHRoaXMuYXRrUGh5ID0gMDtcbiAgICAgICAgICB0aGlzLmF0a01hZyA9IDA7XG4gICAgICAgICAgdGhpcy5hdGtGaXIgPSAwO1xuICAgICAgICAgIHRoaXMuYXRrTGl0ID0gMDtcbiAgICAgICAgICB0aGlzLmF0a1N0YUNvc3QgPSAwO1xuICAgICAgICAgIHRoaXMuYm9udXNTdHIgPSAwO1xuICAgICAgICAgIHRoaXMuYm9udXNEZXggPSAwO1xuICAgICAgICAgIHRoaXMuYm9udXNJbnQgPSAwO1xuICAgICAgICAgIHRoaXMuYm9udXNGYWkgPSAwO1xuICAgICAgICAgIHRoaXMuZGVmU3RhID0gMDtcbiAgICAgICAgICB0aGlzLmRpdmluZSA9IDA7XG4gICAgICAgICAgdGhpcy5vY2N1bHQgPSAwO1xuICAgICAgICAgIHRoaXMucmFuZ2UgPSAwO1xuICAgICAgICAgIHRoaXMuYXRrQmxvID0gMDtcbiAgICAgICAgICB0aGlzLmRtZ0JsbyA9IDA7XG4gICAgICAgICAgdGhpcy5hdGtUb3ggPSAwO1xuICAgICAgICAgIHRoaXMuZG1nVG94ID0gMDtcbiAgICAgICAgICB0aGlzLmF0a0hlYWwgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBXZWFwb25Nb2RlbDtcbiAgICAgIH0oRXF1aXBtZW50TW9kZWwpKSxcbiAgICAgICdBcm1vcic6IEFybW9yTW9kZWwgPSAoZnVuY3Rpb24oc3VwZXJjbGFzcyl7XG4gICAgICAgIHZhciBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKEFybW9yTW9kZWwsIHN1cGVyY2xhc3MpLmRpc3BsYXlOYW1lID0gJ0FybW9yTW9kZWwnLCBBcm1vck1vZGVsKSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEFybW9yTW9kZWw7XG4gICAgICAgIGZ1bmN0aW9uIEFybW9yTW9kZWwoKXtcbiAgICAgICAgICBBcm1vck1vZGVsLnN1cGVyY2xhc3MuY2FsbCh0aGlzKTtcbiAgICAgICAgICB0aGlzLml0ZW1UeXBlID0gJ2FybW9yJztcbiAgICAgICAgICB0aGlzLmFybW9yVHlwZSA9ICcnO1xuICAgICAgICAgIHRoaXMuYXJtb3JTZXQgPSAnJztcbiAgICAgICAgICB0aGlzLmRlZlNsYXNoID0gMDtcbiAgICAgICAgICB0aGlzLmRlZlN0cmlrZSA9IDA7XG4gICAgICAgICAgdGhpcy5kZWZUaHJ1c3QgPSAwO1xuICAgICAgICAgIHRoaXMuZGVmUG9pc2UgPSAwO1xuICAgICAgICAgIHRoaXMuc3RhUmVnZW5Nb2QgPSAwO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90b3R5cGUsICdzb3J0VHlwZScsIHtcbiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuYXJtb3JUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICdoZWFkJzpcbiAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlICdjaGVzdCc6XG4gICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgY2FzZSAnaGFuZHMnOlxuICAgICAgICAgICAgICByZXR1cm4gMztcbiAgICAgICAgICAgIGNhc2UgJ2xlZ3MnOlxuICAgICAgICAgICAgICByZXR1cm4gNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gQXJtb3JNb2RlbDtcbiAgICAgIH0oRXF1aXBtZW50TW9kZWwpKVxuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gYmluZCQob2JqLCBrZXksIHRhcmdldCl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7IHJldHVybiAodGFyZ2V0IHx8IG9iailba2V5XS5hcHBseShvYmosIGFyZ3VtZW50cykgfTtcbiAgfVxuICBmdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgICByZXR1cm4gb2JqO1xuICB9XG4gIGZ1bmN0aW9uIGV4dGVuZCQoc3ViLCBzdXApe1xuICAgIGZ1bmN0aW9uIGZ1bigpe30gZnVuLnByb3RvdHlwZSA9IChzdWIuc3VwZXJjbGFzcyA9IHN1cCkucHJvdG90eXBlO1xuICAgIChzdWIucHJvdG90eXBlID0gbmV3IGZ1bikuY29uc3RydWN0b3IgPSBzdWI7XG4gICAgaWYgKHR5cGVvZiBzdXAuZXh0ZW5kZWQgPT0gJ2Z1bmN0aW9uJykgc3VwLmV4dGVuZGVkKHN1Yik7XG4gICAgcmV0dXJuIHN1YjtcbiAgfVxufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICBhbmd1bGFyLm1vZHVsZShcImRzY1wiKS5jb250cm9sbGVyKFwiUGNDb250cm9sbGVyXCIsIGZ1bmN0aW9uKCRzY29wZSwgcGNTZXJ2aWNlKXtcbiAgICAkc2NvcGUubW9kZWwgPSBwY1NlcnZpY2UubG9hZFVzZXJEYXRhKCk7XG4gICAgJHNjb3BlLnNhdmVTdGF0cyA9IGZ1bmN0aW9uKCl7XG4gICAgICBwY1NlcnZpY2Uuc2F2ZVVzZXJEYXRhKCRzY29wZS5tb2RlbCk7XG4gICAgfTtcbiAgfSk7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLmZpbHRlcihcInRvU3RhdEFycmF5XCIsIGZ1bmN0aW9uKHBjU2VydmljZSl7XG4gICAgdmFyIG91dHB1dDtcbiAgICBvdXRwdXQgPSBbXTtcbiAgICByZXR1cm4gZnVuY3Rpb24obW9kZWwpe1xuICAgICAgaWYgKG91dHB1dC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICB9XG4gICAgICBwY1NlcnZpY2UuZm9yRWFjaFN0YXQobW9kZWwsIGZ1bmN0aW9uKHN0YXQsIG5hbWUpe1xuICAgICAgICBvdXRwdXQucHVzaChtb2RlbFtuYW1lXSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgfSk7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpO1xuICByZXF1aXJlKFwiLi9zZXJ2aWNlXCIpO1xuICByZXF1aXJlKFwiLi9jb250cm9sbGVyXCIpO1xuICByZXF1aXJlKFwiLi9jb250cm9sbGVyL2ZpbHRlcnNcIik7XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIHZhciBQY01vZGVsO1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPSAndW5kZWZpbmVkJyAmJiBtb2R1bGUgIT09IG51bGwpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFBjTW9kZWwgPSAoZnVuY3Rpb24oKXtcbiAgICAgIFBjTW9kZWwuZGlzcGxheU5hbWUgPSAnUGNNb2RlbCc7XG4gICAgICB2YXIgcHJvdG90eXBlID0gUGNNb2RlbC5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gUGNNb2RlbDtcbiAgICAgIFBjTW9kZWwuU3RhdHMgPSBbJ3ZpdGFsaXR5JywgJ2F0dHVuZW1lbnQnLCAnZW5kdXJhbmNlJywgJ3N0cmVuZ3RoJywgJ2RleHRlcml0eScsICdyZXNpc3RhbmNlJywgJ2ludGVsbGlnZW5jZScsICdmYWl0aCcsICdodW1hbml0eSddO1xuICAgICAgZnVuY3Rpb24gUGNNb2RlbChwY1NlcnZpY2Upe1xuICAgICAgICB0aGlzLnBjU2VydmljZSA9IHBjU2VydmljZTtcbiAgICAgICAgdGhpcy52YWxpZGF0ZSA9IGJpbmQkKHRoaXMsICd2YWxpZGF0ZScsIHByb3RvdHlwZSk7XG4gICAgICAgIHRoaXMuZm9yRWFjaFN0YXQgPSBiaW5kJCh0aGlzLCAnZm9yRWFjaFN0YXQnLCBwcm90b3R5cGUpO1xuICAgICAgICB0aGlzLmZvckVhY2hTdGF0KGZ1bmN0aW9uKHN0YXQsIG5hbWUpe1xuICAgICAgICAgIHJldHVybiBuZXcgKHJlcXVpcmUoJy4vUGNTdGF0TW9kZWwnKSkobmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcHJvdG90eXBlLmZvckVhY2hTdGF0ID0gZnVuY3Rpb24oZnVuYyl7XG4gICAgICAgIHRoaXMucGNTZXJ2aWNlLmZvckVhY2hTdGF0KHRoaXMsIGZ1bmMpO1xuICAgICAgfTtcbiAgICAgIHByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuZm9yRWFjaFN0YXQoZnVuY3Rpb24oaXQpe1xuICAgICAgICAgIGl0LmJhc2UgPSBtYXgoOCwgbWluKDk5LCBpdC5iYXNlKSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBQY01vZGVsO1xuICAgIH0oKSk7XG4gIH1cbiAgZnVuY3Rpb24gYmluZCQob2JqLCBrZXksIHRhcmdldCl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7IHJldHVybiAodGFyZ2V0IHx8IG9iailba2V5XS5hcHBseShvYmosIGFyZ3VtZW50cykgfTtcbiAgfVxufSkuY2FsbCh0aGlzKTtcbiIsIihmdW5jdGlvbigpe1xuICB2YXIgUGNTdGF0TW9kZWw7XG4gIGlmICh0eXBlb2YgbW9kdWxlICE9ICd1bmRlZmluZWQnICYmIG1vZHVsZSAhPT0gbnVsbCkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gUGNTdGF0TW9kZWwgPSAoZnVuY3Rpb24oKXtcbiAgICAgIFBjU3RhdE1vZGVsLmRpc3BsYXlOYW1lID0gJ1BjU3RhdE1vZGVsJztcbiAgICAgIHZhciBwcm90b3R5cGUgPSBQY1N0YXRNb2RlbC5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gUGNTdGF0TW9kZWw7XG4gICAgICBmdW5jdGlvbiBQY1N0YXRNb2RlbChuYW1lLCBiYXNlKXtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5iYXNlID0gYmFzZSAhPSBudWxsID8gYmFzZSA6IDA7XG4gICAgICAgIHRoaXMuYm9udXMgPSAwO1xuICAgICAgfVxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZSwgJ3RvdGFsJywge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYmFzZSArIHRoaXMuYm9udXM7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJvdG90eXBlLCAnZGlzcGxheU5hbWUnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKXtcbiAgICAgICAgICByZXR1cm4gY2FwaXRhbGl6ZSh0aGlzLm5hbWUpO1xuICAgICAgICB9LFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFBjU3RhdE1vZGVsO1xuICAgIH0oKSk7XG4gIH1cbn0pLmNhbGwodGhpcyk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgYW5ndWxhci5tb2R1bGUoXCJkc2NcIikuc2VydmljZSgncGNTZXJ2aWNlJywgZnVuY3Rpb24oc3RvcmFnZVN2Yyl7XG4gICAgdmFyIHgkLCBzdmMsIHRoaXMkID0gdGhpcztcbiAgICB4JCA9IHN2YyA9IHt9O1xuICAgIHgkLmRhdGEgPSB7fTtcbiAgICB4JC5QY01vZGVsID0gcmVxdWlyZSgnLi9tb2RlbHMvUGNNb2RlbCcpO1xuICAgIHgkLlBjU3RhdE1vZGVsID0gcmVxdWlyZSgnLi9tb2RlbHMvUGNTdGF0TW9kZWwnKTtcbiAgICBzdmMuc3RhdFZhbHVlT2YgPSBmdW5jdGlvbihuYW1lKXtcbiAgICAgIHN2Yy5sb2FkVXNlckRhdGEoKTtcbiAgICAgIHJldHVybiBzdmMuZGF0YS5zdGF0c1tuYW1lXS50b3RhbDtcbiAgICB9O1xuICAgIHN2Yy5mb3JFYWNoU3RhdCA9IGZ1bmN0aW9uKG1vZGVsLCBmdW5jKXtcbiAgICAgIHZhciBpJCwgcmVmJCwgbGVuJCwgc3RhdE5hbWUsIHN0YXQsIHJlZjEkO1xuICAgICAgbW9kZWwgPT0gbnVsbCAmJiAobW9kZWwgPSBzdmMuZGF0YSk7XG4gICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0gc3ZjLlBjTW9kZWwuU3RhdHMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIHN0YXROYW1lID0gcmVmJFtpJF07XG4gICAgICAgIHN0YXQgPSAobW9kZWwuc3RhdHMgfHwgKG1vZGVsLnN0YXRzID0ge30pKVtzdGF0TmFtZV07XG4gICAgICAgIChtb2RlbC5zdGF0cyB8fCAobW9kZWwuc3RhdHMgPSB7fSkpW3N0YXROYW1lXSA9IChyZWYxJCA9IGZ1bmMoc3RhdCwgc3RhdE5hbWUpKSAhPSBudWxsID8gcmVmMSQgOiBzdGF0O1xuICAgICAgfVxuICAgIH07XG4gICAgc3ZjLmxvYWRVc2VyRGF0YSA9IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgZGF0YSwgbW9kZWw7XG4gICAgICBkYXRhID0gc3RvcmFnZVN2Yy5sb2FkKCdwYycgIT0gbnVsbFxuICAgICAgICA/ICdwYydcbiAgICAgICAgOiB7fSk7XG4gICAgICBtb2RlbCA9IGltcG9ydCQobmV3IHN2Yy5QY01vZGVsKHN2YyksIGRhdGEpO1xuICAgICAgbW9kZWwuZm9yRWFjaFN0YXQoZnVuY3Rpb24oc3RhdCwgbmFtZSl7XG4gICAgICAgIHZhciB4JCwgcmVmJDtcbiAgICAgICAgeCQgPSBpbXBvcnQkKG5ldyBzdmMuUGNTdGF0TW9kZWwsIGRhdGEgIT0gbnVsbCA/IChyZWYkID0gZGF0YS5zdGF0cykgIT0gbnVsbCA/IHJlZiRbbmFtZV0gOiB2b2lkIDggOiB2b2lkIDgpO1xuICAgICAgICB4JC5uYW1lID0gbmFtZTtcbiAgICAgICAgcmV0dXJuIHgkO1xuICAgICAgfSk7XG4gICAgICBtb2RlbC52YWxpZGF0ZSgpO1xuICAgICAgc3ZjLmRhdGEgPSBtb2RlbDtcbiAgICAgIHJldHVybiBtb2RlbDtcbiAgICB9O1xuICAgIHN2Yy5zYXZlVXNlckRhdGEgPSBmdW5jdGlvbihtb2RlbCl7XG4gICAgICB2YXIgZGF0YSwga2V5LCB2YWx1ZTtcbiAgICAgIG1vZGVsID09IG51bGwgJiYgKG1vZGVsID0gc3ZjLmRhdGEpO1xuICAgICAgbW9kZWwudmFsaWRhdGUoKTtcbiAgICAgIGRhdGEgPSBpbXBvcnQkKHt9LCBtb2RlbCk7XG4gICAgICBmb3IgKGtleSBpbiBtb2RlbCkge1xuICAgICAgICB2YWx1ZSA9IG1vZGVsW2tleV07XG4gICAgICAgIGlmIChrZXkgIT09ICdzdGF0cycpIHtcbiAgICAgICAgICBkZWxldGUgZGF0YVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzdG9yYWdlU3ZjLnNhdmUoJ3BjJywgZGF0YSk7XG4gICAgfTtcbiAgICBzdmMuc3RhdFNjYWxpbmdGYWN0b3JPZiA9IGZ1bmN0aW9uKG5hbWUpe1xuICAgICAgdmFyIHN0YXRWYWx1ZSwgdGhyZXNob2xkcywgcmVzdWx0LCBpJCwgbGVuJCwgdGhyZXNob2xkO1xuICAgICAgc3ZjLmxvYWRVc2VyRGF0YSgpO1xuICAgICAgc3RhdFZhbHVlID0gc3ZjLnN0YXRWYWx1ZU9mKG5hbWUpO1xuICAgICAgdGhyZXNob2xkcyA9IChmdW5jdGlvbigpe1xuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgICAgY2FzZSAnc3RyZW5ndGgnOlxuICAgICAgICAgIC8vIGZhbGx0aHJvdWdoXG4gICAgICAgIGNhc2UgJ2RleHRlcml0eSc6XG4gICAgICAgICAgcmV0dXJuIFtbMTAsIDAuNV0sIFsxMCwgMy41XSwgWzIwLCAyLjI1XV07XG4gICAgICAgIGNhc2UgJ2ludGVsbGlnZW5jZSc6XG4gICAgICAgICAgLy8gZmFsbHRocm91Z2hcbiAgICAgICAgY2FzZSAnZmFpdGgnOlxuICAgICAgICAgIHJldHVybiBbWzEwLCAwLjVdLCBbMjAsIDIuMjVdLCBbMjAsIDEuNV1dO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IEVycm9yKCd1bmltcGxlbWVudGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0oKSk7XG4gICAgICByZXN1bHQgPSAwO1xuICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSB0aHJlc2hvbGRzLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIHRocmVzaG9sZCA9IHRocmVzaG9sZHNbaSRdO1xuICAgICAgICBpZiAoc3RhdFZhbHVlID49IHRocmVzaG9sZFswXSkge1xuICAgICAgICAgIHJlc3VsdCArPSB0aHJlc2hvbGRbMF0gKiB0aHJlc2hvbGRbMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzdWx0ICs9IHN0YXRWYWx1ZSAqIHRocmVzaG9sZFsxXTtcbiAgICAgICAgfVxuICAgICAgICBzdGF0VmFsdWUgLT0gdGhyZXNob2xkWzBdO1xuICAgICAgICBpZiAoc3RhdFZhbHVlIDwgMSkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXN1bHQgLz0gMTAwO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBzdmM7XG4gIH0pO1xuICBmdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgICByZXR1cm4gb2JqO1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGFuZ3VsYXIubW9kdWxlKFwiZHNjXCIpLmNvbnRyb2xsZXIoXCJXZWFwb25DYWxjQ29udHJvbGxlclwiLCBmdW5jdGlvbigkcSwgJHNjb3BlLCBpdGVtU3ZjLCBpbnZlbnRvcnlTdmMsIHBjU2VydmljZSwgdWlHcmlkQ29uc3RhbnRzKXtcbiAgICB2YXIgeCQsIF9hZGRSZXN1bHQ7XG4gICAgJHNjb3BlLnJlc3VsdHMgPSBbXTtcbiAgICAkc2NvcGUuc3RhdEJvbnVzID0gMDtcbiAgICAkc2NvcGUuaWdub3JlQ3J5c3RhbCA9IHRydWU7XG4gICAgeCQgPSAkc2NvcGUuZ3JpZE9wdGlvbnMgPSByZXF1aXJlKCcuL2NvbnRyb2xsZXIvZ3JpZE9wdGlvbnMnKSh1aUdyaWRDb25zdGFudHMpO1xuICAgIHgkLmRhdGEgPSAkc2NvcGUucmVzdWx0cztcbiAgICBfYWRkUmVzdWx0ID0gZnVuY3Rpb24odHlwZSwgd2VhcG9uKXtcbiAgICAgIHZhciBzY1MsIHNjRCwgc2NJLCBzY0YsIHN0ciwgZGV4LCBpbnQsIGZhaSwgZG1nTiwgZG1nTSwgZGVmTiwgc2NvcmUsIHgkLCByZXN1bHQ7XG4gICAgICBzY1MgPSBwY1NlcnZpY2Uuc3RhdFNjYWxpbmdGYWN0b3JPZignc3RyZW5ndGgnKTtcbiAgICAgIHNjRCA9IHBjU2VydmljZS5zdGF0U2NhbGluZ0ZhY3Rvck9mKCdkZXh0ZXJpdHknKTtcbiAgICAgIHNjSSA9IHBjU2VydmljZS5zdGF0U2NhbGluZ0ZhY3Rvck9mKCdpbnRlbGxpZ2VuY2UnKTtcbiAgICAgIHNjRiA9IHBjU2VydmljZS5zdGF0U2NhbGluZ0ZhY3Rvck9mKCdmYWl0aCcpO1xuICAgICAgc3RyID0gJHNjb3BlLnN0YXRCb251cyArIHBjU2VydmljZS5zdGF0VmFsdWVPZignc3RyZW5ndGgnKTtcbiAgICAgIGRleCA9ICRzY29wZS5zdGF0Qm9udXMgKyBwY1NlcnZpY2Uuc3RhdFZhbHVlT2YoJ2RleHRlcml0eScpO1xuICAgICAgaW50ID0gJHNjb3BlLnN0YXRCb251cyArIHBjU2VydmljZS5zdGF0VmFsdWVPZignaW50ZWxsaWdlbmNlJyk7XG4gICAgICBmYWkgPSAkc2NvcGUuc3RhdEJvbnVzICsgcGNTZXJ2aWNlLnN0YXRWYWx1ZU9mKCdmYWl0aCcpO1xuICAgICAgaWYgKHdlYXBvbi5yZXFTID4gc3RyIHx8IHdlYXBvbi5yZXFEID4gZGV4IHx8IHdlYXBvbi5yZXFJID4gaW50IHx8IHdlYXBvbi5yZXFGID4gZmFpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGRtZ04gPSB3ZWFwb24uZG1nTiAqICgxICsgKHdlYXBvbi5zY1MgKiBzY1MgKyB3ZWFwb24uc2NEICogc2NEKSk7XG4gICAgICBkbWdNID0gd2VhcG9uLmRtZ00gKiAoMSArICh3ZWFwb24uc2NJICogc2NJICsgd2VhcG9uLnNjRiAqIHNjRikpO1xuICAgICAgZGVmTiA9IHdlYXBvbi5kZWZOICsgKHdlYXBvbi5kZWZNICsgd2VhcG9uLmRlZkYgKyB3ZWFwb24uZGVmTCkgKiAwLjIgKyB3ZWFwb24uZGVmUztcbiAgICAgIHNjb3JlID0gdHlwZSA9PT0gJ2RlZmVuY2UnID8gZGVmTiA6IGRtZ047XG4gICAgICB4JCA9IHJlc3VsdCA9IHt9O1xuICAgICAgeCQud2VhcG9uID0gd2VhcG9uO1xuICAgICAgeCQuc2NvcmUgPSBzY29yZTtcbiAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhLnB1c2gocmVzdWx0KTtcbiAgICB9O1xuICAgICRzY29wZS5jYWxjdWxhdGUgPSBmdW5jdGlvbih0eXBlKXtcbiAgICAgIHZhciBpdGVtcywgd2VhcG9ucywgaW52ZW50b3J5O1xuICAgICAgdHlwZSA9PSBudWxsICYmICh0eXBlID0gJ29mZmVuY2UnKTtcbiAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhID0gW107XG4gICAgICBpdGVtcyA9IGl0ZW1TdmMubG9hZEl0ZW1EYXRhKCdpdGVtcycpO1xuICAgICAgd2VhcG9ucyA9IGl0ZW1TdmMubG9hZEl0ZW1EYXRhKCd3ZWFwb25zJyk7XG4gICAgICBpbnZlbnRvcnkgPSBpbnZlbnRvcnlTdmMubG9hZFVzZXJJbnZlbnRvcnkoKTtcbiAgICAgICRxLmFsbChbd2VhcG9ucy4kcHJvbWlzZSwgaXRlbXMuJHByb21pc2VdKS50aGVuKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBhdmFpbGFibGVXZWFwb25zLCBkYXRhLCBpJCwgbGVuJCwgd2VhcG9uLCBscmVzdWx0JCwgbWF0ZXJpYWxzLCBwcm9taXNlLCBqJCwgaXRlcmF0aW9uLCByZXN1bHRzJCA9IFtdO1xuICAgICAgICBhdmFpbGFibGVXZWFwb25zID0gcmVqZWN0KGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgICByZXR1cm4gaXQgPT0gbnVsbCB8fCAoJHNjb3BlLmlnbm9yZUNyeXN0YWwgJiYgdGFrZSg0KShcbiAgICAgICAgICBpdC5uYW1lKSA9PT0gJ0NyeXMnKTtcbiAgICAgICAgfSkoXG4gICAgICAgIG1hcChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICByZXR1cm4gZmluZChmdW5jdGlvbihpdCl7XG4gICAgICAgICAgICByZXR1cm4gaXQuaWQgPT09IGl0ZW0uaWQ7XG4gICAgICAgICAgfSkoXG4gICAgICAgICAgd2VhcG9ucyk7XG4gICAgICAgIH0pKFxuICAgICAgICBpbnZlbnRvcnkpKTtcbiAgICAgICAgZGF0YSA9IHt9O1xuICAgICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IGF2YWlsYWJsZVdlYXBvbnMubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgICAgICB3ZWFwb24gPSBhdmFpbGFibGVXZWFwb25zW2kkXTtcbiAgICAgICAgICBscmVzdWx0JCA9IFtdO1xuICAgICAgICAgIG1hdGVyaWFscyA9IG1hcChmbiQpKFxuICAgICAgICAgIGludmVudG9yeSk7XG4gICAgICAgICAgcHJvbWlzZSA9ICRxKGZuMSQpO1xuICAgICAgICAgIGZvciAoaiQgPSAwOyBqJCA8PSAxNTsgKytqJCkge1xuICAgICAgICAgICAgaXRlcmF0aW9uID0gaiQ7XG4gICAgICAgICAgICBscmVzdWx0JC5wdXNoKGZuMiQod2VhcG9uLCBtYXRlcmlhbHMsIGl0ZXJhdGlvbikpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHRzJC5wdXNoKGxyZXN1bHQkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cyQ7XG4gICAgICAgIGZ1bmN0aW9uIGZuJChpdCl7XG4gICAgICAgICAgcmV0dXJuIGltcG9ydCQoe30sIGl0KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBmbjEkKHJlc29sdmUsIHJlamVjdCl7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGZuMiQod2VhcG9uLCBtYXRlcmlhbHMsIGl0ZXJhdGlvbil7XG4gICAgICAgICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1TdmMuY2FuVXBncmFkZVdpdGhNYXRlcmlhbHMod2VhcG9uLCBtYXRlcmlhbHMsIGl0ZXJhdGlvbik7XG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbihjYW5VcGdyYWRlKXtcbiAgICAgICAgICAgIGlmIChjYW5VcGdyYWRlKSB7XG4gICAgICAgICAgICAgIHJldHVybiAkcS5hbGwoW2l0ZW1TdmMuZ2V0VXBncmFkZWRWZXJzaW9uT2Yod2VhcG9uLCBpdGVyYXRpb24pLCBpdGVtU3ZjLnBheUZvclVwZ3JhZGVGb3Iod2VhcG9uLCBtYXRlcmlhbHMsIGl0ZXJhdGlvbildKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1hdGVyaWFscy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICB2YXIgdXBXZWFwb247XG4gICAgICAgICAgICB1cFdlYXBvbiA9IHJlc3VsdCAhPSBudWxsID8gcmVzdWx0WzBdIDogdm9pZCA4O1xuICAgICAgICAgICAgaWYgKHVwV2VhcG9uICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgX2FkZFJlc3VsdCh0eXBlLCB1cFdlYXBvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuICBmdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgICByZXR1cm4gb2JqO1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gIGlmICh0eXBlb2YgbW9kdWxlICE9ICd1bmRlZmluZWQnICYmIG1vZHVsZSAhPT0gbnVsbCkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odWlHcmlkQ29uc3RhbnRzKXtcbiAgICAgIHZhciBwZXJjZW50RmllbGRNaW5XaWR0aDtcbiAgICAgIHBlcmNlbnRGaWVsZE1pbldpZHRoID0gNDU7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb2x1bW5EZWZzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6ICdzY29yZScsXG4gICAgICAgICAgICBtaW5XaWR0aDogNTAsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAnbnVtYmVyOjInLFxuICAgICAgICAgICAgc29ydDoge1xuICAgICAgICAgICAgICBkaXJlY3Rpb246IHVpR3JpZENvbnN0YW50cy5ERVNDLFxuICAgICAgICAgICAgICBwcmlvcml0eTogMVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24ubmFtZScsXG4gICAgICAgICAgICBtaW5XaWR0aDogMjEwXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24ucmVxUycsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JTJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24ucmVxRCcsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JEJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24ucmVxSScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JJJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24ucmVxRicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1JGJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uZG1nTicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FQJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uZG1nTScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FNJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uZG1nRicsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FGJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uZG1nTCcsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FMJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uZG1nUycsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0FTJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uc2NTJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU1MnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5zY0QnLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdTRCcsXG4gICAgICAgICAgICBtaW5XaWR0aDogcGVyY2VudEZpZWxkTWluV2lkdGgsXG4gICAgICAgICAgICBjZWxsRmlsdGVyOiAncGVyY2VudGFnZScsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZpZWxkOiAnd2VhcG9uLnNjSScsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogJ1NJJyxcbiAgICAgICAgICAgIG1pbldpZHRoOiBwZXJjZW50RmllbGRNaW5XaWR0aCxcbiAgICAgICAgICAgIGNlbGxGaWx0ZXI6ICdwZXJjZW50YWdlJyxcbiAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgfSwge1xuICAgICAgICAgICAgZmllbGQ6ICd3ZWFwb24uc2NGJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU0YnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZOJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRFAnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZNJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRE0nLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZGJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREYnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZMJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREwnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZUJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnRFQnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZCJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREInLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZDJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnREMnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kZWZTJyxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiAnU3QnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5kaXZNb2QnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdEaXYnLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi5vY2NNb2QnLFxuICAgICAgICAgICAgbWluV2lkdGg6IHBlcmNlbnRGaWVsZE1pbldpZHRoLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdPY2MnLFxuICAgICAgICAgICAgY2VsbEZpbHRlcjogJ3BlcmNlbnRhZ2UnLFxuICAgICAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBmaWVsZDogJ3dlYXBvbi53ZWlnaHQnLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6ICdXdCcsXG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfTtcbiAgICB9O1xuICB9XG59KS5jYWxsKHRoaXMpO1xuIl19
